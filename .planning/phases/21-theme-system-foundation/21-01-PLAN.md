---
phase: 21-theme-system-foundation
plan: 01
type: tdd
wave: 1
depends_on: []
files_modified:
  - packages/cli/src/theme/schema.ts
  - packages/cli/src/theme/defaults.ts
  - packages/cli/src/theme/index.ts
  - packages/cli/tests/theme/schema.test.ts
  - packages/cli/package.json
autonomous: true

must_haves:
  truths:
    - "Theme config schema validates correct OKLCH color strings"
    - "Theme config schema rejects malformed input with descriptive errors"
    - "Default theme provides neutral gray palette"
    - "Partial configs merge with defaults correctly"
  artifacts:
    - path: "packages/cli/src/theme/schema.ts"
      provides: "Zod schema and ThemeConfig type"
      exports: ["themeConfigSchema", "ThemeConfig"]
    - path: "packages/cli/src/theme/defaults.ts"
      provides: "Default theme constant"
      exports: ["defaultTheme"]
    - path: "packages/cli/src/theme/index.ts"
      provides: "Public exports barrel"
  key_links:
    - from: "packages/cli/src/theme/defaults.ts"
      to: "packages/cli/src/theme/schema.ts"
      via: "imports ThemeConfig type"
      pattern: "import.*ThemeConfig.*from.*schema"
---

<objective>
Define the TypeScript token schema and default theme for the theming system.

Purpose: Establish the data structure that all other theme utilities will operate on. The schema is the contract for what a valid theme configuration looks like.

Output: Zod schema with TypeScript type inference, default neutral gray theme, and validated tests proving schema correctness.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-theme-system-foundation/21-CONTEXT.md
@.planning/phases/21-theme-system-foundation/21-RESEARCH.md
@packages/cli/package.json
@packages/core/src/styles/tailwind.css
</context>

<feature>
  <name>Theme Configuration Schema</name>
  <files>
    packages/cli/src/theme/schema.ts
    packages/cli/src/theme/defaults.ts
    packages/cli/src/theme/index.ts
    packages/cli/tests/theme/schema.test.ts
  </files>
  <behavior>
    Schema validation:
    - Valid OKLCH string "oklch(0.62 0.18 250)" -> passes validation
    - Invalid format "rgb(255, 0, 0)" -> fails with "Invalid OKLCH format" error
    - Missing required field -> fails with descriptive error listing missing field
    - Valid radius values "sm", "md", "lg" -> passes
    - Invalid radius "xl" -> fails with enum error

    Default theme:
    - Has version: 1
    - All 6 base colors present and valid OKLCH
    - Default radius is "md"
    - Colors are neutral gray (low chroma)

    Partial config merge:
    - { colors: { primary: "oklch(0.5 0.2 30)" } } merged with defaults fills all other fields
    - Deep merge preserves nested structure
  </behavior>
  <implementation>
    1. Install zod dependency: pnpm add zod --filter @lit-ui/cli
    2. Create packages/cli/src/theme/schema.ts with:
       - OKLCH regex pattern for validation
       - Zod schema with version, colors (6 fields), radius
       - Export type ThemeConfig via z.infer
       - Export themeConfigSchema
    3. Create packages/cli/src/theme/defaults.ts with:
       - defaultTheme constant matching schema
       - Neutral gray OKLCH values (chroma ~0.02-0.05)
       - Use values from existing tailwind.css as reference
    4. Create packages/cli/src/theme/index.ts barrel exporting schema and defaults
    5. Write tests covering all behaviors above
  </implementation>
</feature>

<verification>
```bash
# Run tests
pnpm test --filter @lit-ui/cli

# Verify schema exports
pnpm exec tsc --noEmit -p packages/cli/tsconfig.json
```
</verification>

<success_criteria>
- All schema tests pass
- TypeScript compiles without errors
- ThemeConfig type is correctly inferred from Zod schema
- Default theme validates against schema
</success_criteria>

<output>
After completion, create `.planning/phases/21-theme-system-foundation/21-01-SUMMARY.md`
</output>

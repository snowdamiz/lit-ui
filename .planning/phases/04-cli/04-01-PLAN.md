---
phase: 04-cli
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/cli/package.json
  - packages/cli/tsconfig.json
  - packages/cli/tsup.config.ts
  - packages/cli/src/index.ts
autonomous: true

must_haves:
  truths:
    - "Running `node packages/cli/dist/index.js --help` shows CLI name, version, and subcommands"
    - "CLI is bundled as ESM with proper shebang"
  artifacts:
    - path: "packages/cli/package.json"
      provides: "CLI package configuration"
      contains: '"bin"'
    - path: "packages/cli/src/index.ts"
      provides: "CLI entry point with citty"
      exports: ["runMain"]
  key_links:
    - from: "packages/cli/src/index.ts"
      to: "citty"
      via: "import { defineCommand, runMain }"
      pattern: "runMain"
---

<objective>
Scaffold the CLI package with TypeScript, tsup bundling, and citty entry point.

Purpose: Establish the CLI project structure that all commands will build upon.
Output: Runnable CLI that shows help when invoked.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-cli/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CLI package structure</name>
  <files>packages/cli/package.json, packages/cli/tsconfig.json</files>
  <action>
Create `packages/cli/` directory with:

1. `package.json`:
   - name: "lit-ui" (the CLI name)
   - type: "module" (ESM)
   - bin: { "lit-ui": "./dist/index.js" }
   - exports with types
   - dependencies: citty, picocolors, ora, consola, fs-extra, package-manager-detector, pathe, defu, execa
   - devDependencies: tsup, @types/fs-extra, typescript
   - scripts: build (tsup), dev (tsup --watch)
   - version: "0.0.1"

2. `tsconfig.json`:
   - extends from root if exists, else create standalone
   - target: ES2022
   - module: ESNext
   - moduleResolution: bundler
   - strict: true
   - outDir: dist
   - include: ["src"]
  </action>
  <verify>Files exist with correct structure</verify>
  <done>package.json has bin field, tsconfig.json compiles</done>
</task>

<task type="auto">
  <name>Task 2: Configure tsup bundling and create entry point</name>
  <files>packages/cli/tsup.config.ts, packages/cli/src/index.ts</files>
  <action>
1. Create `tsup.config.ts`:
   - entry: ["src/index.ts"]
   - format: ["esm"]
   - dts: true
   - clean: true
   - shims: true (for __dirname in ESM)
   - banner with shebang: `#!/usr/bin/env node`
   - target: node18

2. Create `src/index.ts`:
   - Import defineCommand, runMain from citty
   - Read version from package.json using createRequire or import assertion
   - Define main command with:
     - meta: { name: "lit-ui", version, description: "Add lit-ui components to your project" }
     - subCommands: {} (empty for now, will add in later plans)
   - Call runMain(main)

Use citty pattern from research:
```typescript
const main = defineCommand({
  meta: { name: 'lit-ui', version, description: '...' },
  subCommands: {},
});
runMain(main);
```
  </action>
  <verify>cd packages/cli && npm run build && node dist/index.js --help</verify>
  <done>CLI shows help with name "lit-ui" and version</done>
</task>

<task type="auto">
  <name>Task 3: Install dependencies and verify build</name>
  <files>packages/cli/package-lock.json</files>
  <action>
1. cd packages/cli
2. Run npm install to install all dependencies
3. Run npm run build
4. Verify output:
   - dist/index.js exists with shebang
   - dist/index.d.ts exists
   - node dist/index.js --help shows output

If any errors occur, fix them before proceeding.
  </action>
  <verify>node packages/cli/dist/index.js --help shows CLI info</verify>
  <done>CLI builds and runs, showing help output</done>
</task>

</tasks>

<verification>
- `packages/cli/dist/index.js` exists and starts with `#!/usr/bin/env node`
- `node packages/cli/dist/index.js --help` outputs CLI name and version
- TypeScript compiles without errors
</verification>

<success_criteria>
CLI scaffold complete with working help command
</success_criteria>

<output>
After completion, create `.planning/phases/04-cli/04-01-SUMMARY.md`
</output>

---
phase: 103-candlestick-webgpu
plan: "02"
type: execute
wave: 2
depends_on:
  - "103-01"
files_modified:
  - apps/docs/src/pages/charts/CandlestickChartPage.tsx
autonomous: true
requirements:
  - WEBGPU-CNDL-02

must_haves:
  truths:
    - "CandlestickChartPage demo has enable-webgpu attribute set — WebGPU activates automatically in supported browsers without user configuration"
    - "Props table lists enable-webgpu and renderer PropDefs with accurate descriptions matching Phase 101 line/area chart pattern"
    - "WebGPU browser support table appears on the page (Chrome/Edge: yes, Firefox 141+: yes, Safari 26+: yes, fallback: Canvas)"
    - "Tree-shaking callout mentions ChartGPU is dynamically imported and adds zero overhead on unsupported browsers"
  artifacts:
    - path: "apps/docs/src/pages/charts/CandlestickChartPage.tsx"
      provides: "Updated docs page with WebGPU demo and props"
      contains: "enable-webgpu"
    - path: "apps/docs/src/pages/charts/CandlestickChartPage.tsx"
      provides: "WebGPU browser support table"
      contains: "Firefox 141+"
  key_links:
    - from: "CandlestickChartPage.tsx::CandlestickChartDemo()"
      to: "lui-candlestick-chart enable-webgpu"
      via: "enable-webgpu attribute on JSX element"
      pattern: "enable-webgpu"
    - from: "CandlestickChartPage.tsx::candlestickChartProps"
      to: "enable-webgpu PropDef"
      via: "array entry with name: 'enable-webgpu'"
      pattern: "'enable-webgpu'"
---

<objective>
Update `CandlestickChartPage.tsx` to: add `enable-webgpu` to the live demo element, add `enable-webgpu` and `renderer` PropDef entries to the props table, add a WebGPU browser support table, and update the tree-shaking callout to mention ChartGPU.

Purpose: Docs page serves as the user's test ground for WebGPU — the user explicitly requested it uses WebGPU by default. Accurate documentation ensures developers understand WebGPU props, browser support, and the zero-cost fallback.

Output: Updated `CandlestickChartPage.tsx` with WebGPU demo, new props, browser support table, and updated callout.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/103-candlestick-webgpu/103-RESEARCH.md
@.planning/phases/103-candlestick-webgpu/103-01-SUMMARY.md

<interfaces>
<!-- Key patterns extracted from existing docs pages for consistency. -->

From apps/docs/src/pages/charts/LineChartPage.tsx (WebGPU props pattern to follow):
```typescript
// enable-webgpu PropDef:
{
  name: 'enable-webgpu',
  type: 'boolean',
  default: 'false',
  description: 'Opt-in WebGPU rendering via ChartGPU 0.3.2. When set and WebGPU is available (Chrome/Edge, Firefox 141+, Safari 26+), renders data pixels on a GPU-accelerated canvas layer beneath ECharts axes/tooltip. Falls back to Canvas automatically on unsupported browsers.',
},
// renderer PropDef:
{
  name: 'renderer',
  type: "'webgpu' | 'webgl' | 'canvas'",
  default: "'canvas'",
  description: "Read-only property — active renderer tier after the 'renderer-selected' event fires. Do NOT read synchronously before the event; the async GPU probe may not have resolved. Not a Lit @property() — does not trigger reactive updates.",
},
```

From apps/docs/src/pages/charts/CandlestickChartPage.tsx (current state — key sections):
```typescript
// Current demo component:
function CandlestickChartDemo() {
  const ref = useRef<HTMLElement>(null);
  useEffect(() => {
    if (ref.current) {
      (ref.current as any).data = [ /* 5 bars */ ];
    }
  }, []);
  return <lui-candlestick-chart ref={ref as any} style={{ height: '300px', display: 'block' }} />;
  // CHANGE: add enable-webgpu attribute ^^^
}

// Current tree-shaking callout (line 134-137):
// "Tree-shaking tip: Import @lit-ui/charts/candlestick-chart (subpath) instead of
//  @lit-ui/charts to include only this chart's modules (~135KB gzipped vs 350KB+ for all charts)."
// CHANGE: add note about ChartGPU dynamic import

// Current candlestickChartProps array — add enable-webgpu and renderer entries after max-points
```

WebGPU browser support table HTML pattern (match LineChartPage.tsx style):
```tsx
{/* WebGPU Browser Support */}
<div className="mb-8 p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 text-sm text-purple-800 dark:text-purple-200">
  <strong>WebGPU browser support:</strong> Chrome/Edge (stable), Firefox 141+ (nightly/stable as of 2025),
  Safari 26+ (Technology Preview). Unsupported browsers automatically fall back to Canvas — no user action required.
  ChartGPU is dynamically imported and adds zero bundle overhead on Canvas-fallback browsers.
</div>
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add enable-webgpu to demo, add WebGPU props, add browser support callout, update tree-shaking callout</name>
  <files>apps/docs/src/pages/charts/CandlestickChartPage.tsx</files>
  <action>
Make four targeted changes to `CandlestickChartPage.tsx`:

**Change 1 — CandlestickChartDemo(): add `enable-webgpu` to the JSX element.**
Change:
```tsx
return <lui-candlestick-chart ref={ref as any} style={{ height: '300px', display: 'block' }} />;
```
To:
```tsx
return <lui-candlestick-chart ref={ref as any} enable-webgpu style={{ height: '300px', display: 'block' }} />;
```

**Change 2 — candlestickChartProps array: add enable-webgpu and renderer PropDef entries.**
Insert after the existing `max-points` entry (after the `{ name: 'max-points', ... }` object, before `bull-color`):
```typescript
  {
    name: 'enable-webgpu',
    type: 'boolean',
    default: 'false',
    description: 'Opt-in WebGPU rendering via ChartGPU 0.3.2. When set and WebGPU is available (Chrome/Edge, Firefox 141+, Safari 26+), renders OHLC candles on a GPU-accelerated canvas layer beneath ECharts axes/tooltip/MA overlays. Falls back to Canvas automatically on unsupported browsers. MA overlay lines and volume bars always render in ECharts regardless of renderer.',
  },
  {
    name: 'renderer',
    type: "'webgpu' | 'webgl' | 'canvas'",
    default: "'canvas'",
    description: "Read-only property — active renderer tier after the 'renderer-selected' event fires. Do NOT read synchronously before the event; the async GPU probe may not have resolved. Not a Lit @property() — does not trigger reactive updates.",
  },
```

**Change 3 — Tree-shaking callout: append ChartGPU note.**
Change the existing callout text from:
```
Tree-shaking tip: Import @lit-ui/charts/candlestick-chart (subpath) instead of @lit-ui/charts to include only this chart's modules (~135KB gzipped vs 350KB+ for all charts).
```
To:
```tsx
<strong>Tree-shaking tip:</strong> Import <code>@lit-ui/charts/candlestick-chart</code> (subpath) instead of <code>@lit-ui/charts</code> to include only this chart's modules (~135KB gzipped vs 350KB+ for all charts).{' '}
When <code>enable-webgpu</code> is set, ChartGPU 0.3.2 is dynamically imported only when WebGPU is detected — zero additional bundle overhead on Canvas-fallback browsers.
```

**Change 4 — Add WebGPU browser support callout div.**
Insert a new callout div immediately after the tree-shaking callout div (after its closing `</div>` tag, before the `{/* OHLC order warning */}` comment):
```tsx
{/* WebGPU Browser Support */}
<div className="mb-8 p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 text-sm text-purple-800 dark:text-purple-200">
  <strong>WebGPU browser support:</strong> Chrome/Edge (stable), Firefox 141+ (nightly/stable as of 2025),
  Safari 26+ (Technology Preview). Unsupported browsers automatically fall back to Canvas — no user action required.
  Add <code>enable-webgpu</code> to the element; the chart detects support at runtime.
</div>
```
  </action>
  <verify>
    <automated>cd /Users/sn0w/Documents/dev/lit-components && npx tsc -p apps/docs/tsconfig.json --noEmit 2>&1 | head -30</automated>
  </verify>
  <done>CandlestickChartPage.tsx compiles clean; demo JSX has enable-webgpu attribute; candlestickChartProps includes enable-webgpu and renderer entries; WebGPU browser support callout div appears on page; tree-shaking callout mentions ChartGPU dynamic import</done>
</task>

</tasks>

<verification>
```bash
# TypeScript compilation
cd /Users/sn0w/Documents/dev/lit-components && npx tsc -p apps/docs/tsconfig.json --noEmit

# Verify key content
grep -n "enable-webgpu\|Firefox 141\|ChartGPU\|renderer" apps/docs/src/pages/charts/CandlestickChartPage.tsx
```
</verification>

<success_criteria>
- `CandlestickChartPage.tsx` compiles cleanly
- Demo `<lui-candlestick-chart>` element has `enable-webgpu` attribute
- Props table has `enable-webgpu` and `renderer` entries (9 total props including new ones)
- WebGPU browser support callout mentions Chrome/Edge, Firefox 141+, Safari 26+
- Tree-shaking callout mentions ChartGPU dynamic import and zero overhead on Canvas-fallback browsers
</success_criteria>

<output>
After completion, create `.planning/phases/103-candlestick-webgpu/103-02-SUMMARY.md`
</output>

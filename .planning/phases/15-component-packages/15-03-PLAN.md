---
phase: 15-component-packages
plan: 03
type: execute
wave: 2
depends_on: ["15-01", "15-02"]
files_modified:
  - packages/core/src/fouc.css
autonomous: true

must_haves:
  truths:
    - "Both @lit-ui/button and @lit-ui/dialog build successfully"
    - "FOUC prevention CSS targets lui-button and lui-dialog tags"
    - "Type declarations (.d.ts) are generated for both packages"
  artifacts:
    - path: "packages/core/src/fouc.css"
      provides: "FOUC prevention for lui-* components"
      contains: "lui-button"
    - path: "packages/button/dist/index.d.ts"
      provides: "TypeScript declarations for button"
    - path: "packages/dialog/dist/index.d.ts"
      provides: "TypeScript declarations for dialog"
  key_links:
    - from: "packages/core/src/fouc.css"
      to: "lui-button, lui-dialog"
      via: ":not(:defined) selector"
      pattern: "lui-button:not\\(:defined\\)"
---

<objective>
Verify component package builds and update FOUC prevention CSS

Purpose: Ensure both component packages build correctly with type declarations, and update the FOUC prevention CSS to target the new lui-* tag names.

Output: Verified builds with .d.ts files, updated fouc.css with lui-button and lui-dialog selectors
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-component-packages/15-CONTEXT.md

# FOUC file to update
@packages/core/src/fouc.css

# Prior plan SUMMARYs (will exist after 15-01 and 15-02 complete)
@.planning/phases/15-component-packages/15-01-SUMMARY.md
@.planning/phases/15-component-packages/15-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Both Component Packages</name>
  <files></files>
  <action>
Run builds for both component packages and verify output:

1. Clean any existing dist directories:
   ```bash
   rm -rf packages/button/dist packages/dialog/dist
   ```

2. Build both packages:
   ```bash
   pnpm --filter @lit-ui/button build
   pnpm --filter @lit-ui/dialog build
   ```

3. Verify build outputs exist:
   - packages/button/dist/index.js
   - packages/button/dist/index.d.ts
   - packages/button/dist/button.js
   - packages/button/dist/button.d.ts
   - packages/dialog/dist/index.js
   - packages/dialog/dist/index.d.ts
   - packages/dialog/dist/dialog.js
   - packages/dialog/dist/dialog.d.ts

4. Verify type declarations contain expected exports:
   ```bash
   grep "export.*Button" packages/button/dist/index.d.ts
   grep "export.*ButtonVariant" packages/button/dist/index.d.ts
   grep "export.*Dialog" packages/dialog/dist/index.d.ts
   grep "export.*DialogSize" packages/dialog/dist/index.d.ts
   ```

If builds fail, diagnose and fix issues before proceeding.
  </action>
  <verify>
All files exist in dist/ directories
Type declarations export Button, ButtonVariant, ButtonSize, ButtonType, Dialog, DialogSize, CloseReason
  </verify>
  <done>Both component packages build with correct type declarations</done>
</task>

<task type="auto">
  <name>Task 2: Update FOUC Prevention CSS</name>
  <files>packages/core/src/fouc.css</files>
  <action>
Update the FOUC prevention CSS to target the new lui-* tag names instead of ui-*:

```css
/**
 * FOUC Prevention for @lit-ui components
 *
 * Include this CSS in your app's global styles to prevent
 * Flash of Unstyled Content before component JS loads.
 *
 * Usage:
 * @import '@lit-ui/core/fouc.css';
 *
 * Or copy these rules to your own CSS.
 */

/* Hide undefined custom elements */
lui-button:not(:defined),
lui-dialog:not(:defined) {
  opacity: 0;
  visibility: hidden;
}

/* Optional: Show skeleton placeholder instead of hiding */
/*
lui-button:not(:defined) {
  display: inline-block;
  min-width: 80px;
  min-height: 36px;
  background: var(--color-muted, #e5e5e5);
  border-radius: var(--radius-md, 0.375rem);
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
*/
```

Changes:
- ui-button -> lui-button
- ui-dialog -> lui-dialog
- Keep skeleton placeholder pattern commented as optional
  </action>
  <verify>
grep "lui-button:not(:defined)" packages/core/src/fouc.css
grep "lui-dialog:not(:defined)" packages/core/src/fouc.css
Should NOT contain "ui-button" or "ui-dialog" (old names)
  </verify>
  <done>FOUC prevention CSS updated with lui-* tag names</done>
</task>

<task type="auto">
  <name>Task 3: Rebuild Core Package with Updated FOUC CSS</name>
  <files></files>
  <action>
Rebuild the core package to include the updated fouc.css:

```bash
pnpm --filter @lit-ui/core build
```

Verify the fouc.css is correctly included in the build output:
```bash
cat packages/core/dist/fouc.css
```

Should show lui-button and lui-dialog selectors, not ui-button and ui-dialog.

Also verify the full workspace builds without errors:
```bash
pnpm build
```

This ensures all packages work together correctly.
  </action>
  <verify>
packages/core/dist/fouc.css contains "lui-button:not(:defined)"
`pnpm build` succeeds for entire workspace
  </verify>
  <done>Core package rebuilt with updated FOUC CSS, full workspace builds</done>
</task>

</tasks>

<verification>
After all tasks:
1. `ls packages/button/dist/*.d.ts` shows type declarations
2. `ls packages/dialog/dist/*.d.ts` shows type declarations
3. `grep "lui-button" packages/core/dist/fouc.css` shows updated selectors
4. `pnpm build` succeeds for entire workspace
5. No "ui-button" or "ui-dialog" references in dist/ files
</verification>

<success_criteria>
- Both component packages build without errors
- Type declarations generated for both packages
- FOUC prevention CSS uses lui-* tag names
- Full workspace build succeeds
- All requirements COMP-01 through COMP-07 satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/15-component-packages/15-03-SUMMARY.md`
</output>

---
phase: 54-toast
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/toast/package.json
  - packages/toast/tsconfig.json
  - packages/toast/vite.config.ts
  - packages/toast/src/vite-env.d.ts
  - packages/toast/src/types.ts
  - packages/toast/src/icons.ts
  - packages/toast/src/state.ts
  - packages/toast/src/api.ts
  - packages/toast/src/toast.ts
  - packages/toast/src/toaster.ts
  - packages/toast/src/index.ts
  - packages/toast/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "Calling toast('Hello') from a vanilla JS module creates a visible toast notification"
    - "Calling toast.success('Saved'), toast.error('Failed'), toast.warning('Caution'), toast.info('Note') creates correctly-styled variant toasts"
    - "toast.promise(asyncFn, { loading, success, error }) transitions through loading/success/error states"
    - "toast.dismiss(id) removes a specific toast, toast.dismissAll() clears all"
    - "Toasts auto-dismiss after 5 seconds by default; duration:0 creates persistent toasts"
    - "Auto-dismiss pauses on hover and on focus"
    - "Toasts stack with max 3 visible; excess toasts queue and appear as earlier ones dismiss"
    - "6 position options work (top-left, top-center, top-right, bottom-left, bottom-center, bottom-right)"
    - "The toaster auto-creates itself in document.body if not already present"
    - "Toaster renders in the browser top layer via popover=manual"
    - "Each toast has a close button; dismiss via close button works"
    - "Toasts support title + description text"
    - "Toasts support an action button with callback"
    - "Swipe-to-dismiss works via pointer events with velocity-based threshold"
    - "Accessible: role=status with aria-live=polite for info, role=alert with aria-live=assertive for errors"
    - "Enter/exit animations respect prefers-reduced-motion"
    - "CSS custom properties (--ui-toast-*) control all visual theming"
    - "SSR safe: toast API is no-op during server rendering"
    - "Custom content via slot for arbitrary HTML"
  artifacts:
    - path: "packages/toast/src/types.ts"
      provides: "ToastData, ToastPosition, ToastVariant, ToasterState types"
      exports: ["ToastData", "ToastPosition", "ToastVariant", "ToasterState", "ToastOptions"]
    - path: "packages/toast/src/icons.ts"
      provides: "SVG icon templates for success, error, warning, info, loading variants"
      exports: ["toastIcons"]
    - path: "packages/toast/src/state.ts"
      provides: "Singleton state manager with observer pattern"
      exports: ["toastState"]
    - path: "packages/toast/src/api.ts"
      provides: "Imperative toast() function with variant shortcuts and promise mode"
      exports: ["toast"]
    - path: "packages/toast/src/toast.ts"
      provides: "Individual lui-toast element with swipe, timers, accessibility"
      min_lines: 150
    - path: "packages/toast/src/toaster.ts"
      provides: "Container lui-toaster element with queue management, positioning, top-layer"
      min_lines: 100
    - path: "packages/toast/src/index.ts"
      provides: "Registration and public exports"
      exports: ["toast", "Toaster", "Toast"]
    - path: "packages/toast/package.json"
      provides: "Package metadata for @lit-ui/toast"
      contains: "@lit-ui/toast"
  key_links:
    - from: "packages/toast/src/api.ts"
      to: "packages/toast/src/state.ts"
      via: "toast() function pushes to toastState singleton"
      pattern: "toastState"
    - from: "packages/toast/src/toaster.ts"
      to: "packages/toast/src/state.ts"
      via: "Toaster subscribes to toastState and re-renders on changes"
      pattern: "toastState\\.subscribe"
    - from: "packages/toast/src/toaster.ts"
      to: "packages/toast/src/toast.ts"
      via: "Toaster renders lui-toast elements for each visible toast"
      pattern: "lui-toast"
    - from: "packages/toast/src/api.ts"
      to: "packages/toast/src/toaster.ts"
      via: "Auto-creates lui-toaster if not in DOM on first toast() call"
      pattern: "document\\.createElement|lui-toaster"
    - from: "packages/toast/src/toast.ts"
      to: "packages/toast/src/icons.ts"
      via: "Renders variant icon from toastIcons map"
      pattern: "toastIcons"
---

<objective>
Implement the complete `@lit-ui/toast` package with imperative API, singleton state manager, individual toast element, and toaster container -- covering all 19 functional requirements (TOAST-01 through TOAST-19).

Purpose: Provide a framework-agnostic toast notification system with imperative API (`toast.success('Saved')`), queue management, swipe-to-dismiss, and full accessibility -- architecturally distinct from tooltip/popover in that it uses an observer/singleton pattern instead of declarative templates.

Output: A complete `packages/toast/` package with all source files, build configuration, JSX types, and working `toast()` API.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 54 research with full architecture decisions and code examples
@.planning/phases/54-toast/54-RESEARCH.md

# Reference implementation -- tooltip/popover follow the same package pattern
@packages/tooltip/src/tooltip.ts
@packages/tooltip/src/index.ts
@packages/tooltip/package.json
@packages/tooltip/tsconfig.json
@packages/tooltip/vite.config.ts
@packages/tooltip/src/jsx.d.ts

# CSS tokens already defined for toast (--ui-toast-bg, --ui-toast-text, variant colors, etc.)
@packages/core/src/styles/tailwind.css (lines 215-230 for dark mode toast tokens, lines 724-745 for light mode toast tokens)

# Token type definitions
@packages/core/src/tokens/index.ts (ToastToken type)

# Overlay animation reference pattern (toast example: slide + fade)
@packages/core/src/styles/overlay-animation.css

# TailwindElement base class and isServer
@packages/core/src/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold toast package and implement types, icons, and state manager</name>
  <files>
    packages/toast/package.json
    packages/toast/tsconfig.json
    packages/toast/vite.config.ts
    packages/toast/src/vite-env.d.ts
    packages/toast/src/types.ts
    packages/toast/src/icons.ts
    packages/toast/src/state.ts
  </files>
  <action>
    Create the `packages/toast/` directory and scaffold build configuration by copying the exact patterns from `packages/tooltip/`:

    1. **package.json** -- Copy from tooltip. Change:
       - `name` to `@lit-ui/toast`
       - `description` to "Accessible toast notification system built with Lit and Tailwind CSS"
       - `directory` to `packages/toast`
       - Same peerDeps on lit + @lit-ui/core, same devDeps, same scripts, same exports structure
       - Note: toast does NOT depend on @floating-ui/dom (no positioning needed)

    2. **tsconfig.json** -- Identical to tooltip (extends @lit-ui/typescript-config/library.json)

    3. **vite.config.ts** -- Identical to tooltip (`createLibraryConfig({ entry: 'src/index.ts' })`)

    4. **src/vite-env.d.ts** -- Identical to tooltip (triple-slash reference to vite/client)

    Run `pnpm install` to link the workspace.

    5. **src/types.ts** -- Core type definitions:
       ```typescript
       export type ToastVariant = 'default' | 'success' | 'error' | 'warning' | 'info' | 'loading';
       export type ToastPosition = 'top-left' | 'top-center' | 'top-right' | 'bottom-left' | 'bottom-center' | 'bottom-right';

       export interface ToastAction {
         label: string;
         onClick: () => void;
       }

       export interface ToastOptions {
         id?: string;
         variant?: ToastVariant;
         title?: string;
         description?: string;
         duration?: number;        // ms, default 5000, 0 = persistent
         dismissible?: boolean;    // default true, show close X
         action?: ToastAction;
         position?: ToastPosition; // only used if toaster not already configured
         onDismiss?: () => void;
         onAutoClose?: () => void;
       }

       export interface ToastData extends Required<Pick<ToastOptions, 'id' | 'variant' | 'dismissible'>> {
         title?: string;
         description?: string;
         duration: number;
         action?: ToastAction;
         position: ToastPosition;
         onDismiss?: () => void;
         onAutoClose?: () => void;
         createdAt: number;
         // Promise toast support
         promiseState?: 'loading' | 'success' | 'error';
         promiseMessages?: { loading: string; success: string | ((data: unknown) => string); error: string | ((err: unknown) => string) };
       }

       export type Subscriber = () => void;
       ```

    6. **src/icons.ts** -- Inline SVG templates for 6 variants:
       - `success`: checkmark circle (green)
       - `error`: X circle (red)
       - `warning`: exclamation triangle (yellow/amber)
       - `info`: info circle (blue)
       - `loading`: spinning circle (animated SVG with CSS animation)
       - `default`: no icon (returns `nothing`)
       Export as `toastIcons` record mapping `ToastVariant` to Lit `TemplateResult | typeof nothing`.
       Each SVG should be 20x20, stroke-based, using `currentColor` for color (the containing element sets color via CSS custom properties for the variant icon color tokens).

    7. **src/state.ts** -- Singleton state manager (the "engine"):
       ```
       class ToastState {
         private _toasts: ToastData[] = [];
         private _subscribers = new Set<Subscriber>();

         get toasts(): readonly ToastData[] { return this._toasts; }

         subscribe(fn: Subscriber): () => void {
           this._subscribers.add(fn);
           return () => this._subscribers.delete(fn);
         }

         private _notify(): void {
           this._subscribers.forEach(fn => fn());
         }

         add(toast: ToastData): void {
           this._toasts = [toast, ...this._toasts];
           this._notify();
         }

         dismiss(id: string): void {
           const toast = this._toasts.find(t => t.id === id);
           this._toasts = this._toasts.filter(t => t.id !== id);
           toast?.onDismiss?.();
           this._notify();
         }

         dismissAll(): void {
           this._toasts.forEach(t => t.onDismiss?.());
           this._toasts = [];
           this._notify();
         }

         update(id: string, updates: Partial<ToastData>): void {
           this._toasts = this._toasts.map(t =>
             t.id === id ? { ...t, ...updates } : t
           );
           this._notify();
         }
       }

       export const toastState = new ToastState();
       ```
       This is the singleton that connects the imperative `toast()` API to the `<lui-toaster>` web component. ~40 lines, type-safe, no dependencies.
  </action>
  <verify>
    Run `ls packages/toast/package.json packages/toast/tsconfig.json packages/toast/vite.config.ts packages/toast/src/vite-env.d.ts packages/toast/src/types.ts packages/toast/src/icons.ts packages/toast/src/state.ts` -- all 7 files exist.
    Run `pnpm ls --filter @lit-ui/toast` -- package is recognized in the workspace.
  </verify>
  <done>The @lit-ui/toast package exists with build configuration, and the foundation modules (types, icons, state manager) are implemented.</done>
</task>

<task type="auto">
  <name>Task 2: Implement imperative API, toast element, toaster container, and registration</name>
  <files>
    packages/toast/src/api.ts
    packages/toast/src/toast.ts
    packages/toast/src/toaster.ts
    packages/toast/src/index.ts
    packages/toast/src/jsx.d.ts
  </files>
  <action>
    **1. src/api.ts** -- Imperative API (~60 lines):

    The `toast()` function is the public API. It:
    - Accepts `(message: string, options?: ToastOptions)` or `(options: ToastOptions)` (overloaded)
    - Generates a unique `id` via `crypto.randomUUID()` (or counter fallback for SSR)
    - Applies defaults: `variant: 'default'`, `duration: 5000`, `dismissible: true`, `position: 'bottom-right'`
    - Pushes a `ToastData` object to `toastState.add()`
    - Returns the toast `id` (for programmatic dismiss)
    - **SSR guard:** If `typeof document === 'undefined'`, return empty string (no-op)
    - **Auto-create toaster:** Before adding, check `document.querySelector('lui-toaster')`. If not found, create one: `const el = document.createElement('lui-toaster'); document.body.appendChild(el);`

    Variant shortcuts (static methods on the toast function object):
    ```
    toast.success = (message, opts?) => toast(message, { ...opts, variant: 'success' });
    toast.error = (message, opts?) => toast(message, { ...opts, variant: 'error' });
    toast.warning = (message, opts?) => toast(message, { ...opts, variant: 'warning' });
    toast.info = (message, opts?) => toast(message, { ...opts, variant: 'info' });
    toast.dismiss = (id: string) => toastState.dismiss(id);
    toast.dismissAll = () => toastState.dismissAll();
    ```

    Promise toast:
    ```
    toast.promise = <T>(promise: Promise<T>, messages: { loading: string; success: string | ((data: T) => string); error: string | ((err: unknown) => string) }, opts?: ToastOptions): Promise<T> => {
      const id = toast(messages.loading, { ...opts, variant: 'loading', duration: 0 });
      promise.then(
        (data) => toastState.update(id, {
          variant: 'success',
          title: typeof messages.success === 'function' ? messages.success(data) : messages.success,
          promiseState: 'success',
          duration: opts?.duration ?? 5000,
          createdAt: Date.now()
        }),
        (err) => toastState.update(id, {
          variant: 'error',
          title: typeof messages.error === 'function' ? messages.error(err) : messages.error,
          promiseState: 'error',
          duration: opts?.duration ?? 5000,
          createdAt: Date.now()
        })
      );
      return promise;
    };
    ```

    **2. src/toast.ts** -- Individual `<lui-toast>` element (~250 lines):

    Extends `TailwindElement` from `@lit-ui/core`. Tag: `lui-toast`. This is NOT self-registering -- the toaster creates these programmatically.

    Properties:
    - `toastId: string` -- matches ToastData.id
    - `variant: ToastVariant = 'default'`
    - `toastTitle: string` (attribute: `toast-title`) -- avoid HTMLElement.title conflict (same pattern as tooltip's tooltipTitle)
    - `description: string`
    - `duration: number = 5000`
    - `dismissible: boolean = true`
    - `action: ToastAction | undefined` (not an attribute, set via property)
    - `position: ToastPosition = 'bottom-right'`

    Internal state:
    - `_remaining: number` -- remaining time for auto-dismiss
    - `_startTime: number` -- when current timer started
    - `_timerId: ReturnType<typeof setTimeout> | null`
    - `_paused: boolean = false`
    - `_swiping: boolean = false`
    - `_swipeX: number = 0`
    - `_swipeStartX: number = 0`
    - `_swipeStartTime: number = 0`

    Auto-dismiss timer:
    - Start timer in `connectedCallback` (if duration > 0)
    - `_startTimer()`: `_startTime = Date.now(); _timerId = setTimeout(() => this._handleAutoClose(), _remaining)`
    - `_pauseTimer()`: `clearTimeout(_timerId); _remaining -= (Date.now() - _startTime)`
    - `_resumeTimer()`: restart with `_remaining`
    - On hover (`pointerenter`): `_pauseTimer()` (TOAST-14)
    - On hover end (`pointerleave`): `_resumeTimer()` if not swiping
    - On focus within (`focusin`): `_pauseTimer()` (TOAST-14)
    - On focus out (`focusout`): `_resumeTimer()` if not swiping
    - `_handleAutoClose()`: dispatch `toast-close` CustomEvent with `{ detail: { id: toastId, reason: 'auto' } }`, call `onAutoClose` callback

    Swipe-to-dismiss (TOAST-13):
    - Listen for `pointerdown` on the toast element
    - On `pointerdown`: `setPointerCapture(e.pointerId)`, record `_swipeStartX = e.clientX`, `_swipeStartTime = Date.now()`, `_swiping = true`, `_pauseTimer()`
    - On `pointermove`: update `_swipeX = e.clientX - _swipeStartX`, apply `transform: translateX(${_swipeX}px)` and `opacity: ${1 - Math.abs(_swipeX) / 200}` via inline style
    - On `pointerup`/`pointercancel`: check distance threshold (|_swipeX| > 80) OR velocity threshold (|_swipeX| / (Date.now() - _swipeStartTime) > 0.11). If met: dispatch `toast-close` with reason `'swipe'`. If not: animate back to 0 with CSS transition, `_resumeTimer()`.
    - Set `touch-action: pan-y` on the toast element to avoid interfering with vertical scroll (TOAST-13 pitfall)

    Close button (TOAST-06):
    - When `dismissible` is true, render an X button (absolute positioned top-right)
    - On click: dispatch `toast-close` with reason `'dismiss'`

    Action button (TOAST-11):
    - When `action` is defined, render a button with `action.label`
    - On click: call `action.onClick()`, then dispatch `toast-close` with reason `'action'`

    Accessibility (TOAST-08):
    - Set `role` based on variant: `role="alert"` for `error`, `role="status"` for everything else
    - Set `aria-live` based on variant: `aria-live="assertive"` for `error`, `aria-live="polite"` for others
    - Do NOT set both `role="alert"` AND `aria-live="assertive"` together -- `role="alert"` implies assertive
    - So: error gets `role="alert"` only, others get `role="status"` + `aria-live="polite"`
    - `aria-atomic="true"` to announce the full toast content

    Render template:
    - Host element with variant data attribute for styling: `data-variant="${this.variant}"`
    - Icon area (left): render `toastIcons[this.variant]` with variant-specific color class
    - Content area (center): title in `<div class="toast-title">`, description in `<div class="toast-description">`, default slot for custom content (TOAST-15)
    - Action button (if action defined)
    - Close button (if dismissible)

    CSS (static styles):
    - Base: `--ui-toast-*` custom properties for bg, text, border, radius, padding, shadow, max-width
    - `:host` styles: `display: flex; align-items: start; gap: 0.75rem; padding: var(--ui-toast-padding); background: var(--ui-toast-bg); color: var(--ui-toast-text); border: 1px solid var(--ui-toast-border); border-radius: var(--ui-toast-radius); box-shadow: var(--ui-toast-shadow); max-width: var(--ui-toast-max-width); width: 100%; position: relative; touch-action: pan-y; cursor: grab; user-select: none;`
    - Variant overrides using `:host([data-variant="success"])` etc., applying `--ui-toast-success-bg`, `--ui-toast-success-border` etc.
    - Icon color: `color: var(--ui-toast-success-icon)` etc. for each variant
    - Close button: absolute top-right, 20x20, hover opacity
    - Action button: text button style with underline
    - Loading spinner animation: `@keyframes spin { to { transform: rotate(360deg) } }`

    AbortController cleanup: create in connectedCallback, abort in disconnectedCallback. All pointer event listeners use `{ signal }`.

    **3. src/toaster.ts** -- Container `<lui-toaster>` element (~200 lines):

    Extends `TailwindElement` from `@lit-ui/core`. Tag: `lui-toaster`.

    Properties:
    - `position: ToastPosition = 'bottom-right'`
    - `maxVisible: number = 3` (attribute: `max-visible`)
    - `gap: number = 12` -- gap between toasts in px

    Internal state:
    - `_toasts: ToastData[] = []` -- local copy from state manager
    - `_unsubscribe: (() => void) | null = null`

    Lifecycle:
    - `connectedCallback()`:
      - SSR guard: if `isServer`, return early
      - Subscribe to `toastState`: `this._unsubscribe = toastState.subscribe(() => { this._toasts = [...toastState.toasts]; this.requestUpdate(); })`
      - Show the popover panel: call `showPopover()` on the wrapper element after first update
    - `disconnectedCallback()`:
      - Call `this._unsubscribe?.()` to unsubscribe from state
      - Abort controller cleanup

    Popover API top-layer (TOAST-17):
    - The toaster wrapper div has `popover="manual"` attribute
    - On connect: after `updateComplete`, call `this._popoverEl.showPopover()` to promote to top layer
    - The popover is always "open" (manual mode never auto-closes) -- it just holds the toast list
    - Override UA popover styles: `margin: 0; padding: 0; border: none; background: transparent; position: fixed; inset: auto;`

    Position mapping (TOAST-05):
    - Map `position` to CSS position values:
      - `top-left`: `top: 1rem; left: 1rem; align-items: flex-start`
      - `top-center`: `top: 1rem; left: 50%; transform: translateX(-50%); align-items: center`
      - `top-right`: `top: 1rem; right: 1rem; align-items: flex-end`
      - `bottom-left`: `bottom: 1rem; left: 1rem; align-items: flex-start`
      - `bottom-center`: `bottom: 1rem; left: 50%; transform: translateX(-50%); align-items: center`
      - `bottom-right`: `bottom: 1rem; right: 1rem; align-items: flex-end`
    - Apply via inline style on the container based on `this.position`

    Queue management (TOAST-07):
    - `get _visibleToasts()`: `this._toasts.slice(0, this.maxVisible)`
    - Remaining toasts are in `this._toasts.slice(this.maxVisible)` -- they stay in the queue and render when earlier ones dismiss

    Accessible live regions (TOAST-08):
    - Pre-register two empty live regions in the toaster's render:
      - `<div role="status" aria-live="polite" aria-atomic="true" class="sr-only"></div>`
      - `<div role="alert" aria-atomic="true" class="sr-only"></div>`
    - These MUST be in the DOM before toast content is injected (pitfall from research)
    - The individual `<lui-toast>` elements handle their own role/aria-live -- the pre-registered regions serve as a backup announcement mechanism

    Toast close handling:
    - Listen for `toast-close` custom event from child `<lui-toast>` elements
    - On close: call `toastState.dismiss(id)` which triggers state update, which triggers re-render

    Enter/exit animations (TOAST-09):
    - Each `<lui-toast>` gets a `data-open` attribute when mounted
    - Use `@starting-style` for entry animation (slide + fade per overlay-animation.css toast example)
    - Translate direction depends on position: `translateY(100%)` for bottom positions, `translateY(-100%)` for top positions
    - Exit: remove `data-open`, CSS transition handles fade-out. Use `transitionend` event to actually remove from DOM after animation completes.
    - `prefers-reduced-motion`: disable transitions (TOAST-09)
    - NOTE: For exit animation to work, do NOT immediately remove the toast from the render. Instead, mark it as "exiting" and wait for `transitionend`. Use a local `_exitingIds: Set<string>` to track which toasts are animating out.

    Render template:
    - Outer div with `popover="manual"` + position styles
    - List container (flex column with gap)
    - `repeat()` directive over `_visibleToasts` keyed by toast.id
    - Each renders `<lui-toast .toastId=${t.id} .variant=${t.variant} .toastTitle=${t.title} ...>` with all properties spread
    - For toasts with `description`, pass as property
    - For toasts with custom content slot, allow slotted content

    CSS (static styles):
    - `.toaster-wrapper[popover]`: reset UA styles (margin:0, border:none, padding:0, background:transparent)
    - `.toaster-wrapper`: `position: fixed; z-index: var(--ui-toast-z-index); display: flex; flex-direction: column; gap: var(--ui-toast-gap); pointer-events: none; max-height: 100vh; overflow: hidden;`
    - For top positions: `flex-direction: column` (newest at top)
    - For bottom positions: `flex-direction: column-reverse` (newest at bottom, stacks upward)
    - `lui-toast` inside toaster: `pointer-events: auto;` (re-enable interaction)
    - `.sr-only`: visually hidden but available to screen readers
    - Entry animation using `@starting-style` + `transition-behavior: allow-discrete`

    **4. src/index.ts** -- Follow tooltip pattern:
    - Export `toast` function from api.ts
    - Export `Toaster` class and `Toast` class
    - Export all types from types.ts
    - Re-export `TailwindElement` and `isServer` from `@lit-ui/core`
    - Safe `customElements.define` with collision detection for both `lui-toaster` and `lui-toast`
    - Global `HTMLElementTagNameMap` declaration for both elements

    **5. src/jsx.d.ts** -- Follow tooltip pattern:
    - `LuiToasterAttributes` interface with `position`, `max-visible` properties
    - `LuiToastAttributes` interface with `toast-id`, `variant`, `toast-title`, `description`, `duration`, `dismissible` properties
    - React, Vue, Svelte type declarations for both `lui-toaster` and `lui-toast`
  </action>
  <verify>
    Run `cd packages/toast && pnpm build` -- builds without errors.
    Run `ls packages/toast/dist/index.js packages/toast/dist/index.d.ts` -- output files exist.
    Grep for key patterns in the source files:
    - `toast.success`, `toast.error`, `toast.promise` in api.ts
    - `toastState.subscribe` in toaster.ts
    - `setPointerCapture` in toast.ts (swipe)
    - `popover="manual"` in toaster.ts (top-layer)
    - `role="status"`, `role="alert"`, `aria-live` in toast.ts (accessibility)
    - `@starting-style` in toaster.ts or toast.ts (animations)
    - `prefers-reduced-motion` in styles
    - `isServer` guard in api.ts
    - `AbortController` in toast.ts
    - `toast-close` custom event in toast.ts
    - `touch-action: pan-y` in toast.ts styles
  </verify>
  <done>
    The complete toast notification system implements all 19 functional requirements:
    - TOAST-01: Variants with distinct colors and icons
    - TOAST-02: Auto-dismiss with configurable duration, pause on hover/focus
    - TOAST-03: Imperative API with toast(), toast.success(), toast.error(), etc.
    - TOAST-04: Auto-creating toaster container
    - TOAST-05: 6 position options
    - TOAST-06: Dismiss button
    - TOAST-07: Queue management with maxVisible
    - TOAST-08: Accessible live regions
    - TOAST-09: Enter/exit animations with reduced motion
    - TOAST-10: Title + description support
    - TOAST-11: Action button with callback
    - TOAST-12: Promise toast with state transitions
    - TOAST-13: Swipe-to-dismiss via Pointer Events
    - TOAST-14: Pause on hover and focus
    - TOAST-15: Custom content via slot
    - TOAST-16: CSS custom properties for theming
    - TOAST-17: Top-layer via popover=manual
    - TOAST-18: SSR safe
    - TOAST-19: Framework-agnostic imperative API
    The package builds successfully and produces dist/index.js and dist/index.d.ts.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build --filter @lit-ui/toast` succeeds without errors
2. `dist/index.js` and `dist/index.d.ts` exist in packages/toast/dist/
3. The package exports `toast` function, `Toaster` class, and `Toast` class
4. Imperative API: `toast()`, `toast.success()`, `toast.error()`, `toast.warning()`, `toast.info()`, `toast.dismiss()`, `toast.dismissAll()`, `toast.promise()` all exist
5. Observer pattern: `toastState` singleton connects API to toaster via subscribe/notify
6. Auto-create: `toast()` checks for `lui-toaster` and creates one if missing
7. Top-layer: `popover="manual"` on toaster wrapper
8. Accessibility: `role="status"` / `role="alert"` on toast elements based on variant
9. Swipe: `setPointerCapture`, `pointermove`, threshold checks in toast.ts
10. Animations: `@starting-style` + `transition-behavior: allow-discrete` in styles
11. Reduced motion: `prefers-reduced-motion` media query
12. SSR: `isServer` / `typeof document` guards
13. Cleanup: AbortController in toast.ts connectedCallback/disconnectedCallback
</verification>

<success_criteria>
The @lit-ui/toast package builds successfully with a complete toast notification system that:
- Provides an imperative `toast()` API with variant shortcuts and promise mode
- Auto-creates a `<lui-toaster>` container on first call
- Manages a toast queue with configurable maxVisible count
- Supports 6 position options via CSS positioning
- Renders in the top layer via `popover="manual"`
- Handles swipe-to-dismiss with Pointer Events and velocity detection
- Pauses auto-dismiss on hover and focus
- Has full ARIA accessibility with role/aria-live based on variant
- Animates enter/exit with `@starting-style` respecting reduced motion
- Is SSR safe with all DOM APIs guarded
- Uses CSS custom properties from Phase 51 tokens for all visual theming
</success_criteria>

<output>
After completion, create `.planning/phases/54-toast/54-01-SUMMARY.md`
</output>

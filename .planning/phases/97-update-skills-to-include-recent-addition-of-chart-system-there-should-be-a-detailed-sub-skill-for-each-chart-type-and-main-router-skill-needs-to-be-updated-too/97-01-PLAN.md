---
phase: 97-update-skills-to-include-recent-addition-of-chart-system-there-should-be-a-detailed-sub-skill-for-each-chart-type-and-main-router-skill-needs-to-be-updated-too
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skill/SKILL.md
  - skill/skills/charts/SKILL.md
autonomous: true
requirements:
  - SKILL-ROUTER
  - SKILL-CHARTS-OVERVIEW

must_haves:
  truths:
    - "Main router skill/SKILL.md routes chart questions to skills/charts and the 8 chart sub-skills"
    - "skill/SKILL.md Component Overview section lists charts as category 6 with all 8 lui-*-chart elements"
    - "skill/SKILL.md Available Sub-Skills lists entries 24-31 for each chart type and entry 32 for charts overview"
    - "skills/charts/SKILL.md exists and routes by chart type to the individual chart sub-skills"
    - "skills/charts/SKILL.md documents all shared BaseChartElement props, methods, events, and CSS custom properties"
  artifacts:
    - path: "skill/SKILL.md"
      provides: "Updated main router with chart section"
      contains: "skills/charts"
    - path: "skill/skills/charts/SKILL.md"
      provides: "Charts overview and secondary router"
      contains: "lui-line-chart"
  key_links:
    - from: "skill/SKILL.md"
      to: "skill/skills/charts/SKILL.md"
      via: "routing rule for chart questions"
      pattern: "skills/charts"
    - from: "skill/skills/charts/SKILL.md"
      to: "skill/skills/line-chart/SKILL.md"
      via: "sub-skill routing"
      pattern: "skills/line-chart"
---

<objective>
Update the main lit-ui skill router to cover charts and create the charts overview skill that acts as a secondary router for all 8 chart types.

Purpose: AI assistants currently have zero coverage for @lit-ui/charts. Without router entries, chart questions will never reach the chart sub-skills. The router update and overview skill are the prerequisite foundation for all chart skill coverage.
Output: Updated skill/SKILL.md with charts in Component Overview + Available Sub-Skills + Routing Rules. New skill/skills/charts/SKILL.md as a secondary router covering shared BaseChartElement API.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/97-update-skills-to-include-recent-addition-of-chart-system-there-should-be-a-detailed-sub-skill-for-each-chart-type-and-main-router-skill-needs-to-be-updated-too/97-RESEARCH.md

<interfaces>
<!-- Current skill/SKILL.md structure for reference -->
<!-- Main sections to update:
  ## Component Overview — add item 6 for charts
  ## Available Sub-Skills — add items 24-31 (8 chart types) + skills/charts as overview router
  ## Routing Rules — add chart routing rules
-->

<!-- From 97-RESEARCH.md: Shared BaseChartElement props -->
Shared props (all 8 charts):
  data            — JS property only (attribute: false). Type depends on chart.
  option          — JS property only (attribute: false). EChartsOption passthrough.
  loading         — boolean, default false. Shows ECharts loading skeleton.
  enableGl        — enable-gl attribute. boolean, default false. WebGL via echarts-gl.
  maxPoints       — max-points attribute. number, default 1000. Circular buffer cap.

Shared methods:
  pushData(point) — (point: unknown) => void. RAF-coalesced. Not supported on treemap.
  getChart()      — () => EChartsType | undefined. Direct ECharts instance access.

Shared events:
  ui-webgl-unavailable — { reason: string }. Fires when enable-gl set but WebGL unavailable.

Shared CSS custom properties (17 tokens):
  --ui-chart-height           300px
  --ui-chart-color-1 through --ui-chart-color-8  (#3b82f6, #8b5cf6, #10b981, #f59e0b, #ef4444, #06b6d4, #f97316, #84cc16)
  --ui-chart-grid-line        #e5e7eb
  --ui-chart-axis-label       #6b7280
  --ui-chart-axis-line        #d1d5db
  --ui-chart-tooltip-bg       #ffffff
  --ui-chart-tooltip-border   #e5e7eb
  --ui-chart-tooltip-text     #111827
  --ui-chart-legend-text      #374151
  --ui-chart-font-family      system-ui, sans-serif
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update skill/SKILL.md main router with chart entries</name>
  <files>skill/SKILL.md</files>
  <action>
Read the current skill/SKILL.md in full. Make the following targeted additions — do not alter any existing content:

1. In `## Component Overview`, replace the current item 6 (`6. All form components participate in HTML forms via ElementInternals.`) — wait, do NOT change the form item. Instead, renumber the existing item 6 to item 7 and insert a new item 6:
   `6. Charts: \`<lui-line-chart>\`, \`<lui-area-chart>\`, \`<lui-bar-chart>\`, \`<lui-pie-chart>\`, \`<lui-scatter-chart>\`, \`<lui-heatmap-chart>\`, \`<lui-candlestick-chart>\`, \`<lui-treemap-chart>\`.`

2. In `## Available Sub-Skills`, after entry 23 (`skills/ssr`), add a blank line then a new section:

```
**Charts (load the specific chart skill when a chart component is mentioned):**

24. `skills/charts` — Charts overview: which chart to use, shared BaseChartElement API (data, pushData, getChart, CSS tokens), React integration
25. `skills/line-chart` — lui-line-chart: smooth, zoom, markLines, multi-series, appendData streaming
26. `skills/area-chart` — lui-area-chart: smooth, stacked, zoom, labelPosition, appendData streaming
27. `skills/bar-chart` — lui-bar-chart: grouped/stacked/horizontal, showLabels, colorByData, pushData streaming
28. `skills/pie-chart` — lui-pie-chart: pie and donut mode, minPercent slice merging, innerRadius, centerLabel
29. `skills/scatter-chart` — lui-scatter-chart: bubble mode, enable-gl WebGL for 500K+ points, pushData streaming
30. `skills/heatmap-chart` — lui-heatmap-chart: xCategories/yCategories (JS props), colorRange, cell-update pushData
31. `skills/candlestick-chart` — lui-candlestick-chart: OHLC [open,close,low,high] order, showVolume, movingAverages, pushData
32. `skills/treemap-chart` — lui-treemap-chart: hierarchical data, breadcrumb, rounded, levelColors (NO pushData)
```

3. In `## Routing Rules`, after the existing 6 rules, add:
   `7. For any question about chart components (lui-*-chart, @lit-ui/charts, ECharts data, pushData streaming), load \`skills/charts\` first, then load the specific chart skill.`
   `8. For "which chart should I use" or "chart type selection" questions, load \`skills/charts\` only.`

Write the updated file preserving all existing content exactly.
  </action>
  <verify>
    <automated>grep -c "skills/charts" /Users/sn0w/Documents/dev/lit-components/skill/SKILL.md</automated>
  </verify>
  <done>skill/SKILL.md contains references to skills/charts, all 8 chart sub-skill entries (skills/line-chart through skills/treemap-chart), and chart routing rules. Existing 23 sub-skills and all routing content preserved.</done>
</task>

<task type="auto">
  <name>Task 2: Create skill/skills/charts/SKILL.md overview and secondary router</name>
  <files>skill/skills/charts/SKILL.md</files>
  <action>
Create the directory skill/skills/charts/ and write skill/skills/charts/SKILL.md.

This file is the secondary router for all chart questions. It must:
- Document which chart to use for which use case (routing table)
- Document the complete shared BaseChartElement API (props, methods, events, CSS tokens)
- Provide the React integration pattern (useRef + useEffect)
- Route to individual chart sub-skills for chart-specific details
- Note the JS property rule prominently (data, option, xCategories, yCategories are attribute:false)

Structure:

```markdown
---
name: lit-ui-charts
description: >-
  How to use @lit-ui/charts — shared chart API, which chart type to use, React integration,
  CSS tokens, streaming with pushData(). Routes to individual chart sub-skills for chart-specific props.
---

# Charts

@lit-ui/charts provides 8 high-performance chart components built on ECharts + ECharts GL. All charts are web components with the lui- prefix. Data must be set as JS properties — not HTML attributes.

## Which Chart Type To Use

| Use Case | Component | Import |
|----------|-----------|--------|
| Time series, trend lines, multiple named series | `lui-line-chart` | `@lit-ui/charts/line-chart` |
| Filled area under a line, stacked areas | `lui-area-chart` | `@lit-ui/charts/area-chart` |
| Grouped, stacked, or horizontal bars | `lui-bar-chart` | `@lit-ui/charts/bar-chart` |
| Part-to-whole proportions, donut with center label | `lui-pie-chart` | `@lit-ui/charts/pie-chart` |
| X/Y point clouds, bubble charts, 500K+ points | `lui-scatter-chart` | `@lit-ui/charts/scatter-chart` |
| Matrix of cell values by two category axes | `lui-heatmap-chart` | `@lit-ui/charts/heatmap-chart` |
| OHLC financial candlestick with volume | `lui-candlestick-chart` | `@lit-ui/charts/candlestick-chart` |
| Hierarchical space-filling rectangle layout | `lui-treemap-chart` | `@lit-ui/charts/treemap-chart` |

## Installation

```sh
# npm install
npm install @lit-ui/charts
# CLI copy-source
npx lit-ui add line-chart   # (or area-chart, bar-chart, pie-chart, scatter-chart, heatmap-chart, candlestick-chart, treemap-chart)
```

## Usage

**CRITICAL:** `data`, `option`, `xCategories`, and `yCategories` are JS properties — they cannot be set as HTML attributes. Always assign via element reference.

```js
import '@lit-ui/charts/line-chart';

const chart = document.querySelector('lui-line-chart');
chart.data = [
  { name: 'Sales', data: [120, 200, 150, 80, 70, 110, 130] },
];
```

```tsx
// React — useRef + useEffect required for ALL .data assignments
import { useRef, useEffect } from 'react';

function LineChartDemo({ data }) {
  const ref = useRef(null);
  useEffect(() => {
    if (ref.current) ref.current.data = data;
  }, [data]);
  return <lui-line-chart ref={ref} smooth zoom />;
}
```

## Shared Props (All 8 Charts)

| Prop | Attribute | Type | Default | Description |
|------|-----------|------|---------|-------------|
| `data` | — (JS only) | chart-specific | `undefined` | Chart data. Must be JS property. |
| `option` | — (JS only) | `EChartsOption` | `undefined` | Raw ECharts option passthrough for advanced use. |
| `loading` | `loading` | `boolean` | `false` | Show ECharts loading skeleton. |
| `enableGl` | `enable-gl` | `boolean` | `false` | Opt-in WebGL via echarts-gl (meaningful on scatter chart). |
| `maxPoints` | `max-points` | `number` | `1000` | Circular buffer capacity for streaming via pushData(). |

## Shared Methods (All 8 Charts)

| Method | Signature | Description |
|--------|-----------|-------------|
| `pushData(point)` | `(point: unknown) => void` | Stream one data point. RAF-coalesced. **Not supported on treemap** (logs console.warn). |
| `getChart()` | `() => EChartsType \| undefined` | Direct ECharts instance for event binding and advanced customization. |

## Shared Events (All 8 Charts)

| Event | Detail | Description |
|-------|--------|-------------|
| `ui-webgl-unavailable` | `{ reason: string }` | Fires when `enable-gl` is set but WebGL is unavailable. Chart falls back to Canvas automatically. |

## Shared CSS Custom Properties (All 8 Charts)

| Property | Default | Description |
|----------|---------|-------------|
| `--ui-chart-height` | `300px` | Chart host element height. |
| `--ui-chart-color-1` | `#3b82f6` | Series 1 color. |
| `--ui-chart-color-2` | `#8b5cf6` | Series 2 color. |
| `--ui-chart-color-3` | `#10b981` | Series 3 color. |
| `--ui-chart-color-4` | `#f59e0b` | Series 4 color. |
| `--ui-chart-color-5` | `#ef4444` | Series 5 color. |
| `--ui-chart-color-6` | `#06b6d4` | Series 6 color. |
| `--ui-chart-color-7` | `#f97316` | Series 7 color. |
| `--ui-chart-color-8` | `#84cc16` | Series 8 color. |
| `--ui-chart-grid-line` | `#e5e7eb` | Grid line color. |
| `--ui-chart-axis-label` | `#6b7280` | Axis label text color. |
| `--ui-chart-axis-line` | `#d1d5db` | Axis line color. |
| `--ui-chart-tooltip-bg` | `#ffffff` | Tooltip background. |
| `--ui-chart-tooltip-border` | `#e5e7eb` | Tooltip border color. |
| `--ui-chart-tooltip-text` | `#111827` | Tooltip text color. |
| `--ui-chart-legend-text` | `#374151` | Legend text color. |
| `--ui-chart-font-family` | `system-ui, sans-serif` | Font family for all chart text. |

## Streaming with pushData()

```js
const chart = document.querySelector('lui-line-chart');
chart.data = [{ name: 'Live', data: [] }];

setInterval(() => {
  chart.pushData(Math.random() * 100);
  // Multiple pushData() calls in the same animation frame are batched automatically
}, 100);
```

Supported on: line, area, bar, pie, scatter, heatmap, candlestick.
NOT supported on: treemap (pushData() is a no-op with console.warn — reassign .data instead).

## Dark Mode

Charts respect the `.dark` class on `document.documentElement` — same pattern as all other LitUI components. All 17 CSS tokens update automatically when dark mode toggles. Override any token to retheme.

## Sub-Skills

Load the specific sub-skill for chart-specific props, data type definitions, and behavior notes:

- `skills/line-chart` — lui-line-chart
- `skills/area-chart` — lui-area-chart
- `skills/bar-chart` — lui-bar-chart
- `skills/pie-chart` — lui-pie-chart
- `skills/scatter-chart` — lui-scatter-chart
- `skills/heatmap-chart` — lui-heatmap-chart
- `skills/candlestick-chart` — lui-candlestick-chart
- `skills/treemap-chart` — lui-treemap-chart
```

Write this content exactly (substituting the actual markdown without the outer code block fencing) to skill/skills/charts/SKILL.md.
  </action>
  <verify>
    <automated>grep -c "lui-line-chart\|lui-treemap-chart\|pushData\|--ui-chart-color-1" /Users/sn0w/Documents/dev/lit-components/skill/skills/charts/SKILL.md</automated>
  </verify>
  <done>skill/skills/charts/SKILL.md exists, contains the chart type selection table, shared BaseChartElement API (all 5 props, 2 methods, 1 event), all 17 CSS custom properties, streaming example, and sub-skill routing list.</done>
</task>

</tasks>

<verification>
1. `grep -c "skills/charts" skill/SKILL.md` returns >= 3 (routing rule + sub-skills section + component overview)
2. `grep "skills/line-chart\|skills/treemap-chart" skill/SKILL.md` returns matches for all 8 chart types
3. `ls skill/skills/charts/SKILL.md` exists
4. `grep "pushData\|--ui-chart-color" skill/skills/charts/SKILL.md` returns matches
5. All 23 existing sub-skill entries in skill/SKILL.md are preserved (no accidental deletion)
</verification>

<success_criteria>
- skill/SKILL.md routes chart questions to skills/charts and the 8 chart sub-skills
- skill/skills/charts/SKILL.md provides shared API documentation and secondary routing
- No existing content in skill/SKILL.md altered or deleted
</success_criteria>

<output>
After completion, create `.planning/phases/97-update-skills-to-include-recent-addition-of-chart-system-there-should-be-a-detailed-sub-skill-for-each-chart-type-and-main-router-skill-needs-to-be-updated-too/97-01-SUMMARY.md`
</output>

---
phase: 13-monorepo-infrastructure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/typescript-config/package.json
  - packages/typescript-config/base.json
  - packages/typescript-config/library.json
  - packages/vite-config/package.json
  - packages/vite-config/library.js
autonomous: true

must_haves:
  truths:
    - "Component packages can extend shared TypeScript config"
    - "Component packages can use shared Vite library config"
    - "Shared configs are internal packages (not published)"
  artifacts:
    - path: "packages/typescript-config/base.json"
      provides: "Base TypeScript configuration for all packages"
      contains: "experimentalDecorators"
    - path: "packages/typescript-config/library.json"
      provides: "TypeScript configuration for library builds"
      contains: "declaration"
    - path: "packages/vite-config/library.js"
      provides: "Vite library build configuration factory"
      contains: "createLibraryConfig"
  key_links:
    - from: "packages/button/tsconfig.json"
      to: "@lit-ui/typescript-config/library.json"
      via: "extends"
      pattern: "@lit-ui/typescript-config"
---

<objective>
Create shared TypeScript and Vite configuration packages for workspace consistency.

Purpose: Ensure all component packages build with identical settings - same TypeScript strictness, same Vite library mode configuration, same declaration output. Prevents drift and reduces per-package boilerplate.

Output: Two internal config packages: @lit-ui/typescript-config and @lit-ui/vite-config
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/13-monorepo-infrastructure/13-RESEARCH.md
@tsconfig.json
@vite.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create @lit-ui/typescript-config package</name>
  <files>packages/typescript-config/package.json, packages/typescript-config/base.json, packages/typescript-config/library.json</files>
  <action>
Create packages/typescript-config/ directory with:

**package.json:**
```json
{
  "name": "@lit-ui/typescript-config",
  "version": "0.0.1",
  "private": true,
  "type": "module",
  "exports": {
    "./base.json": "./base.json",
    "./library.json": "./library.json"
  },
  "files": ["*.json"]
}
```

**base.json** (common settings for all packages):
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "experimentalDecorators": true,
    "useDefineForClassFields": false,
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "lib": ["ES2022", "DOM", "DOM.Iterable"]
  }
}
```

**library.json** (extends base, adds declaration generation for publishable packages):
```json
{
  "extends": "./base.json",
  "compilerOptions": {
    "declaration": true,
    "declarationMap": true,
    "noEmit": false
  }
}
```

These match existing tsconfig.json settings from root, ensuring consistency.
  </action>
  <verify>Run `ls packages/typescript-config/` to confirm all files exist</verify>
  <done>@lit-ui/typescript-config package exists with base.json and library.json</done>
</task>

<task type="auto">
  <name>Task 2: Create @lit-ui/vite-config package</name>
  <files>packages/vite-config/package.json, packages/vite-config/library.js</files>
  <action>
Create packages/vite-config/ directory with:

**package.json:**
```json
{
  "name": "@lit-ui/vite-config",
  "version": "0.0.1",
  "private": true,
  "type": "module",
  "exports": {
    "./library": "./library.js"
  },
  "files": ["*.js"],
  "peerDependencies": {
    "vite": "^7.0.0",
    "vite-plugin-dts": "^4.0.0",
    "@tailwindcss/vite": "^4.0.0"
  }
}
```

**library.js** (factory function for Vite library builds):
```javascript
import { defineConfig } from 'vite';
import tailwindcss from '@tailwindcss/vite';
import dts from 'vite-plugin-dts';

/**
 * Create Vite config for Lit component library builds
 * @param {Object} options
 * @param {string} options.entry - Entry file path (default: 'src/index.ts')
 * @param {string} [options.entryRoot] - Root for dts plugin (default: 'src')
 */
export function createLibraryConfig(options = {}) {
  const entry = options.entry || 'src/index.ts';
  const entryRoot = options.entryRoot || 'src';

  return defineConfig({
    plugins: [
      tailwindcss(),
      dts({
        rollupTypes: true,
        entryRoot
      })
    ],
    build: {
      lib: {
        entry,
        formats: ['es'],
        fileName: 'index'
      },
      rollupOptions: {
        external: ['lit', /^lit\//, /^@lit\//, /^@lit-ui\//]
      }
    }
  });
}
```

Key patterns:
- Externalize lit and all @lit-ui packages (never bundle dependencies)
- Use Tailwind Vite plugin for CSS processing
- Generate rolled-up .d.ts declarations
- ESM-only output
  </action>
  <verify>Run `cat packages/vite-config/library.js | head -20` to confirm factory function</verify>
  <done>@lit-ui/vite-config package exists with createLibraryConfig factory</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Verify typescript-config: `ls packages/typescript-config/`
2. Verify vite-config: `ls packages/vite-config/`
3. Confirm base.json has Lit settings: `grep "experimentalDecorators" packages/typescript-config/base.json`
4. Confirm library.js exports factory: `grep "createLibraryConfig" packages/vite-config/library.js`
</verification>

<success_criteria>
- packages/typescript-config/ exists with base.json and library.json
- packages/vite-config/ exists with library.js factory function
- Both packages have valid package.json with exports field
- Both marked private: true (internal, not published)
</success_criteria>

<output>
After completion, create `.planning/phases/13-monorepo-infrastructure/13-02-SUMMARY.md`
</output>

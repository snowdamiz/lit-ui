---
phase: 44-date-picker-core
plan: 05
type: execute
wave: 5
depends_on: [44-04]
files_modified:
  - packages/date-picker/src/index.ts
  - packages/date-picker/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "lui-date-picker custom element is registered via index.ts"
    - "DatePicker class is exported for programmatic use"
    - "React JSX types declare lui-date-picker with all props and events"
    - "Full package builds without errors via pnpm workspace"
  artifacts:
    - path: "packages/date-picker/src/index.ts"
      provides: "Public exports and custom element registration"
      exports: ["DatePicker", "parseDateInput", "formatDateForDisplay", "getPlaceholderText"]
      contains: "customElements.define"
    - path: "packages/date-picker/src/jsx.d.ts"
      provides: "React JSX type declarations for lui-date-picker"
      contains: "lui-date-picker"
  key_links:
    - from: "packages/date-picker/src/index.ts"
      to: "packages/date-picker/src/date-picker.ts"
      via: "export { DatePicker } from './date-picker.js'"
      pattern: "export.*DatePicker.*date-picker"
    - from: "packages/date-picker/src/index.ts"
      to: "packages/date-picker/src/date-input-parser.ts"
      via: "export { parseDateInput, formatDateForDisplay, getPlaceholderText }"
      pattern: "export.*parseDateInput.*date-input-parser"
---

<objective>
Create the public package entry point (index.ts) with custom element registration and React JSX type declarations.

Purpose: This finalizes the package for consumption â€” registering the custom element, exporting the class and utilities, and providing TypeScript support for React users.
Output: index.ts with exports and registration + jsx.d.ts with React JSX types.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/44-date-picker-core/44-04-SUMMARY.md

Reference patterns from:
@packages/calendar/src/index.ts (custom element registration with collision detection)
@packages/calendar/src/jsx.d.ts (React JSX type declarations)
@packages/input/src/index.ts (form component exports pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create index.ts with exports and custom element registration</name>
  <files>packages/date-picker/src/index.ts</files>
  <action>
    Create `packages/date-picker/src/index.ts` following the exact @lit-ui/calendar pattern:

    ```typescript
    // @lit-ui/date-picker - Accessible date picker component with SSR support
    /// <reference path="./jsx.d.ts" />
    import { isServer } from 'lit';

    // Export component class
    export { DatePicker } from './date-picker.js';

    // Export date parsing utilities for consumer use
    export { parseDateInput, formatDateForDisplay, getPlaceholderText } from './date-input-parser.js';

    // Re-export TailwindElement and isServer for convenience
    export { TailwindElement, isServer } from '@lit-ui/core';

    // Safe custom element registration with collision detection
    import { DatePicker } from './date-picker.js';

    if (typeof customElements !== 'undefined') {
      if (!customElements.get('lui-date-picker')) {
        customElements.define('lui-date-picker', DatePicker);
      } else if (!isServer && import.meta.env?.DEV) {
        console.warn(
          '[lui-date-picker] Custom element already registered. ' +
            'This may indicate duplicate imports or version conflicts.'
        );
      }
    }

    // TypeScript global type registration
    declare global {
      interface HTMLElementTagNameMap {
        'lui-date-picker': DatePicker;
      }
    }
    ```

    This provides:
    - DatePicker class export for programmatic use
    - Parser utility exports (parseDateInput, formatDateForDisplay, getPlaceholderText) for consumer reuse
    - Safe custom element registration with DEV-only collision warning
    - Global HTMLElementTagNameMap for TypeScript querySelector typing
  </action>
  <verify>
    - `grep "customElements.define" packages/date-picker/src/index.ts` shows registration
    - `grep "lui-date-picker" packages/date-picker/src/index.ts` shows element name
    - `grep "parseDateInput" packages/date-picker/src/index.ts` shows utility export
    - `pnpm --filter @lit-ui/date-picker build` succeeds
  </verify>
  <done>index.ts registers lui-date-picker custom element and exports DatePicker class and parser utilities</done>
</task>

<task type="auto">
  <name>Task 2: Create React JSX type declarations</name>
  <files>packages/date-picker/src/jsx.d.ts</files>
  <action>
    Create `packages/date-picker/src/jsx.d.ts` following the @lit-ui/calendar JSX types pattern:

    ```typescript
    import type { DatePicker } from './date-picker.js';

    type DatePickerProps = {
      // String attributes
      value?: string;
      name?: string;
      locale?: string;
      placeholder?: string;
      'helper-text'?: string;
      'min-date'?: string;
      'max-date'?: string;
      label?: string;
      error?: string;

      // Boolean attributes
      required?: boolean;
      disabled?: boolean;

      // Event handlers (custom events from dispatchCustomEvent)
      onChange?: (e: CustomEvent<{ date: Date | null; isoString: string }>) => void;

      // Standard HTML attributes
      class?: string;
      id?: string;
      style?: string | Record<string, string>;
      slot?: string;

      // React ref
      ref?: React.Ref<DatePicker>;
    };

    declare global {
      namespace JSX {
        interface IntrinsicElements {
          'lui-date-picker': DatePickerProps;
        }
      }
    }
    ```

    Include all public properties from the DatePicker component as props. The `onChange` handler matches the `change` event dispatched by the component with `{ date, isoString }` detail.
  </action>
  <verify>
    - `grep "lui-date-picker" packages/date-picker/src/jsx.d.ts` shows JSX element
    - `grep "onChange" packages/date-picker/src/jsx.d.ts` shows event handler type
    - `grep "min-date" packages/date-picker/src/jsx.d.ts` shows attribute props
    - `pnpm --filter @lit-ui/date-picker build` succeeds
  </verify>
  <done>React JSX types declare lui-date-picker with all props and onChange event handler</done>
</task>

</tasks>

<verification>
- `pnpm --filter @lit-ui/date-picker build` completes without errors
- index.ts exports: DatePicker, parseDateInput, formatDateForDisplay, getPlaceholderText
- lui-date-picker custom element registered in index.ts
- jsx.d.ts declares lui-date-picker in JSX.IntrinsicElements
- Full build: `pnpm build` succeeds across all workspace packages
</verification>

<success_criteria>
1. lui-date-picker custom element registered via customElements.define
2. DatePicker class exported for programmatic use
3. Parser utilities exported for consumer reuse
4. React JSX types include all props and onChange event
5. HTMLElementTagNameMap includes lui-date-picker
6. Package builds without errors
7. Full workspace builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/44-date-picker-core/44-05-SUMMARY.md`
</output>

---
phase: 40-radio-radiogroup
plan: 02
type: execute
wave: 2
depends_on: ["40-01"]
files_modified:
  - packages/radio/src/radio.ts
  - packages/radio/src/index.ts
  - packages/radio/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "lui-radio renders a circular radio button with label text"
    - "Clicking a radio dispatches ui-radio-change event (does NOT toggle itself)"
    - "Space key on focused radio dispatches ui-radio-change event"
    - "Radio shows animated dot scale transition when checked property is set"
    - "Radio supports sm/md/lg sizes via CSS tokens"
    - "Radio has disabled state with pointer-events: none and opacity"
    - "Radio has role='radio' with aria-checked reflecting checked state"
    - "Package builds successfully with vite build"
  artifacts:
    - path: "packages/radio/src/radio.ts"
      provides: "Radio web component class (NOT form-associated)"
      exports: ["Radio", "RadioSize"]
    - path: "packages/radio/src/index.ts"
      provides: "Safe element registration for lui-radio"
      contains: "customElements.define"
    - path: "packages/radio/src/jsx.d.ts"
      provides: "JSX type declarations for React, Vue, Svelte"
      contains: "lui-radio"
  key_links:
    - from: "packages/radio/src/radio.ts"
      to: "@lit-ui/core"
      via: "TailwindElement base class and dispatchCustomEvent"
      pattern: "import.*TailwindElement.*@lit-ui/core"
    - from: "packages/radio/src/radio.ts"
      to: "packages/core/src/styles/tailwind.css"
      via: "--ui-radio-* CSS custom properties consumed in styles"
      pattern: "--ui-radio-"
    - from: "packages/radio/src/index.ts"
      to: "packages/radio/src/radio.ts"
      via: "Import and register lui-radio element"
      pattern: "customElements.define.*lui-radio.*Radio"
---

<objective>
Implement the lui-radio web component -- a presentational radio button element that reports selection to its parent RadioGroup via events.

Purpose: Individual radio buttons must exist before RadioGroup can discover and manage them. Radio is NOT form-associated (the group owns form participation).
Output: Working lui-radio component with animated dot, keyboard support, ARIA, and SSR compatibility.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/40-radio-radiogroup/40-RESEARCH.md
@.planning/phases/40-radio-radiogroup/40-01-SUMMARY.md

Reference implementation (adapt from):
@packages/checkbox/src/checkbox.ts
@packages/checkbox/src/index.ts
@packages/checkbox/src/jsx.d.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement lui-radio component</name>
  <files>
    packages/radio/src/radio.ts
  </files>
  <action>
Create `packages/radio/src/radio.ts` adapting from `packages/checkbox/src/checkbox.ts`. This is a presentational child component -- it does NOT participate in forms.

**Class structure:**
```typescript
import { html, css, nothing, type PropertyValues } from 'lit';
import { property } from 'lit/decorators.js';
import { TailwindElement, tailwindBaseStyles } from '@lit-ui/core';
import { dispatchCustomEvent } from '@lit-ui/core';

export type RadioSize = 'sm' | 'md' | 'lg';

export class Radio extends TailwindElement {
  // NO static formAssociated (group owns form participation)
  // NO internals / attachInternals()
```

**Properties (all reactive):**
- `value: string = ''` — The value this radio represents
- `checked: boolean = false` — Whether selected (reflect: true)
- `disabled: boolean = false` — Whether disabled (reflect: true)
- `label: string = ''` — Label text
- `size: RadioSize = 'md'` — Size variant

**Private members:**
- `radioId` — Unique ID for label association: `lui-radio-${Math.random().toString(36).substr(2, 9)}`

**Key behaviors (DIFFERENT from Checkbox):**
1. **Click handler on wrapper div** — Calls `handleClick()` which dispatches `ui-radio-change` event (does NOT toggle `checked` itself -- the group does that)
2. **Space key handler** — `e.preventDefault()` then calls `handleClick()`. Only Space key, NOT Enter (W3C APG radio spec).
3. **NO toggle logic** — Radio does NOT change its own `checked` state. It dispatches `ui-radio-change` with `{ value: this.value }`. The group receives this and sets `checked` on the appropriate radio.
4. **tabindex defaults to -1** — The inner `div[role="radio"]` has `tabindex="-1"` by default. The RadioGroup sets `tabIndex` on the lui-radio HOST element for roving tabindex.

**Event dispatch:**
```typescript
private handleClick(): void {
  if (this.disabled) return;
  dispatchCustomEvent(this, 'ui-radio-change', {
    value: this.value,
  });
}
```

**CSS styles (use --ui-radio-* tokens from Plan 01):**
- `:host { display: inline-block; }`
- `:host([disabled]) { pointer-events: none; }`
- `.radio-wrapper` — Flex row with gap, cursor pointer
- `.radio-circle` — Circular border (border-radius: 50%), flex-shrink: 0, transitions on border-color
- `.radio-circle[aria-checked='true']` — border-color changes to `--ui-radio-border-checked`
- `.radio-dot` — Inner circle with `transform: scale(0)`, transition on transform
- `.radio-circle[aria-checked='true'] .radio-dot` — `transform: scale(1)` (dot appears)
- Size classes: `.circle-sm/md/lg` using `--ui-radio-size-sm/md/lg` for width/height
- Dot size classes: `.dot-sm/md/lg` using `--ui-radio-dot-size-sm/md/lg` for width/height
- `.radio-box:focus-visible` — `box-shadow: 0 0 0 2px var(--ui-radio-ring)`
- `.radio-circle[aria-disabled='true']` — opacity: 0.5, cursor: not-allowed
- Label classes: `.label-sm/md/lg` using `--ui-radio-font-size-sm/md/lg`
- `@media (prefers-reduced-motion: reduce)` — transition-duration: 0ms

**Render template:**
```html
<div class="radio-wrapper" @click=${this.handleClick}>
  <div
    role="radio"
    aria-checked=${this.checked ? 'true' : 'false'}
    aria-disabled=${this.disabled ? 'true' : nothing}
    aria-labelledby="${this.radioId}-label"
    tabindex="-1"
    class="radio-circle circle-${this.size}"
    @keydown=${this.handleKeyDown}
  >
    <span class="radio-dot dot-${this.size}"></span>
  </div>
  ${label via property or slot (same pattern as checkbox)}
</div>
```

**JSDoc:** Add full JSDoc comment block at the top matching checkbox.ts style, documenting features, slots, and examples.

**IMPORTANT differences from checkbox.ts:**
- NO `static formAssociated = true`
- NO `internals` / `attachInternals()` / `formResetCallback` / `formDisabledCallback`
- NO `indeterminate` property
- NO `required` property (group handles validation)
- NO `name` property (group handles form submission)
- NO `touched` / `showError` state (group handles error display)
- NO `validate()` method
- NO `updateFormValue()` method
- NO `updated()` lifecycle (no form sync needed)
- NO SVG — uses CSS dot with scale transition
- NO error text in template
- Dispatches `ui-radio-change` (internal), NOT `ui-change` (consumer-facing)
- Default tabindex is -1 on inner element (group manages host tabindex)
  </action>
  <verify>
- File exists: `ls packages/radio/src/radio.ts`
- Has Radio class export: `grep 'export class Radio' packages/radio/src/radio.ts`
- NOT form-associated: `! grep 'formAssociated' packages/radio/src/radio.ts`
- Dispatches correct event: `grep 'ui-radio-change' packages/radio/src/radio.ts`
- Has role="radio": `grep "role=\"radio\"" packages/radio/src/radio.ts`
  </verify>
  <done>Radio component exists with click/Space handlers dispatching ui-radio-change, animated dot via CSS scale transition, role="radio" with aria-checked, three sizes, disabled state, and NO form association.</done>
</task>

<task type="auto">
  <name>Task 2: Create index.ts registration and jsx.d.ts type declarations</name>
  <files>
    packages/radio/src/index.ts
    packages/radio/src/jsx.d.ts
  </files>
  <action>
**index.ts** — Copy from `packages/checkbox/src/index.ts` and adapt:

1. Register ONLY `lui-radio` for now (RadioGroup comes in Plan 03 which will update index.ts)
2. Export `Radio` class and `RadioSize` type
3. Re-export `TailwindElement` and `isServer` from `@lit-ui/core`
4. Safe registration: check `customElements.get('lui-radio')` before define
5. Dev warning on collision
6. `HTMLElementTagNameMap` global type for `lui-radio` only
7. `/// <reference path="./jsx.d.ts" />` at top

```typescript
// @lit-ui/radio - Radio and RadioGroup components with SSR support
/// <reference path="./jsx.d.ts" />
import { isServer } from 'lit';

export { Radio } from './radio.js';
export type { RadioSize } from './radio.js';
export { TailwindElement, isServer } from '@lit-ui/core';

import { Radio } from './radio.js';

if (typeof customElements !== 'undefined') {
  if (!customElements.get('lui-radio')) {
    customElements.define('lui-radio', Radio);
  } else if (!isServer && import.meta.env?.DEV) {
    console.warn('[lui-radio] Custom element already registered...');
  }
}

declare global {
  interface HTMLElementTagNameMap {
    'lui-radio': Radio;
  }
}
```

**jsx.d.ts** — Copy from `packages/checkbox/src/jsx.d.ts` and adapt:

1. Define `LuiRadioAttributes` interface with: `checked?`, `disabled?`, `value?`, `label?`, `size?`
2. React JSX: `'lui-radio': React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement> & LuiRadioAttributes, HTMLElement>`
3. Vue: `'lui-radio': import('vue').DefineComponent<LuiRadioAttributes>`
4. Svelte: `'lui-radio': LuiRadioAttributes & { 'on:ui-radio-change'?: (e: CustomEvent) => void }`
5. Do NOT include lui-radio-group yet (Plan 03 will update this file)

After creating both files, build the package:
```bash
cd packages/radio && npx vite build
```

Verify the build succeeds and produces dist/index.js and dist/index.d.ts.
  </action>
  <verify>
- Files exist: `ls packages/radio/src/index.ts packages/radio/src/jsx.d.ts`
- Registration: `grep "customElements.define.*lui-radio" packages/radio/src/index.ts`
- Build succeeds: `cd packages/radio && npx vite build`
- Output exists: `ls packages/radio/dist/index.js packages/radio/dist/index.d.ts`
  </verify>
  <done>lui-radio is safely registered via index.ts, JSX types support React/Vue/Svelte, and `npx vite build` produces dist/index.js + dist/index.d.ts without errors.</done>
</task>

</tasks>

<verification>
1. `packages/radio/src/radio.ts` exports Radio class (NOT form-associated)
2. `packages/radio/src/index.ts` registers lui-radio element
3. `packages/radio/src/jsx.d.ts` has React, Vue, Svelte type declarations
4. `cd packages/radio && npx vite build` succeeds
5. `ls packages/radio/dist/index.js packages/radio/dist/index.d.ts` — outputs exist
</verification>

<success_criteria>
- Radio component dispatches ui-radio-change on click/Space (does NOT self-toggle)
- Animated dot uses CSS transform: scale(0/1) transition
- role="radio" with aria-checked, aria-disabled, aria-labelledby
- Three sizes (sm/md/lg) using --ui-radio-* tokens
- Package builds successfully
</success_criteria>

<output>
After completion, create `.planning/phases/40-radio-radiogroup/40-02-SUMMARY.md`
</output>

---
phase: 20-documentation
plan: 02
type: execute
wave: 2
depends_on: ["20-01"]
files_modified:
  - apps/docs/src/pages/SSRGuide.tsx
  - apps/docs/src/App.tsx
autonomous: true

must_haves:
  truths:
    - "User finds Next.js SSR setup steps"
    - "User finds Astro SSR setup steps"
    - "User understands hydration import must be first"
    - "User finds FOUC prevention CSS to include"
  artifacts:
    - path: "apps/docs/src/pages/SSRGuide.tsx"
      provides: "SSR setup guide for Next.js and Astro"
      min_lines: 150
  key_links:
    - from: "apps/docs/src/App.tsx"
      to: "SSRGuide component"
      via: "Route element"
      pattern: "path=\"guides/ssr\".*SSRGuide"
---

<objective>
Create SSR setup documentation with framework-specific instructions for Next.js and Astro.

Purpose: Fulfill DOC-02 (SSR setup guide with hydration instructions) by creating a focused "how-to" guide that shows developers exactly what imports and setup steps are needed for SSR in each supported framework.

Output: SSRGuide.tsx page with Next.js and Astro sections, updated App.tsx routing to replace Placeholder.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-documentation/20-CONTEXT.md
@.planning/phases/20-documentation/20-RESEARCH.md
@apps/docs/src/pages/GettingStarted.tsx
@apps/docs/src/components/CodeBlock.tsx
@apps/docs/src/components/PrevNextNav.tsx
@examples/nextjs/app/components/LitDemo.tsx
@examples/astro/src/pages/index.astro
@packages/core/src/fouc.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SSR Guide page</name>
  <files>apps/docs/src/pages/SSRGuide.tsx</files>
  <action>
Create SSRGuide.tsx following the pattern from GettingStarted.tsx (header with title/description, numbered sections with icons, PrevNextNav at bottom).

Page structure:
1. **Header**: "SSR Setup" title, description: "Use Lit UI components with server-side rendering in Next.js and Astro"

2. **Section 1: Hydration Import Order**
   - Brief explanation: "The hydration import must be the first import before any Lit components"
   - Code example:
```typescript
const hydrationImport = `// MUST be first import
import '@lit-ui/ssr/hydration';

// Then import components
import '@lit-ui/button';
import '@lit-ui/dialog';`;
```
   - Note: "This patches LitElement to properly hydrate server-rendered content"

3. **Section 2: Next.js Setup**
   - Step 1: Install packages - `npm install @lit-ui/core @lit-ui/button @lit-ui/ssr`
   - Step 2: Create client component with 'use client' directive
   - Code example (minimal, from examples/nextjs):
```typescript
const nextjsExample = `'use client';

// MUST be first import
import '@lit-ui/ssr/hydration';

// Then import components
import '@lit-ui/button';

export default function MyComponent() {
  return <lui-button variant="primary">Click me</lui-button>;
}`;
```
   - Note about 'use client': "React Server Components can't serialize Shadow DOM templates"

4. **Section 3: Astro Setup**
   - Step 1: Install packages and add integration - `npx astro add @astrojs/lit`
   - Step 2: Import in frontmatter for SSR, script for hydration
   - Code example (minimal, from examples/astro):
```typescript
const astroExample = `---
// Frontmatter: register for SSR
import '@lit-ui/button';
---

<lui-button variant="primary">Click me</lui-button>

<script>
  // Hydration (must be first)
  import '@lit-ui/ssr/hydration';
  import '@lit-ui/button';
</script>`;
```

5. **Section 4: FOUC Prevention**
   - Brief explanation: "Hide components until defined to prevent flash of unstyled content"
   - Code example:
```typescript
const foucCSS = `/* Add to global styles */
lui-button:not(:defined),
lui-dialog:not(:defined) {
  opacity: 0;
  visibility: hidden;
}`;
```
   - Note: "Or import @lit-ui/core/fouc.css"

6. **PrevNextNav**: prev=Installation, next=Migration

Use existing CodeBlock component. Follow exact Tailwind classes from GettingStarted.tsx. Keep content focused on "how" not "why" per CONTEXT.md.
  </action>
  <verify>File exists at apps/docs/src/pages/SSRGuide.tsx and has no TypeScript errors</verify>
  <done>SSRGuide.tsx page renders with Next.js, Astro, and FOUC prevention sections</done>
</task>

<task type="auto">
  <name>Task 2: Update routing for SSR Guide</name>
  <files>apps/docs/src/App.tsx</files>
  <action>
Update App.tsx to use SSRGuide component instead of Placeholder:

1. Import SSRGuide: `import { SSRGuide } from './pages/SSRGuide'`
2. Replace the SSR route from Placeholder to SSRGuide:
   - Change: `<Route path="guides/ssr" element={<Placeholder />} />`
   - To: `<Route path="guides/ssr" element={<SSRGuide />} />`

Note: Plan 20-01 already added the navigation entry in nav.ts and the placeholder route. This task just swaps in the real component.
  </action>
  <verify>Run `pnpm --filter docs build` - no errors, navigate to /guides/ssr shows SSRGuide content</verify>
  <done>Route /guides/ssr renders SSRGuide component with framework-specific setup instructions</done>
</task>

</tasks>

<verification>
1. `pnpm --filter docs dev` - docs site runs without errors
2. Navigate to /guides/ssr - page renders with all four sections
3. Code blocks render correctly with syntax highlighting
4. Next.js section shows 'use client' example
5. Astro section shows frontmatter + script pattern
6. FOUC section shows CSS snippet
7. Prev/Next navigation works (Installation <- SSR -> Migration)
</verification>

<success_criteria>
- SSRGuide page exists with hydration, Next.js, Astro, and FOUC sections
- App.tsx routes /guides/ssr to SSRGuide component
- Content is "how-to" focused (setup steps, not theory)
- Code examples are minimal showing only relevant lines
- No TypeScript errors, docs build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/20-documentation/20-02-SUMMARY.md`
</output>

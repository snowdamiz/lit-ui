---
phase: 63-filtering-pagination
plan: 02
type: execute
wave: 2
depends_on: ["63-01"]
files_modified:
  - packages/data-table/src/filters/text-filter.ts
  - packages/data-table/src/filters/number-filter.ts
  - packages/data-table/src/filters/date-filter.ts
  - packages/data-table/src/filters/select-filter.ts
  - packages/data-table/src/filters/global-search.ts
  - packages/data-table/src/filters/index.ts
  - packages/data-table/src/index.ts
autonomous: true

must_haves:
  truths:
    - "Text filter provides case-insensitive contains filtering with debounced input"
    - "Number filter provides min/max range filtering"
    - "Date filter provides date range filtering with native date inputs"
    - "Select filter provides multi-select filtering from predefined options"
    - "Global search filters across all filterable columns simultaneously"
    - "All filter components emit filter-change events with columnId and value"
  artifacts:
    - path: "packages/data-table/src/filters/text-filter.ts"
      provides: "lui-column-text-filter component"
      contains: "class ColumnTextFilter"
    - path: "packages/data-table/src/filters/number-filter.ts"
      provides: "lui-column-number-filter component"
      contains: "class ColumnNumberFilter"
    - path: "packages/data-table/src/filters/date-filter.ts"
      provides: "lui-column-date-filter component"
      contains: "class ColumnDateFilter"
    - path: "packages/data-table/src/filters/select-filter.ts"
      provides: "lui-column-select-filter component"
      contains: "class ColumnSelectFilter"
    - path: "packages/data-table/src/filters/global-search.ts"
      provides: "lui-global-search component"
      contains: "class GlobalSearch"
    - path: "packages/data-table/src/filters/index.ts"
      provides: "Filter component re-exports"
      contains: "export"
  key_links:
    - from: "packages/data-table/src/filters/*.ts"
      to: "filter-change event"
      via: "CustomEvent dispatch"
      pattern: "filter-change"
    - from: "packages/data-table/src/filters/text-filter.ts"
      to: "lui-input"
      via: "component usage"
      pattern: "lui-input"
---

<objective>
Create type-specific filter components for the data table: text (contains), number (range), date (range), select (multi-select), and global search.

Purpose: Provide ready-to-use filter UI components that integrate with the DataTable's filtering infrastructure from Plan 01. Each component handles its specific data type with appropriate UX patterns.

Output: Five filter components plus re-export index, all emitting standardized filter-change events that DataTable can consume.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/63-filtering-pagination/63-RESEARCH.md
@.planning/phases/63-filtering-pagination/63-01-SUMMARY.md

@packages/data-table/src/data-table.ts
@packages/data-table/src/types.ts
@packages/input/src/input.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create text and number filter components</name>
  <files>
    packages/data-table/src/filters/text-filter.ts
    packages/data-table/src/filters/number-filter.ts
  </files>
  <action>
Create filters/ directory and text-filter.ts:

```typescript
// lui-column-text-filter - Text/contains filter with debounce
import { html, css, LitElement } from 'lit';
import { customElement, property } from 'lit/decorators.js';
import { TailwindElement, tailwindBaseStyles } from '@lit-ui/core';

@customElement('lui-column-text-filter')
export class ColumnTextFilter extends TailwindElement {
  @property({ type: String })
  value = '';

  @property({ type: String })
  placeholder = 'Filter...';

  @property({ type: String, attribute: 'column-id' })
  columnId = '';

  private debounceTimeout?: ReturnType<typeof setTimeout>;

  static override styles = [
    ...tailwindBaseStyles,
    css`
      :host { display: block; min-width: 150px; }
      lui-input { width: 100%; }
    `
  ];

  private handleInput(e: Event): void {
    const target = e.target as HTMLInputElement;
    this.value = target.value;

    clearTimeout(this.debounceTimeout);
    this.debounceTimeout = setTimeout(() => {
      this.dispatchEvent(new CustomEvent('filter-change', {
        detail: {
          columnId: this.columnId,
          value: this.value || undefined // undefined clears filter
        },
        bubbles: true,
        composed: true,
      }));
    }, 300);
  }

  override disconnectedCallback(): void {
    super.disconnectedCallback();
    clearTimeout(this.debounceTimeout);
  }

  override render() {
    return html`
      <lui-input
        type="search"
        size="sm"
        .value=${this.value}
        placeholder=${this.placeholder}
        clearable
        @input=${this.handleInput}
      ></lui-input>
    `;
  }
}
```

Create number-filter.ts:

```typescript
// lui-column-number-filter - Numeric range filter (min/max)
import { html, css, LitElement } from 'lit';
import { customElement, property } from 'lit/decorators.js';
import { TailwindElement, tailwindBaseStyles } from '@lit-ui/core';

@customElement('lui-column-number-filter')
export class ColumnNumberFilter extends TailwindElement {
  @property({ type: Array })
  value: [number | null, number | null] = [null, null];

  @property({ type: String, attribute: 'column-id' })
  columnId = '';

  @property({ type: String, attribute: 'min-placeholder' })
  minPlaceholder = 'Min';

  @property({ type: String, attribute: 'max-placeholder' })
  maxPlaceholder = 'Max';

  static override styles = [
    ...tailwindBaseStyles,
    css`
      :host { display: block; min-width: 180px; }
      .number-filter {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      lui-input { flex: 1; }
      .separator {
        color: var(--color-muted-foreground, #71717a);
        font-size: 0.875rem;
      }
    `
  ];

  private handleMinChange(e: Event): void {
    const input = e.target as HTMLInputElement;
    const min = input.value ? parseFloat(input.value) : null;
    this.emitChange([min, this.value[1]]);
  }

  private handleMaxChange(e: Event): void {
    const input = e.target as HTMLInputElement;
    const max = input.value ? parseFloat(input.value) : null;
    this.emitChange([this.value[0], max]);
  }

  private emitChange(value: [number | null, number | null]): void {
    // Only emit if at least one value is set, otherwise clear filter
    const filterValue = (value[0] === null && value[1] === null) ? undefined : value;
    this.dispatchEvent(new CustomEvent('filter-change', {
      detail: { columnId: this.columnId, value: filterValue },
      bubbles: true,
      composed: true,
    }));
  }

  override render() {
    return html`
      <div class="number-filter">
        <lui-input
          type="number"
          size="sm"
          placeholder=${this.minPlaceholder}
          .value=${this.value[0]?.toString() ?? ''}
          @change=${this.handleMinChange}
        ></lui-input>
        <span class="separator">-</span>
        <lui-input
          type="number"
          size="sm"
          placeholder=${this.maxPlaceholder}
          .value=${this.value[1]?.toString() ?? ''}
          @change=${this.handleMaxChange}
        ></lui-input>
      </div>
    `;
  }
}
```

Add JSX declarations for both components at end of files.
  </action>
  <verify>
Run `pnpm build --filter @lit-ui/data-table` - should succeed.
Verify both components are defined and extend TailwindElement.
  </verify>
  <done>
Text filter provides debounced case-insensitive filtering (FILT-02).
Number filter provides min/max range filtering (FILT-03).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create date and select filter components</name>
  <files>
    packages/data-table/src/filters/date-filter.ts
    packages/data-table/src/filters/select-filter.ts
  </files>
  <action>
Create date-filter.ts:

```typescript
// lui-column-date-filter - Date range filter using native date inputs
import { html, css } from 'lit';
import { customElement, property } from 'lit/decorators.js';
import { TailwindElement, tailwindBaseStyles } from '@lit-ui/core';

@customElement('lui-column-date-filter')
export class ColumnDateFilter extends TailwindElement {
  @property({ type: Array })
  value: [string | null, string | null] = [null, null]; // ISO date strings

  @property({ type: String, attribute: 'column-id' })
  columnId = '';

  @property({ type: String, attribute: 'start-placeholder' })
  startPlaceholder = 'Start date';

  @property({ type: String, attribute: 'end-placeholder' })
  endPlaceholder = 'End date';

  static override styles = [
    ...tailwindBaseStyles,
    css`
      :host { display: block; min-width: 200px; }
      .date-filter {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .date-row {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      label {
        font-size: 0.75rem;
        color: var(--color-muted-foreground, #71717a);
        min-width: 40px;
      }
      input[type="date"] {
        flex: 1;
        padding: 0.375rem 0.5rem;
        font-size: 0.875rem;
        border: 1px solid var(--color-border, #e4e4e7);
        border-radius: var(--ui-radius-sm, 0.25rem);
        background: var(--color-background, #ffffff);
        color: var(--color-foreground, #09090b);
      }
      input[type="date"]:focus {
        outline: 2px solid var(--color-primary, #3b82f6);
        outline-offset: -1px;
      }
      :host-context(.dark) input[type="date"] {
        background: #09090b;
        border-color: #3f3f46;
        color: #fafafa;
      }
    `
  ];

  private handleStartChange(e: Event): void {
    const input = e.target as HTMLInputElement;
    const start = input.value || null;
    this.emitChange([start, this.value[1]]);
  }

  private handleEndChange(e: Event): void {
    const input = e.target as HTMLInputElement;
    const end = input.value || null;
    this.emitChange([this.value[0], end]);
  }

  private emitChange(value: [string | null, string | null]): void {
    const filterValue = (value[0] === null && value[1] === null) ? undefined : value;
    this.dispatchEvent(new CustomEvent('filter-change', {
      detail: { columnId: this.columnId, value: filterValue },
      bubbles: true,
      composed: true,
    }));
  }

  override render() {
    return html`
      <div class="date-filter">
        <div class="date-row">
          <label>From</label>
          <input
            type="date"
            .value=${this.value[0] ?? ''}
            @change=${this.handleStartChange}
            aria-label=${this.startPlaceholder}
          />
        </div>
        <div class="date-row">
          <label>To</label>
          <input
            type="date"
            .value=${this.value[1] ?? ''}
            @change=${this.handleEndChange}
            aria-label=${this.endPlaceholder}
          />
        </div>
      </div>
    `;
  }
}
```

Create select-filter.ts:

```typescript
// lui-column-select-filter - Multi-select enum filter
import { html, css } from 'lit';
import { customElement, property } from 'lit/decorators.js';
import { TailwindElement, tailwindBaseStyles } from '@lit-ui/core';

export interface SelectFilterOption {
  value: string;
  label: string;
}

@customElement('lui-column-select-filter')
export class ColumnSelectFilter extends TailwindElement {
  @property({ type: Array })
  value: string[] = [];

  @property({ type: Array })
  options: SelectFilterOption[] = [];

  @property({ type: String, attribute: 'column-id' })
  columnId = '';

  @property({ type: String })
  placeholder = 'Select...';

  static override styles = [
    ...tailwindBaseStyles,
    css`
      :host { display: block; min-width: 180px; }
      lui-select { width: 100%; }
    `
  ];

  private handleChange(e: CustomEvent): void {
    const selectedValues = e.detail.value as string[];
    this.dispatchEvent(new CustomEvent('filter-change', {
      detail: {
        columnId: this.columnId,
        value: selectedValues.length > 0 ? selectedValues : undefined,
      },
      bubbles: true,
      composed: true,
    }));
  }

  override render() {
    return html`
      <lui-select
        multiple
        size="sm"
        placeholder=${this.placeholder}
        .value=${this.value}
        @ui-change=${this.handleChange}
      >
        ${this.options.map(opt => html`
          <lui-option value=${opt.value}>${opt.label}</lui-option>
        `)}
      </lui-select>
    `;
  }
}
```

Add JSX declarations for both components.
  </action>
  <verify>
Run `pnpm build --filter @lit-ui/data-table` - should succeed.
  </verify>
  <done>
Date filter provides date range filtering (FILT-04).
Select filter provides multi-select filtering from options (FILT-05).
  </done>
</task>

<task type="auto">
  <name>Task 3: Create global search and export index</name>
  <files>
    packages/data-table/src/filters/global-search.ts
    packages/data-table/src/filters/index.ts
    packages/data-table/src/index.ts
  </files>
  <action>
Create global-search.ts:

```typescript
// lui-global-search - Global filter input across all columns
import { html, css } from 'lit';
import { customElement, property } from 'lit/decorators.js';
import { TailwindElement, tailwindBaseStyles } from '@lit-ui/core';

@customElement('lui-global-search')
export class GlobalSearch extends TailwindElement {
  @property({ type: String })
  value = '';

  @property({ type: String })
  placeholder = 'Search all columns...';

  private debounceTimeout?: ReturnType<typeof setTimeout>;

  static override styles = [
    ...tailwindBaseStyles,
    css`
      :host { display: block; }
      lui-input { width: 100%; }
    `
  ];

  private handleInput(e: Event): void {
    const target = e.target as HTMLInputElement;
    this.value = target.value;

    clearTimeout(this.debounceTimeout);
    this.debounceTimeout = setTimeout(() => {
      this.dispatchEvent(new CustomEvent('global-filter-change', {
        detail: { value: this.value || '' },
        bubbles: true,
        composed: true,
      }));
    }, 300);
  }

  override disconnectedCallback(): void {
    super.disconnectedCallback();
    clearTimeout(this.debounceTimeout);
  }

  override render() {
    return html`
      <lui-input
        type="search"
        size="sm"
        .value=${this.value}
        placeholder=${this.placeholder}
        clearable
        @input=${this.handleInput}
      >
        <span slot="prefix">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
        </span>
      </lui-input>
    `;
  }
}
```

Create filters/index.ts:

```typescript
// Filter component exports
export { ColumnTextFilter } from './text-filter.js';
export { ColumnNumberFilter } from './number-filter.js';
export { ColumnDateFilter } from './date-filter.js';
export { ColumnSelectFilter, type SelectFilterOption } from './select-filter.js';
export { GlobalSearch } from './global-search.js';
```

Update main index.ts to add:

```typescript
// Filter components
export * from './filters/index.js';
```

Add JSX declaration for global-search.
  </action>
  <verify>
Run `pnpm build --filter @lit-ui/data-table` - should succeed.
Check dist/index.d.ts includes filter component exports.
  </verify>
  <done>
Global search filters across all columns (FILT-06).
All filter components exported from package (FILT-01 complete).
  </done>
</task>

</tasks>

<verification>
1. `pnpm build --filter @lit-ui/data-table` succeeds
2. filters/ directory contains 5 filter files + index.ts
3. All filter components emit filter-change or global-filter-change events
4. All filter components are exported from main index.ts
5. lui-input and lui-select dependencies used correctly
</verification>

<success_criteria>
- Text filter: debounced input, type="search", clearable (FILT-02)
- Number filter: min/max range inputs (FILT-03)
- Date filter: native date inputs for range (FILT-04)
- Select filter: multi-select from options (FILT-05)
- Global search: searches all columns with debounce (FILT-06)
- All components emit standardized events for DataTable integration (FILT-01)
</success_criteria>

<output>
After completion, create `.planning/phases/63-filtering-pagination/63-02-SUMMARY.md`
</output>

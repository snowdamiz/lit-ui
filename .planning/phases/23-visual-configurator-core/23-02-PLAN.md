---
phase: 23-visual-configurator-core
plan: 02
type: execute
wave: 2
depends_on: ["23-01"]
files_modified:
  - apps/docs/src/components/configurator/ColorPickerGroup.tsx
  - apps/docs/src/components/configurator/ColorSection.tsx
  - apps/docs/src/components/configurator/TailwindSwatches.tsx
  - apps/docs/src/components/configurator/RadiusSelector.tsx
  - apps/docs/src/components/configurator/ModeToggle.tsx
autonomous: true

must_haves:
  truths:
    - "User can pick a color using saturation square and hue slider"
    - "User can type a hex value directly and see picker update"
    - "User can click a Tailwind swatch to quickly select a color"
    - "User can toggle between light and dark mode editing"
    - "User can select border radius (sm/md/lg)"
    - "Overridden dark colors show reset icon"
  artifacts:
    - path: "apps/docs/src/components/configurator/ColorPickerGroup.tsx"
      provides: "Individual color picker with saturation, hue, hex input"
      min_lines: 60
    - path: "apps/docs/src/components/configurator/ColorSection.tsx"
      provides: "Groups related colors with labels"
      min_lines: 20
    - path: "apps/docs/src/components/configurator/TailwindSwatches.tsx"
      provides: "Quick-select Tailwind color palette"
      min_lines: 40
    - path: "apps/docs/src/components/configurator/RadiusSelector.tsx"
      provides: "Border radius selection"
      min_lines: 20
    - path: "apps/docs/src/components/configurator/ModeToggle.tsx"
      provides: "Light/dark mode switch"
      min_lines: 15
  key_links:
    - from: "apps/docs/src/components/configurator/ColorPickerGroup.tsx"
      to: "apps/docs/src/contexts/ConfiguratorContext.tsx"
      via: "useConfigurator hook"
      pattern: "useConfigurator"
    - from: "apps/docs/src/components/configurator/ColorPickerGroup.tsx"
      to: "apps/docs/src/utils/color-utils.ts"
      via: "conversion function imports"
      pattern: "(oklchToHsv|hsvToOklch|oklchToHex|hexToOklch)"
---

<objective>
Build the color picker UI components for the visual configurator sidebar.

Purpose: Create the interactive controls that let users customize theme colors. Each component connects to ConfiguratorContext for state management and uses the color utilities for format conversion.

Output: ColorPickerGroup (saturation + hue + hex input), ColorSection (grouping), TailwindSwatches (quick-select), RadiusSelector (sm/md/lg), ModeToggle (light/dark switch).
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/23-visual-configurator-core/23-CONTEXT.md
@.planning/phases/23-visual-configurator-core/23-RESEARCH.md
@.planning/phases/23-visual-configurator-core/23-01-SUMMARY.md
@apps/docs/src/utils/color-utils.ts
@apps/docs/src/contexts/ConfiguratorContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ColorPickerGroup component</name>
  <files>
    apps/docs/src/components/configurator/ColorPickerGroup.tsx
  </files>
  <action>
Create `apps/docs/src/components/configurator/ColorPickerGroup.tsx`:

1. Props interface:
   ```typescript
   interface ColorPickerGroupProps {
     colorKey: 'primary' | 'secondary' | 'destructive' | 'background' | 'foreground' | 'muted';
     label: string;
   }
   ```

2. Use useConfigurator hook to get:
   - activeMode, lightColors, darkColors, darkOverrides, lightOverrides
   - setLightColor, setDarkColor, resetDarkColor, resetLightColor

3. Derive current OKLCH value based on activeMode:
   ```typescript
   const oklchValue = activeMode === 'light' ? lightColors[colorKey] : darkColors[colorKey];
   ```

4. Convert to formats needed by picker using useMemo:
   - hsva: `{ ...oklchToHsv(oklchValue), a: 1 }` (Saturation component expects alpha)
   - hexValue: `oklchToHex(oklchValue)`

5. Determine if color is overridden:
   ```typescript
   const isOverridden = activeMode === 'dark'
     ? darkOverrides.has(colorKey)
     : lightOverrides.has(colorKey);
   ```

6. Handle color change from Saturation/Hue:
   ```typescript
   const handleColorChange = useCallback((newHsva: { h: number; s: number; v: number; a: number }) => {
     const oklch = hsvToOklch({ h: newHsva.h, s: newHsva.s, v: newHsva.v });
     if (activeMode === 'light') {
       setLightColor(colorKey, oklch);
     } else {
       setDarkColor(colorKey, oklch);
     }
   }, [activeMode, colorKey, setLightColor, setDarkColor]);
   ```

7. Handle hex input change (on blur for validation):
   ```typescript
   const handleHexBlur = useCallback((e: React.FocusEvent<HTMLInputElement>) => {
     const hex = e.target.value;
     if (isValidHex(hex)) {
       const oklch = hexToOklch(hex);
       // ... same logic as above
     }
   }, [...]);
   ```
   - Use controlled input with local state for typing
   - Only update context on blur with valid hex

8. Render structure:
   - Label with color name
   - If overridden: reset icon button (RotateCcw from lucide-react)
   - Saturation component from @uiw/react-color-saturation
   - Hue slider from @uiw/react-color-hue
   - Color swatch preview + hex input

9. Styling (Tailwind):
   - Saturation: width 100%, height 120px
   - Hue: width 100%, height 12px
   - Input: font-mono, text-sm, bordered
   - Use existing docs site color scheme (gray-200 borders, etc.)
  </action>
  <verify>
    - File exists with ColorPickerGroup export
    - TypeScript compiles: `cd apps/docs && pnpm exec tsc --noEmit`
  </verify>
  <done>
    - ColorPickerGroup renders saturation square, hue slider, and hex input
    - Changes update ConfiguratorContext via useConfigurator
    - Reset button appears for overridden colors
  </done>
</task>

<task type="auto">
  <name>Task 2: Create supporting picker components</name>
  <files>
    apps/docs/src/components/configurator/ColorSection.tsx
    apps/docs/src/components/configurator/TailwindSwatches.tsx
    apps/docs/src/components/configurator/RadiusSelector.tsx
    apps/docs/src/components/configurator/ModeToggle.tsx
  </files>
  <action>
**ColorSection.tsx** - Groups colors by semantic role:
```typescript
interface ColorSectionProps {
  title: string;
  children: React.ReactNode;
}
```
- Render title in uppercase small text (text-xs font-semibold text-gray-500)
- Space-y-4 for children (individual ColorPickerGroups)
- Border-bottom for visual separation between sections

**TailwindSwatches.tsx** - Quick-select palette:
1. Define TAILWIND_COLORS constant with all standard Tailwind palettes:
   - red, orange, amber, yellow, lime, green, emerald, teal, cyan, sky, blue, indigo, violet, purple, fuchsia, pink, rose
   - Plus neutral: slate, gray, zinc, neutral, stone
   - Each with shades: 50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 950

2. Props:
   ```typescript
   interface TailwindSwatchesProps {
     onSelect: (hex: string) => void;
   }
   ```

3. Render as scrollable grid:
   - Each row is one color family
   - Each cell is a clickable swatch (button)
   - On click: call onSelect with hex value
   - Hover: scale-110 transform
   - Small size: w-4 h-4 or w-3 h-3

4. Add "Quick Select" label above swatches

**RadiusSelector.tsx** - Border radius picker:
1. Use useConfigurator for radius and setRadius
2. Render 3 buttons: sm, md, lg
3. Active button gets highlighted background (bg-gray-900 text-white)
4. Inactive buttons get subtle styling (bg-gray-100)
5. Show preview: small rounded square for each option

**ModeToggle.tsx** - Light/dark switch:
1. Use useConfigurator for activeMode and setActiveMode
2. Render as segmented control or toggle button group
3. Options: "Light" and "Dark"
4. Active mode highlighted
5. Icons: Sun for light, Moon for dark (from lucide-react)
  </action>
  <verify>
    - All 4 files exist in apps/docs/src/components/configurator/
    - TypeScript compiles: `cd apps/docs && pnpm exec tsc --noEmit`
    - Each component is exported as default or named export
  </verify>
  <done>
    - ColorSection groups pickers with titled sections
    - TailwindSwatches shows all Tailwind colors for quick selection
    - RadiusSelector allows sm/md/lg selection
    - ModeToggle switches between light and dark editing
  </done>
</task>

</tasks>

<verification>
1. All 5 component files exist in apps/docs/src/components/configurator/
2. TypeScript compiles without errors
3. Components properly import from ConfiguratorContext and color-utils
4. No circular dependencies
</verification>

<success_criteria>
- [ ] ColorPickerGroup.tsx renders saturation + hue + hex input
- [ ] ColorSection.tsx groups colors with title
- [ ] TailwindSwatches.tsx displays clickable Tailwind palette
- [ ] RadiusSelector.tsx shows sm/md/lg options
- [ ] ModeToggle.tsx switches light/dark mode
- [ ] All components use useConfigurator hook
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/23-visual-configurator-core/23-02-SUMMARY.md`
</output>

---
phase: 27-core-input-component
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/input/package.json
  - packages/input/tsconfig.json
  - packages/input/vite.config.ts
  - packages/input/src/vite-env.d.ts
  - packages/input/src/input.ts
  - packages/input/src/index.ts
  - packages/input/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "Developer can import Input class from @lit-ui/input"
    - "lui-input element renders a native input in Shadow DOM"
    - "Input supports type prop with text, email, password, number, search values"
    - "Input supports size prop with sm, md, lg values"
    - "Input participates in native forms via ElementInternals"
  artifacts:
    - path: "packages/input/package.json"
      provides: "Package manifest with correct dependencies and exports"
      contains: "@lit-ui/input"
    - path: "packages/input/src/input.ts"
      provides: "Input component class"
      exports: ["Input", "InputType", "InputSize"]
      min_lines: 100
    - path: "packages/input/src/index.ts"
      provides: "Package entry with custom element registration"
      contains: "customElements.define"
  key_links:
    - from: "packages/input/src/index.ts"
      to: "packages/input/src/input.ts"
      via: "import Input"
      pattern: "import.*Input.*from.*input"
    - from: "packages/input/src/input.ts"
      to: "@lit-ui/core"
      via: "TailwindElement base class"
      pattern: "extends TailwindElement"
---

<objective>
Create the @lit-ui/input package with core Input component supporting five input types, three sizes, and native form participation via ElementInternals.

Purpose: Establish the input package structure following existing patterns (button package) and implement the foundational component with type/size variants and form association.

Output: Working lui-input element that renders styled inputs and participates in native forms.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/27-core-input-component/27-CONTEXT.md
@.planning/phases/27-core-input-component/27-RESEARCH.md
@.planning/phases/26-css-tokens-foundation/26-01-SUMMARY.md

# Reference patterns
@packages/button/package.json
@packages/button/src/button.ts
@packages/button/src/index.ts
@packages/button/src/jsx.d.ts
@packages/button/tsconfig.json
@packages/button/vite.config.ts
@packages/core/src/tokens/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create @lit-ui/input package structure</name>
  <files>
    packages/input/package.json
    packages/input/tsconfig.json
    packages/input/vite.config.ts
    packages/input/src/vite-env.d.ts
  </files>
  <action>
Create the input package following the exact button package structure:

1. **package.json** - Copy button's package.json structure:
   - name: "@lit-ui/input"
   - description: "Accessible input component built with Lit and Tailwind CSS"
   - Same exports, sideEffects, scripts, peerDependencies, devDependencies
   - Same keywords array

2. **tsconfig.json** - Copy button's tsconfig.json exactly:
   - extends "@lit-ui/typescript-config/library.json"
   - compilerOptions: outDir, rootDir, baseUrl
   - include: ["src"]

3. **vite.config.ts** - Copy button's vite.config.ts exactly:
   - import createLibraryConfig from '@lit-ui/vite-config/library'
   - export default createLibraryConfig({ entry: 'src/index.ts' })

4. **src/vite-env.d.ts** - Copy button's vite-env.d.ts:
   - /// <reference types="vite/client" />

Do NOT register in pnpm-workspace.yaml (already includes packages/*).
  </action>
  <verify>
```bash
# Files exist with correct content
cat packages/input/package.json | grep "@lit-ui/input"
cat packages/input/tsconfig.json | grep "typescript-config"
cat packages/input/vite.config.ts | grep "createLibraryConfig"
```
  </verify>
  <done>Package structure matches button package, ready for component implementation</done>
</task>

<task type="auto">
  <name>Task 2: Implement Input component with types, sizes, and form association</name>
  <files>
    packages/input/src/input.ts
  </files>
  <action>
Create input.ts following button.ts patterns and RESEARCH.md guidance:

**Types:**
```typescript
export type InputType = 'text' | 'email' | 'password' | 'number' | 'search';
export type InputSize = 'sm' | 'md' | 'lg';
```

**Class structure:**
```typescript
export class Input extends TailwindElement {
  static formAssociated = true;
  private internals: ElementInternals | null = null;
  private inputId = `lui-input-${Math.random().toString(36).substr(2, 9)}`;

  @query('input') private inputEl!: HTMLInputElement;

  // Core props (for Plan 01)
  @property({ type: String }) type: InputType = 'text';
  @property({ type: String }) size: InputSize = 'md';
  @property({ type: String }) name = '';
  @property({ type: String }) value = '';

  constructor() {
    super();
    if (!isServer) {
      this.internals = this.attachInternals();
    }
  }

  // Form value sync
  private updateFormValue() {
    this.internals?.setFormValue(this.value);
  }

  private handleInput(e: Event) {
    const input = e.target as HTMLInputElement;
    this.value = input.value;
    this.updateFormValue();
  }
}
```

**Static styles:**
- Use tailwindBaseStyles spread
- :host { display: inline-block; }
- Size classes (input-sm, input-md, input-lg) using Phase 26 tokens:
  - padding: var(--ui-input-padding-y-{size}) var(--ui-input-padding-x-{size})
  - font-size: var(--ui-input-font-size-{size})
- Base input styles using tokens:
  - border-radius: var(--ui-input-radius)
  - border-width: var(--ui-input-border-width)
  - border-color: var(--ui-input-border)
  - background-color: var(--ui-input-bg)
  - color: var(--ui-input-text)
  - transition: border-color var(--ui-input-transition)

**Render method (basic for Plan 01):**
```typescript
render() {
  return html`
    <input
      id=${this.inputId}
      part="input"
      class=${this.getInputClasses()}
      type=${this.type}
      name=${this.name}
      .value=${this.value}
      @input=${this.handleInput}
    />
  `;
}

private getInputClasses(): string {
  const sizes: Record<InputSize, string> = {
    sm: 'input-sm',
    md: 'input-md',
    lg: 'input-lg',
  };
  return sizes[this.size];
}
```

**Include HTMLElementTagNameMap declaration** at bottom:
```typescript
declare global {
  interface HTMLElementTagNameMap {
    'lui-input': Input;
  }
}
```
  </action>
  <verify>
```bash
# Check class exports and structure
grep -E "export (class|type)" packages/input/src/input.ts
grep "static formAssociated" packages/input/src/input.ts
grep "TailwindElement" packages/input/src/input.ts
```
  </verify>
  <done>Input class with types, sizes, form association implemented</done>
</task>

<task type="auto">
  <name>Task 3: Create index.ts exports and jsx.d.ts type declarations</name>
  <files>
    packages/input/src/index.ts
    packages/input/src/jsx.d.ts
  </files>
  <action>
**index.ts** - Follow button's pattern exactly:
```typescript
// @lit-ui/input - Input component with SSR support
/// <reference path="./jsx.d.ts" />
import { isServer } from 'lit';

// Export component class and types
export { Input } from './input.js';
export type { InputType, InputSize } from './input.js';

// Re-export TailwindElement and isServer for convenience
export { TailwindElement, isServer } from '@lit-ui/core';

// Safe custom element registration with collision detection
import { Input } from './input.js';

if (typeof customElements !== 'undefined') {
  if (!customElements.get('lui-input')) {
    customElements.define('lui-input', Input);
  } else if (!isServer && import.meta.env?.DEV) {
    console.warn(
      '[lui-input] Custom element already registered. ' +
        'This may indicate duplicate imports or version conflicts.'
    );
  }
}

// TypeScript global type registration
declare global {
  interface HTMLElementTagNameMap {
    'lui-input': Input;
  }
}
```

**jsx.d.ts** - Adapt button's jsx.d.ts for input:
```typescript
/**
 * JSX type declarations for lui-input custom element.
 * Provides type support for React, Vue, and Svelte.
 */

import type { Input, InputType, InputSize } from './input.js';

// Common attributes for lui-input (Plan 01 props only)
interface LuiInputAttributes {
  type?: InputType;
  size?: InputSize;
  name?: string;
  value?: string;
}

// React JSX support
declare global {
  namespace JSX {
    interface IntrinsicElements {
      'lui-input': React.DetailedHTMLProps<
        React.InputHTMLAttributes<Input> & LuiInputAttributes,
        Input
      >;
    }
  }
}

// Vue support
declare module 'vue' {
  export interface GlobalComponents {
    'lui-input': import('vue').DefineComponent<LuiInputAttributes>;
  }
}

// Svelte support
declare namespace svelteHTML {
  interface IntrinsicElements {
    'lui-input': LuiInputAttributes & {
      oninput?: (e: InputEvent) => void;
      'on:input'?: (e: CustomEvent<InputEvent>) => void;
    };
  }
}

export {};
```
  </action>
  <verify>
```bash
# Verify exports and registration
grep "customElements.define" packages/input/src/index.ts
grep "export.*Input" packages/input/src/index.ts
grep "lui-input" packages/input/src/jsx.d.ts
```
  </verify>
  <done>Package exports and JSX type declarations complete</done>
</task>

</tasks>

<verification>
After all tasks:

```bash
# Build the package
cd packages/input && pnpm install && pnpm build

# Verify build outputs
ls -la packages/input/dist/
cat packages/input/dist/index.d.ts | head -20

# Type check
cd packages/input && pnpm tsc --noEmit
```
</verification>

<success_criteria>
1. packages/input/ exists with all config files matching button package structure
2. Input class exports InputType, InputSize types
3. Input renders native input element with correct type attribute
4. Input has three size variants (sm, md, lg) using CSS tokens
5. Input has static formAssociated = true and attachInternals() (with isServer guard)
6. Input syncs value to form via setFormValue()
7. lui-input custom element registered
8. Package builds successfully with TypeScript declarations
</success_criteria>

<output>
After completion, create `.planning/phases/27-core-input-component/27-01-SUMMARY.md`
</output>

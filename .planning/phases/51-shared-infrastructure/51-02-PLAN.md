---
phase: 51-shared-infrastructure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/core/src/styles/tailwind.css
  - packages/core/src/tokens/index.ts
  - packages/core/src/styles/overlay-animation.css
autonomous: true

must_haves:
  truths:
    - "CSS custom properties --ui-tooltip-*, --ui-popover-*, and --ui-toast-* are defined on :root and cascade into Shadow DOM"
    - "Dark mode overrides exist in the .dark block for all color-referencing tokens"
    - "Token objects for tooltip, popover, and toast are importable from '@lit-ui/core/tokens'"
    - "A documented overlay animation CSS pattern file exists showing @starting-style + allow-discrete approach"
  artifacts:
    - path: "packages/core/src/styles/tailwind.css"
      provides: "CSS custom properties for tooltip, popover, and toast on :root, plus .dark overrides"
      contains: "--ui-tooltip-bg"
    - path: "packages/core/src/tokens/index.ts"
      provides: "Token objects for tooltip, popover, toast with type exports"
      exports: ["TooltipToken", "PopoverToken", "ToastToken"]
    - path: "packages/core/src/styles/overlay-animation.css"
      provides: "Documented reusable overlay animation pattern extracted from Dialog"
      contains: "@starting-style"
  key_links:
    - from: "packages/core/src/tokens/index.ts"
      to: "packages/core/src/styles/tailwind.css"
      via: "Token objects reference CSS custom property names defined in tailwind.css"
      pattern: "var\\(--ui-tooltip"
    - from: "packages/core/src/styles/overlay-animation.css"
      to: "packages/dialog/src/dialog.ts"
      via: "Pattern extracted from Dialog's proven animation approach"
      pattern: "@starting-style"
---

<objective>
Define CSS design tokens for tooltip, popover, and toast components, and extract a reusable overlay animation pattern from Dialog.

Purpose: All three overlay components (Phases 52-54) need consistent theming tokens and animation patterns. Defining tokens now in `@lit-ui/core` means downstream components have their design system ready and dark mode handled from day one.

Output: New token definitions in tailwind.css (:root + .dark), token objects in tokens/index.ts, and a documented overlay animation CSS file.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/51-shared-infrastructure/51-RESEARCH.md

@packages/core/src/styles/tailwind.css
@packages/core/src/tokens/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add tooltip, popover, and toast CSS tokens to tailwind.css</name>
  <files>
    packages/core/src/styles/tailwind.css
  </files>
  <action>
1. Add three new component token sections to the `:root` block in `tailwind.css`, after the Calendar Component section (line ~662). Follow the exact naming convention used by existing components (`--ui-{component}-{property}`). Use `var(--color-*, var(--ui-color-*))` dual-fallback pattern for all color tokens (matching Dialog, Select patterns).

Add the following sections:

**Tooltip Component** (10 tokens):
```css
/* Tooltip - inverted colors (dark bg, light text) for hint text */
--ui-tooltip-bg: var(--color-foreground, var(--ui-color-foreground));
--ui-tooltip-text: var(--color-background, white);
--ui-tooltip-radius: 0.375rem;
--ui-tooltip-padding-x: 0.75rem;
--ui-tooltip-padding-y: 0.375rem;
--ui-tooltip-font-size: 0.875rem;
--ui-tooltip-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
--ui-tooltip-arrow-size: 8px;
--ui-tooltip-max-width: 20rem;
--ui-tooltip-z-index: 50;
```

**Popover Component** (9 tokens):
```css
--ui-popover-bg: var(--color-card, var(--ui-color-card));
--ui-popover-text: var(--color-card-foreground, var(--ui-color-card-foreground));
--ui-popover-border: var(--color-border, var(--ui-color-border));
--ui-popover-radius: 0.5rem;
--ui-popover-padding: 1rem;
--ui-popover-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
--ui-popover-arrow-size: 8px;
--ui-popover-max-width: 20rem;
--ui-popover-z-index: 50;
```

**Toast Component** (18 tokens):
```css
--ui-toast-bg: var(--color-card, var(--ui-color-card));
--ui-toast-text: var(--color-card-foreground, var(--ui-color-card-foreground));
--ui-toast-border: var(--color-border, var(--ui-color-border));
--ui-toast-radius: 0.5rem;
--ui-toast-padding: 1rem;
--ui-toast-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
--ui-toast-max-width: 24rem;
--ui-toast-gap: 0.75rem;
--ui-toast-z-index: 50;
/* Toast variant colors */
--ui-toast-success-bg: oklch(0.95 0.05 150);
--ui-toast-success-border: oklch(0.70 0.15 150);
--ui-toast-success-icon: oklch(0.55 0.20 150);
--ui-toast-error-bg: oklch(0.95 0.05 25);
--ui-toast-error-border: oklch(0.70 0.15 25);
--ui-toast-error-icon: oklch(0.55 0.20 25);
--ui-toast-warning-bg: oklch(0.95 0.05 85);
--ui-toast-warning-border: oklch(0.70 0.15 85);
--ui-toast-warning-icon: oklch(0.55 0.20 85);
--ui-toast-info-bg: oklch(0.95 0.05 250);
--ui-toast-info-border: oklch(0.70 0.15 250);
--ui-toast-info-icon: oklch(0.55 0.20 250);
```

2. Add dark mode overrides to the `.dark` block (after the Calendar dark mode overrides at line ~203). Follow the existing pattern of overriding color tokens that reference semantic colors.

**Dark mode overrides:**
```css
/* Tooltip dark mode - inverted stays inverted, just swap values */
--ui-tooltip-bg: var(--color-gray-50);
--ui-tooltip-text: var(--color-gray-950);

/* Popover dark mode */
--ui-popover-bg: var(--color-gray-900);
--ui-popover-text: var(--color-gray-50);
--ui-popover-border: var(--color-gray-800);

/* Toast dark mode */
--ui-toast-bg: var(--color-gray-900);
--ui-toast-text: var(--color-gray-50);
--ui-toast-border: var(--color-gray-800);
/* Toast variant dark mode - lower lightness backgrounds, higher lightness icons */
--ui-toast-success-bg: oklch(0.25 0.05 150);
--ui-toast-success-border: oklch(0.45 0.12 150);
--ui-toast-success-icon: oklch(0.70 0.18 150);
--ui-toast-error-bg: oklch(0.25 0.05 25);
--ui-toast-error-border: oklch(0.45 0.12 25);
--ui-toast-error-icon: oklch(0.70 0.18 25);
--ui-toast-warning-bg: oklch(0.25 0.05 85);
--ui-toast-warning-border: oklch(0.45 0.12 85);
--ui-toast-warning-icon: oklch(0.70 0.18 85);
--ui-toast-info-bg: oklch(0.25 0.05 250);
--ui-toast-info-border: oklch(0.45 0.12 250);
--ui-toast-info-icon: oklch(0.70 0.18 250);
```

Use comment headers matching the existing style (`/* Component dark mode overrides */`).
  </action>
  <verify>
    - `grep -c "ui-tooltip" packages/core/src/styles/tailwind.css` shows 12+ matches (10 :root + 2 .dark)
    - `grep -c "ui-popover" packages/core/src/styles/tailwind.css` shows 12+ matches (9 :root + 3 .dark)
    - `grep -c "ui-toast" packages/core/src/styles/tailwind.css` shows 30+ matches (18 :root + 15 .dark)
    - No existing tokens were modified (only additions)
  </verify>
  <done>
    - 37 new CSS custom properties defined on :root (10 tooltip + 9 popover + 18 toast)
    - Dark mode overrides defined in .dark block for all color-referencing tokens
    - Token names follow --ui-{component}-{property} convention
    - No conflicts with existing component namespaces
  </done>
</task>

<task type="auto">
  <name>Task 2: Add token objects to tokens/index.ts and create overlay animation CSS</name>
  <files>
    packages/core/src/tokens/index.ts
    packages/core/src/styles/overlay-animation.css
  </files>
  <action>
1. Add `tooltip`, `popover`, and `toast` token objects to the `tokens` const in `packages/core/src/tokens/index.ts`, after the existing `select` object. Follow the exact pattern from 51-RESEARCH.md (lines 380-441). Include:
   - `tooltip` object with 10 keys: bg, text, radius, paddingX, paddingY, fontSize, shadow, arrowSize, maxWidth, zIndex
   - `popover` object with 9 keys: bg, text, border, radius, padding, shadow, arrowSize, maxWidth, zIndex
   - `toast` object with 18 keys: bg, text, border, radius, padding, shadow, maxWidth, gap, zIndex, successBg, successBorder, successIcon, errorBg, errorBorder, errorIcon, warningBg, warningBorder, warningIcon, infoBg, infoBorder, infoIcon
   - Add type exports: `TooltipToken`, `PopoverToken`, `ToastToken` (same pattern as existing `InputToken`, `SelectToken`)

2. Create `packages/core/src/styles/overlay-animation.css` as a documented reference pattern for overlay animations. This file is NOT imported by tailwind.css -- it serves as a copy-paste reference that downstream component authors (Tooltip, Popover, Toast) will adapt into their component styles. Include:
   - Header comment explaining the pattern and how to use it
   - Template showing the 4 parts: base state (hidden), active state (visible), @starting-style entry animation, and prefers-reduced-motion media query
   - Use `[data-open]` and `:popover-open` as state selectors
   - Show `transition: opacity, transform, display, overlay` with `allow-discrete`
   - Reference Dialog as the proven example
   - Include component-specific examples for tooltip (fade only), popover (scale + fade), toast (slide + fade)

3. Build core to verify no regressions:
   ```bash
   pnpm --filter @lit-ui/core build
   ```
  </action>
  <verify>
    - `grep "tooltip:" packages/core/src/tokens/index.ts` confirms tooltip token object exists
    - `grep "popover:" packages/core/src/tokens/index.ts` confirms popover token object exists
    - `grep "toast:" packages/core/src/tokens/index.ts` confirms toast token object exists
    - `grep "TooltipToken" packages/core/src/tokens/index.ts` confirms type export
    - `cat packages/core/src/styles/overlay-animation.css` shows the documented pattern
    - `pnpm --filter @lit-ui/core build` succeeds
  </verify>
  <done>
    - tokens/index.ts exports tooltip, popover, and toast token objects with all keys matching CSS custom properties
    - Type helpers TooltipToken, PopoverToken, ToastToken are exported
    - overlay-animation.css contains the documented @starting-style + allow-discrete pattern with component-specific examples
    - Core package builds successfully
  </done>
</task>

</tasks>

<verification>
1. `pnpm --filter @lit-ui/core build` passes without errors
2. `packages/core/src/styles/tailwind.css` has :root tokens for tooltip, popover, toast and .dark overrides
3. `packages/core/src/tokens/index.ts` exports tooltip, popover, toast objects and type helpers
4. `packages/core/src/styles/overlay-animation.css` exists with documented pattern
5. `packages/core/dist/tokens/index.js` contains the new token objects
</verification>

<success_criteria>
- 37 new CSS custom properties defined on :root for tooltip (10), popover (9), toast (18)
- Dark mode overrides exist for all color-referencing tokens
- Token objects importable from '@lit-ui/core/tokens'
- Overlay animation pattern documented with @starting-style + allow-discrete approach
- Core builds successfully with no regressions
</success_criteria>

<output>
After completion, create `.planning/phases/51-shared-infrastructure/51-02-SUMMARY.md`
</output>

---
phase: 78-calendar
plan: 03
type: execute
wave: 2
depends_on:
  - 78-01
files_modified:
  - skill/skills/calendar/SKILL.md
autonomous: true
requirements:
  - CAL-03

must_haves:
  truths:
    - "The calendar SKILL.md CSS token table lists all 21 tokens from the tailwind.css :root calendar block with exact default values"
    - "The Events table documents all 3 events: change, month-change, week-select with correct detail shapes"
    - "A Behavior Notes section exists covering key calendar behavioral semantics (views, keyboard, touch, accessibility)"
  artifacts:
    - path: "skill/skills/calendar/SKILL.md"
      provides: "Accurate calendar skill file with expanded CSS token table, all 3 events documented, and Behavior Notes"
      contains: "## Behavior Notes"
  key_links:
    - from: "skill/skills/calendar/SKILL.md (CSS Custom Properties)"
      to: "packages/core/src/styles/tailwind.css (:root calendar block)"
      via: "token defaults must match exactly"
      pattern: "ui-calendar-cell-size|ui-calendar-today-font-weight|ui-calendar-tooltip-bg"
---

<objective>
Expand the `CSS Custom Properties` table in `skill/skills/calendar/SKILL.md` from 16 to 21 entries covering all tokens in the tailwind.css :root calendar block (including the 2 tooltip tokens added by 78-01). Update all default values to match :root exactly. Expand the Events table to include all 3 events (change, month-change, week-select). Add a Behavior Notes section with key calendar behavioral semantics.

Purpose: The skill file is what Claude uses to implement calendar components in user projects. Sixteen of the 21 tokens are documented but with stale default values (hardcoded #e5e7eb, white, #f3f4f6 instead of the proper var() form). Five tokens are missing entirely. The Events table omits month-change and week-select. No Behavior Notes exist. This brings the calendar skill to the same accuracy standard as phases 70-03 through 77-03.

Output: `skill/skills/calendar/SKILL.md` — CSS token table 16→21 entries with correct defaults, all 3 events, Behavior Notes section added
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/78-calendar/78-01-SUMMARY.md

<interfaces>
<!-- Current SKILL.md CSS Custom Properties table (16 entries — stale defaults, missing tokens): -->
```markdown
| Property | Default | Description |
|----------|---------|-------------|
| `--ui-calendar-width` | `320px` | Width of the calendar container. |
| `--ui-calendar-day-size` | `2.5rem` | Width and height of date buttons. |
| `--ui-calendar-gap` | `0.125rem` | Gap between grid items. |             <!-- STALE: :root = 0.25rem -->
| `--ui-calendar-radius` | `0.375rem` | Border radius for buttons and dropdowns. |
| `--ui-calendar-border` | `#e5e7eb` | Border color for selects and dialogs. |  <!-- STALE: :root = var(--color-border, #e5e7eb) -->
| `--ui-calendar-bg` | `white` | Background color for the calendar. |          <!-- STALE: :root = var(--color-background, #ffffff) -->
| `--ui-calendar-text` | `inherit` | Text color (used in dark mode). |          <!-- STALE: :root = var(--color-foreground, ...) -->
| `--ui-calendar-hover-bg` | `#f3f4f6` | Background color on hover. |           <!-- STALE: :root = var(--color-muted, #f3f4f6) -->
| `--ui-calendar-focus-ring` | `var(--color-ring, #3b82f6)` | Focus outline color. | <!-- STALE: :root = var(--color-ring, var(--ui-color-ring)) -->
| `--ui-calendar-nav-color` | `currentColor` | Navigation arrow button color. |  <!-- STALE: :root = var(--color-foreground, currentColor) -->
| `--ui-calendar-weekday-color` | `#6b7280` | Weekday header text color. |       <!-- STALE: :root = var(--color-muted-foreground, #6b7280) -->
| `--ui-calendar-today-border` | `var(--color-primary, #3b82f6)` | Border color for today indicator. | <!-- STALE: :root = 2px solid var(--color-primary, ...) -->
| `--ui-calendar-selected-bg` | `var(--color-primary, #3b82f6)` | Background color for selected date. | <!-- STALE: :root = var(--color-primary, var(--ui-color-primary)) -->
| `--ui-calendar-selected-text` | `white` | Text color for selected date. |    <!-- STALE: :root = var(--color-primary-foreground, white) -->
| `--ui-calendar-outside-opacity` | `0.4` | Opacity for adjacent month dates. |
| `--ui-calendar-disabled-opacity` | `0.5` | Opacity for disabled dates. |      <!-- STALE: :root = 0.4 -->
```

<!-- Missing tokens (in :root but not in current SKILL.md): -->
<!-- --ui-calendar-cell-size: 2.5rem -->
<!-- --ui-calendar-cell-radius: 0.375rem -->
<!-- --ui-calendar-today-font-weight: 600 -->
<!-- --ui-calendar-tooltip-bg: var(--color-foreground, #111827) (added by 78-01) -->
<!-- --ui-calendar-tooltip-text: var(--color-background, #ffffff) (added by 78-01) -->

<!-- Current Events table (only 1 event — missing month-change and week-select): -->
```markdown
| Event | Detail | Description |
|-------|--------|-------------|
| `change` | `{ value: string }` (YYYY-MM-DD) | Fired when a date is selected. |
```

<!-- Correct events from calendar.ts source: -->
<!-- change: dispatchCustomEvent(this, 'change', { date: Date, isoString: string }) -->
<!-- month-change: dispatchCustomEvent(this, 'month-change', { year: number, month: number }) -->
<!-- week-select: dispatchCustomEvent(this, 'week-select', { weekNumber: number, dates: Date[], isoStrings: string[] }) -->

<!-- Full calendar :root block in tailwind.css — source of truth for token defaults: -->
```css
  --ui-calendar-width: 320px;
  --ui-calendar-day-size: 2.5rem;
  --ui-calendar-gap: 0.25rem;
  --ui-calendar-radius: 0.375rem;
  --ui-calendar-cell-size: 2.5rem;
  --ui-calendar-cell-radius: 0.375rem;
  --ui-calendar-bg: var(--color-background, #ffffff);
  --ui-calendar-text: var(--color-foreground, var(--ui-color-foreground));
  --ui-calendar-border: var(--color-border, #e5e7eb);
  --ui-calendar-hover-bg: var(--color-muted, #f3f4f6);
  --ui-calendar-weekday-color: var(--color-muted-foreground, #6b7280);
  --ui-calendar-nav-color: var(--color-foreground, currentColor);
  --ui-calendar-today-font-weight: 600;
  --ui-calendar-today-border: 2px solid var(--color-primary, var(--ui-color-primary));
  --ui-calendar-selected-bg: var(--color-primary, var(--ui-color-primary));
  --ui-calendar-selected-text: var(--color-primary-foreground, white);
  --ui-calendar-disabled-opacity: 0.4;
  --ui-calendar-outside-opacity: 0.4;
  --ui-calendar-focus-ring: var(--color-ring, var(--ui-color-ring));
  --ui-calendar-tooltip-bg: var(--color-foreground, #111827);
  --ui-calendar-tooltip-text: var(--color-background, #ffffff);
```

<!-- Behavior from calendar.ts source code: -->
<!-- - Three views: month (7-col day grid), year (4x3 decade grid), decade (4x3 century grid) -->
<!-- - Click heading to drill up (month→year→decade), select item to drill down; Escape goes back one level -->
<!-- - Roving tabindex via KeyboardNavigationManager; Arrow keys navigate cells; PageUp/PageDown change months -->
<!-- - Gestures: GestureHandler on .month-grid; swipe left = next month, swipe right = prev month -->
<!-- - AnimationController on .month-grid: slide transition respects prefers-reduced-motion -->
<!-- - aria-live="polite" region announces month changes and date selections -->
<!-- - Today: aria-current="date"; disabled: reason appended to aria-label (e.g. "Before minimum date") -->
<!-- - Week number buttons emit week-select event (weekNumber, dates, isoStrings); don't participate in roving tabindex -->
<!-- - lui-calendar-multi: renders 2–3 child lui-calendar with hide-navigation and sequential display-month values; -->
<!--   unified nav buttons; forwards value, locale, constraints, show-week-numbers, first-day-of-week to children -->
<!-- - change event detail: { date: Date, isoString: string }; value prop updated before event fires -->
<!-- - Keyboard shortcuts help dialog triggered by "? Keyboard shortcuts" button; uses native <dialog> showModal() -->
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand CSS tokens, complete Events table, and add Behavior Notes to SKILL.md</name>
  <files>skill/skills/calendar/SKILL.md</files>
  <action>
Make three changes to `skill/skills/calendar/SKILL.md`:

**Change 1: Replace the CSS Custom Properties section (16→21 entries)**

Replace the current `## CSS Custom Properties` section with:

```markdown
## CSS Custom Properties

| Property | Default | Description |
|----------|---------|-------------|
| `--ui-calendar-width` | `320px` | Width of the calendar container. |
| `--ui-calendar-day-size` | `2.5rem` | Width and height of date cell buttons. |
| `--ui-calendar-cell-size` | `2.5rem` | Alias for day-size used in some layout contexts. |
| `--ui-calendar-cell-radius` | `0.375rem` | Border radius for individual day cells. |
| `--ui-calendar-gap` | `0.25rem` | Gap between calendar grid items. |
| `--ui-calendar-radius` | `0.375rem` | Border radius for nav buttons and dropdowns. |
| `--ui-calendar-bg` | `var(--color-background, #ffffff)` | Background color for the calendar. |
| `--ui-calendar-text` | `var(--color-foreground, currentColor)` | Text color for the calendar. |
| `--ui-calendar-border` | `var(--color-border, #e5e7eb)` | Border color for the help dialog and date cells. |
| `--ui-calendar-hover-bg` | `var(--color-muted, #f3f4f6)` | Background color on hover for date and nav buttons. |
| `--ui-calendar-weekday-color` | `var(--color-muted-foreground, #6b7280)` | Weekday header text color. |
| `--ui-calendar-nav-color` | `var(--color-foreground, currentColor)` | Navigation arrow button color. |
| `--ui-calendar-today-font-weight` | `600` | Font weight for today's date cell. |
| `--ui-calendar-today-border` | `2px solid var(--color-primary, var(--ui-color-primary))` | Border applied to today's date cell. |
| `--ui-calendar-selected-bg` | `var(--color-primary, var(--ui-color-primary))` | Background color for the selected date. |
| `--ui-calendar-selected-text` | `var(--color-primary-foreground, white)` | Text color for the selected date. |
| `--ui-calendar-outside-opacity` | `0.4` | Opacity for dates from adjacent months. |
| `--ui-calendar-disabled-opacity` | `0.4` | Opacity for disabled dates. |
| `--ui-calendar-focus-ring` | `var(--color-ring, var(--ui-color-ring))` | Focus outline color for interactive elements. |
| `--ui-calendar-tooltip-bg` | `var(--color-foreground, #111827)` | Background color for constraint tooltips (show-constraint-tooltips). |
| `--ui-calendar-tooltip-text` | `var(--color-background, #ffffff)` | Text color for constraint tooltips (show-constraint-tooltips). |
```

**Change 2: Replace the Events section with all 3 events**

Replace the current `## Events` section:

```markdown
## Events

| Event | Detail | Description |
|-------|--------|-------------|
| `change` | `{ date: Date, isoString: string }` | Fired when a date is selected. `isoString` is YYYY-MM-DD. The `value` prop is updated before firing. |
| `month-change` | `{ year: number, month: number }` | Fired when the displayed month changes (navigation, keyboard, or display-month prop change). `month` is 0-indexed (January = 0). |
| `week-select` | `{ weekNumber: number, dates: Date[], isoStrings: string[] }` | Fired when a week number button is clicked (requires `show-week-numbers`). Contains the ISO week number and all selectable dates in that week. |
```

**Change 3: Add Behavior Notes section at the end of the file**

Append after the last section:

```markdown
## Behavior Notes

- **Three calendar views**: Month view (7-column day grid), year view (4x3 grid of 12 years in the current decade), decade view (4x3 grid of 12 decades in the current century). Click the month/year heading to drill up; click a year or decade cell to drill down; press Escape to go back one level.
- **Keyboard navigation**: Arrow keys navigate between date cells using a roving tabindex (KeyboardNavigationManager). Home/End jump to first/last day of the current view. PageUp/PageDown navigate months in month view. Enter/Space select the focused date in month view or drill into year/decade views.
- **Touch gestures**: GestureHandler on the month grid enables swipe navigation — swipe left advances to next month, swipe right goes to previous month. Not active in year or decade views.
- **Slide animation**: AnimationController on the month grid provides slide transitions between months. Respects `prefers-reduced-motion` media query (0ms duration when set).
- **Aria-live announcements**: Month changes and date selections are announced via `aria-live="polite"` region. Selected dates use the long localized format (e.g., "Thursday, January 1, 2026").
- **Today indicator**: Today's cell gets `aria-current="date"` and a 2px primary-color border. Receives keyboard focus on first render if visible in the current month.
- **Disabled dates**: Disabled cells get `aria-disabled="true"` with the disable reason appended to `aria-label` (e.g., "Thursday, January 1, 2026, Before minimum date"). `pointer-events: none` prevents clicks. With `show-constraint-tooltips`, hovering shows a CSS `::after` tooltip explaining the reason.
- **Week numbers**: `show-week-numbers` adds ISO week number buttons as the first column. Clicking a week number fires `week-select` with all selectable (non-disabled, current-month) dates in that week. Week number buttons are keyboard-accessible but excluded from the roving tabindex (tabindex="-1" fixed).
- **lui-calendar-multi**: Renders 2 or 3 side-by-side `lui-calendar` instances with `hide-navigation`. Provides shared prev/next nav buttons and advances all child months in sync. Forwards `value`, `locale`, `min-date`, `max-date`, `show-week-numbers`, and `first-day-of-week` to all children. On narrow containers, months stack vertically via CSS container queries.
- **Locale detection**: When `locale` is not set, uses `navigator.language` on client and `'en-US'` on server (SSR-safe). `first-day-of-week` overrides locale-detected week start; accepts 1–7 (Intl format: 1=Monday, 7=Sunday).
- **change event detail**: `{ date: Date, isoString: string }`. The `value` property is updated to the ISO string BEFORE the event fires, so `event.target.value` is always current.
- **Keyboard shortcuts help**: A "? Keyboard shortcuts" button at the bottom of month view opens a native `<dialog>` (`showModal()`) listing all keyboard shortcuts. The dialog has no autofocus trap; close via the Close button or Escape.
```
  </action>
  <verify>
    <automated>grep -c "ui-calendar-" /Users/sn0w/Documents/dev/lit-components/skill/skills/calendar/SKILL.md</automated>
  </verify>
  <done>
`grep -c "ui-calendar-" skill/skills/calendar/SKILL.md` returns 21. The `## Events` section contains 3 rows (change, month-change, week-select). The `## Behavior Notes` section exists with at least 10 bullet points. `grep "ui-calendar-gap" skill/skills/calendar/SKILL.md` shows `0.25rem` (not `0.125rem`). `grep "ui-calendar-bg" skill/skills/calendar/SKILL.md` shows `var(--color-background, #ffffff)` (not `white`). `grep "ui-calendar-tooltip" skill/skills/calendar/SKILL.md` shows both tooltip-bg and tooltip-text entries.
  </done>
</task>

</tasks>

<verification>
After task completion:
1. `grep -c "ui-calendar-" skill/skills/calendar/SKILL.md` — returns 21 (one per token in table)
2. `grep "ui-calendar-gap" skill/skills/calendar/SKILL.md` — shows `0.25rem` (was `0.125rem`)
3. `grep "ui-calendar-bg" skill/skills/calendar/SKILL.md` — shows `var(--color-background, #ffffff)` (was `white`)
4. `grep "ui-calendar-disabled-opacity" skill/skills/calendar/SKILL.md` — shows `0.4` (was `0.5`)
5. `grep "month-change\|week-select" skill/skills/calendar/SKILL.md` — shows both events in Events table
6. `grep "Behavior Notes" skill/skills/calendar/SKILL.md` — shows section header
7. `grep "ui-calendar-tooltip" skill/skills/calendar/SKILL.md` — shows both tooltip-bg and tooltip-text entries
8. `grep "ui-calendar-cell-size\|ui-calendar-today-font-weight" skill/skills/calendar/SKILL.md` — shows new tokens
</verification>

<success_criteria>
- CSS Custom Properties table has 21 entries covering all tokens from tailwind.css :root calendar block (including tooltip tokens added by 78-01)
- Color token defaults use double-fallback var() form (e.g., `var(--color-background, #ffffff)`)
- Structural tokens use exact values from tailwind.css :root (gap=0.25rem, disabled-opacity=0.4)
- Events table includes all 3 events: change, month-change, week-select with correct detail shapes
- Behavior Notes section added covering views, keyboard, touch, animations, accessibility, week numbers, multi-month, and change event behavior
</success_criteria>

<output>
After completion, create `.planning/phases/78-calendar/78-03-SUMMARY.md` following the summary template.
</output>

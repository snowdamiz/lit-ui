---
phase: 28-input-differentiators
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/input/src/input.ts
  - packages/input/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "Developer can add prefix content that appears before input text"
    - "Developer can add suffix content that appears after input text"
    - "Clicking on prefix/suffix area focuses the input"
    - "Slot padding scales with input size (sm/md/lg)"
  artifacts:
    - path: "packages/input/src/input.ts"
      provides: "Input container with prefix/suffix slots"
      contains: "slot name=\"prefix\""
    - path: "packages/input/src/input.ts"
      provides: "Flex container for input and slots"
      contains: "input-container"
  key_links:
    - from: "slot[name=prefix]"
      to: "input element focus"
      via: "handleContainerClick"
      pattern: "this\\.inputEl\\?\\.focus"
---

<objective>
Add flex container structure with prefix and suffix slots to the Input component.

Purpose: Enable developers to add icons, currency symbols, or other content before/after input text. This restructure also prepares the component for password toggle and clear button in Plan 02.

Output: Input component with working prefix/suffix slots, click-to-focus delegation, and size-scaled slot padding.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/28-input-differentiators/28-CONTEXT.md
@.planning/phases/28-input-differentiators/28-RESEARCH.md
@packages/input/src/input.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add input-container flex wrapper with prefix/suffix slots</name>
  <files>packages/input/src/input.ts</files>
  <action>
Restructure the input render to wrap the native input in a flex container with slots:

1. Add `.input-container` div wrapping the input element (between helper text and error display)
2. Move border/background/radius styles from `input` to `.input-container`
3. Update `input` styles: remove border/background, add `flex: 1`, `min-width: 0`, `outline: none`
4. Add `slot[name="prefix"]` before input, `slot[name="suffix"]` after input
5. Add slot container styles with `.input-slot`, `.prefix-slot`, `.suffix-slot` classes
6. Add size-specific slot padding using existing `--ui-input-padding-x-{size}` tokens
7. Add container size classes: `.container-sm`, `.container-md`, `.container-lg`
8. Move focus-within, error, and disabled states to container level

Container structure:
```html
<div class="input-container container-{size} {error-class}">
  <slot name="prefix" part="prefix" class="input-slot prefix-slot"></slot>
  <input ... />
  <slot name="suffix" part="suffix" class="input-slot suffix-slot"></slot>
</div>
```

CSS additions (see RESEARCH.md for complete patterns):
- `.input-container` - flex, align-items center, border/bg/radius from input
- `.input-container:focus-within` - focus border color
- `.input-container.container-error` - error border color
- `.input-slot` - flex, align-items center
- `.prefix-slot` - padding-left per size
- `.suffix-slot` - padding-right per size
  </action>
  <verify>
Run `pnpm build` - build succeeds with no type errors.
Test in browser: lui-input renders with container wrapper visible in DevTools.
  </verify>
  <done>Input wrapped in flex container, slots in place, styles moved to container level.</done>
</task>

<task type="auto">
  <name>Task 2: Implement container click-to-focus delegation</name>
  <files>packages/input/src/input.ts, packages/input/src/jsx.d.ts</files>
  <action>
Add click handler to focus input when clicking on container or slot areas:

1. Add `handleContainerClick(e: Event)` method:
   - Get target as HTMLElement
   - Check if click was on container itself OR on a slot but NOT on interactive content (button, a, input)
   - If so, call `this.inputEl?.focus()`

```typescript
private handleContainerClick(e: Event): void {
  const target = e.target as HTMLElement;
  // Focus if clicking container directly or slot area (not interactive content)
  if (target === e.currentTarget ||
      (target.closest('slot') && !target.closest('button, a, input'))) {
    this.inputEl?.focus();
  }
}
```

2. Add `@click=${this.handleContainerClick}` to `.input-container` div

3. Add `getContainerClasses()` method returning size and error classes:
   - `container-${this.size}`
   - `container-error` if showError is true

4. Update JSX types in jsx.d.ts:
   - No new props needed (slots are implicit), but verify typing is complete
  </action>
  <verify>
Run `pnpm build` - build succeeds.
Test in browser:
1. Add prefix content: `<span slot="prefix">$</span>` - click on $ focuses input
2. Add suffix content: `<span slot="suffix">USD</span>` - click on USD focuses input
3. Verify interactive content in slots (buttons) still works and doesn't hijack focus
  </verify>
  <done>Clicking anywhere in container (including slot areas) focuses input. Interactive slot content still functions.</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Build check: `pnpm build` passes
2. Type check: `pnpm type-check` passes (if available) or no TS errors in build
3. Visual test: Input with prefix/suffix slots displays correctly in dev server
4. Focus delegation: Clicking slot areas focuses the input
5. Size scaling: Slots have appropriate padding at sm/md/lg sizes
</verification>

<success_criteria>
1. Developer adds `<span slot="prefix">$</span>` - dollar sign appears left of input text
2. Developer adds `<span slot="suffix">kg</span>` - unit label appears right of input text
3. Clicking on prefix/suffix content (non-interactive) focuses the input
4. Slot padding scales appropriately with input size prop
5. Existing input functionality (validation, states, label, helper) unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/28-input-differentiators/28-01-SUMMARY.md`
</output>

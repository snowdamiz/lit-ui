---
phase: 37-cli-and-documentation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/docs/src/pages/components/SelectPage.tsx
autonomous: true

must_haves:
  truths:
    - "Developer sees Async & Performance section in Select documentation"
    - "Developer finds Promise-based options example with loading states"
    - "Developer finds async search example with debounce"
    - "Developer finds infinite scroll example"
    - "Developer finds virtual scrolling mention for large lists"
  artifacts:
    - path: "apps/docs/src/pages/components/SelectPage.tsx"
      provides: "Async loading documentation"
      contains: "Async"
  key_links:
    - from: "apps/docs/src/pages/components/SelectPage.tsx"
      to: "@lit-ui/select async features"
      via: "code examples"
      pattern: "asyncSearch|loadMore|Promise"
---

<objective>
Add Async & Performance documentation section to SelectPage.tsx covering Phase 36 features.

Purpose: Developers can learn how to use Promise-based options, async search, loading states, and infinite scroll.
Output: SelectPage.tsx with new "Async & Performance" section containing code examples for Phase 36 features.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/37-cli-and-documentation/37-RESEARCH.md

# Reference files
@apps/docs/src/pages/components/SelectPage.tsx
@packages/select/src/select.ts (for API reference)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add async props to API reference tables</name>
  <files>apps/docs/src/pages/components/SelectPage.tsx</files>
  <action>
Add the async-related props to the `selectProps` array that are currently missing:

```typescript
{
  name: 'debounceDelay',
  type: 'number',
  default: '300',
  description: 'Debounce delay in milliseconds for async search.',
},
{
  name: 'minSearchLength',
  type: 'number',
  default: '0',
  description: 'Minimum characters before triggering async search.',
},
{
  name: 'asyncSearch',
  type: '(query: string, signal: AbortSignal) => Promise<SelectOption[]>',
  default: 'undefined',
  description: 'Async function called when user types. Receives query and AbortSignal for cancellation.',
},
{
  name: 'loadMore',
  type: '() => Promise<SelectOption[]>',
  default: 'undefined',
  description: 'Callback for infinite scroll pagination. Called when scrolling near bottom.',
},
```

Insert these after the existing `customFilter` prop to group async-related props together.

Also update the `options` prop type to include Promise:
```typescript
{
  name: 'options',
  type: 'SelectOption[] | Promise<SelectOption[]>',
  default: '[]',
  description: 'Array of options or Promise that resolves to options. Shows loading skeleton when Promise is pending.',
},
```
  </action>
  <verify>
Read SelectPage.tsx and confirm the new async props are present in selectProps array.
  </verify>
  <done>
selectProps array includes debounceDelay, minSearchLength, asyncSearch, and loadMore props, and options prop type includes Promise.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add Async & Performance section with examples</name>
  <files>apps/docs/src/pages/components/SelectPage.tsx</files>
  <action>
Add a new section after the Combobox section (after the "Searchable Multi-Select" example, before the API Reference section).

Add section header (following existing pattern from Multi-Select and Combobox sections):

```tsx
{/* Async & Performance Section Header */}
<div className="mt-16 mb-8">
  <div className="flex items-center gap-4">
    <div className="flex h-10 w-10 items-center justify-center rounded-xl bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400">
      <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={1.5}>
        <path strokeLinecap="round" strokeLinejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
      </svg>
    </div>
    <div>
      <h2 className="text-xl font-bold text-gray-900 dark:text-gray-100">
        Async & Performance
        <span className="ml-2 px-2 py-0.5 text-xs font-medium bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 rounded">Phase 36</span>
      </h2>
      <p className="text-sm text-gray-500 dark:text-gray-400">Promise-based options, async search, and infinite scroll for large datasets</p>
    </div>
    <div className="flex-1 h-px bg-gradient-to-r from-gray-200 dark:from-gray-700 to-transparent" />
  </div>
</div>
```

Add code examples at the top of the file (with other code examples):

```typescript
// Async examples (Phase 36)
const asyncOptionsCode = `// Options can be a Promise - shows loading skeleton while pending
const options = new Promise(resolve =>
  setTimeout(() => resolve([
    { value: 'a', label: 'Option A' },
    { value: 'b', label: 'Option B' },
    { value: 'c', label: 'Option C' },
  ]), 1000)
);

<lui-select
  label="Async Options"
  placeholder="Loading..."
  .options=\${options}
></lui-select>`;

const asyncSearchCode = `// Async search with debounce and cancellation
<lui-select
  label="Search Users"
  searchable
  placeholder="Type to search..."
  debounceDelay={300}
  minSearchLength={2}
  .asyncSearch=\${async (query, signal) => {
    const res = await fetch(\`/api/users?q=\${query}\`, { signal });
    const data = await res.json();
    return data.map(u => ({ value: u.id, label: u.name }));
  }}
></lui-select>`;

const infiniteScrollCode = `// Infinite scroll loads more options when scrolling near bottom
let page = 1;

<lui-select
  label="All Products"
  placeholder="Select product..."
  .options=\${fetchProducts(1)}
  .loadMore=\${async () => {
    page++;
    return fetchProducts(page);
  }}
></lui-select>`;

const virtualScrollNote = `// Virtual scrolling is auto-enabled for:
// - Promise-based options (async loading)
// - asyncSearch mode
// - Large option lists (1000+ items)
// This ensures 60fps scroll performance with large datasets.`;
```

Add example sections (after the section header):

```tsx
{/* 17. Async Options with Loading State */}
<section>
  <h3 className="text-base font-semibold text-gray-900 dark:text-gray-100 mb-2">Promise-Based Options</h3>
  <p className="text-gray-500 dark:text-gray-400 mb-4 text-sm">
    Pass a Promise to the <code className="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs font-mono">options</code> prop.
    A loading skeleton displays while the Promise is pending. If rejected, an error state with retry button appears.
  </p>
  <ExampleBlock
    preview={null}
    html={asyncOptionsCode}
    react={asyncOptionsCode}
    vue={asyncOptionsCode}
    svelte={asyncOptionsCode}
  />
</section>

{/* 18. Async Search */}
<section>
  <h3 className="text-base font-semibold text-gray-900 dark:text-gray-100 mb-2">Async Search</h3>
  <p className="text-gray-500 dark:text-gray-400 mb-4 text-sm">
    Use <code className="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs font-mono">asyncSearch</code> for server-side filtering.
    The function receives the search query and an AbortSignal for cancellation. Previous requests are automatically cancelled.
  </p>
  <ExampleBlock
    preview={null}
    html={asyncSearchCode}
    react={asyncSearchCode}
    vue={asyncSearchCode}
    svelte={asyncSearchCode}
  />
</section>

{/* 19. Infinite Scroll */}
<section>
  <h3 className="text-base font-semibold text-gray-900 dark:text-gray-100 mb-2">Infinite Scroll</h3>
  <p className="text-gray-500 dark:text-gray-400 mb-4 text-sm">
    Use <code className="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs font-mono">loadMore</code> for pagination.
    The callback is triggered when scrolling near the bottom of the dropdown. New options are appended to the list.
  </p>
  <ExampleBlock
    preview={null}
    html={infiniteScrollCode}
    react={infiniteScrollCode}
    vue={infiniteScrollCode}
    svelte={infiniteScrollCode}
  />
</section>

{/* 20. Virtual Scrolling Note */}
<section>
  <h3 className="text-base font-semibold text-gray-900 dark:text-gray-100 mb-2">Virtual Scrolling</h3>
  <p className="text-gray-500 dark:text-gray-400 mb-4 text-sm">
    Virtual scrolling is automatically enabled when using async features or large option lists. This ensures smooth 60fps scrolling even with thousands of options.
  </p>
  <div className="rounded-xl border border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900 p-4">
    <pre className="text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono">{virtualScrollNote}</pre>
  </div>
</section>
```

Note: The async examples use `preview={null}` because interactive async demos require real APIs or mock server setup which isn't practical for static documentation. The code examples suffice for developer understanding.
  </action>
  <verify>
Read SelectPage.tsx and confirm:
1. Async & Performance section header exists with Phase 36 badge
2. Code examples for async options, async search, infinite scroll exist
3. Virtual scrolling note exists
  </verify>
  <done>
SelectPage.tsx contains Async & Performance section with 4 subsections covering Promise options, async search, infinite scroll, and virtual scrolling.
  </done>
</task>

</tasks>

<verification>
1. Verify SelectPage.tsx contains Async & Performance section
2. Verify async props are documented in the props table
3. Run type check: `pnpm --filter docs exec tsc --noEmit`
4. Run dev server and visually confirm the new section renders: `pnpm --filter docs dev`
</verification>

<success_criteria>
- SelectPage.tsx has Async & Performance section after Combobox section
- Props table includes debounceDelay, minSearchLength, asyncSearch, loadMore
- Options prop type updated to include Promise
- TypeScript compiles without errors
- New section renders correctly in browser
</success_criteria>

<output>
After completion, create `.planning/phases/37-cli-and-documentation/37-02-SUMMARY.md`
</output>

---
phase: 43-calendar-display-advanced
plan: 06
type: execute
wave: 4
depends_on: ["43-04", "43-05"]
files_modified:
  - packages/calendar/src/calendar.ts
  - packages/calendar/src/calendar-multi.ts
autonomous: true

must_haves:
  truths:
    - "CalendarMulti renders 2-3 side-by-side Calendar instances showing consecutive months"
    - "CalendarMulti owns navigation (prev/next); child Calendars hide their navigation"
    - "display-month property accepts both YYYY-MM-DD and YYYY-MM formats"
    - "hide-navigation attribute hides the Calendar header nav buttons"
    - "CalendarMulti heading shows month range with en-dash (e.g., 'January - March 2026')"
  artifacts:
    - path: "packages/calendar/src/calendar-multi.ts"
      provides: "Multi-month calendar wrapper component"
      contains: "class CalendarMulti extends TailwindElement"
      exports: ["CalendarMulti"]
    - path: "packages/calendar/src/calendar.ts"
      provides: "Calendar with display-month and hide-navigation props"
      contains: "display-month"
      exports: ["Calendar", "DateConstraints", "DayCellState"]
  key_links:
    - from: "packages/calendar/src/calendar-multi.ts"
      to: "packages/calendar/src/calendar.ts"
      via: "renders lui-calendar elements with display-month and hide-navigation"
      pattern: "lui-calendar.*display-month"
    - from: "packages/calendar/src/calendar-multi.ts"
      to: "@lit-ui/core"
      via: "extends TailwindElement"
      pattern: "extends TailwindElement"
---

<objective>
Add display-month and hide-navigation properties to Calendar, and create CalendarMulti wrapper component that renders 2-3 synchronized calendars side-by-side.

Purpose: Multi-month display is essential for date range selection, allowing users to see and interact with consecutive months simultaneously. The CalendarMulti component coordinates navigation across child calendars.
Output: Calendar with display-month/hide-navigation props, and CalendarMulti component showing 2-3 months.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-calendar-display-advanced/43-RESEARCH.md
@.planning/phases/43-calendar-display-advanced/43-04-SUMMARY.md
@.planning/phases/43-calendar-display-advanced/43-05-SUMMARY.md

Reference patterns from:
@packages/calendar/src/calendar.ts (current state after Plans 04+05)
@packages/calendar/src/index.ts (element registration pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add display-month and hide-navigation properties to Calendar</name>
  <files>packages/calendar/src/calendar.ts</files>
  <action>
    Add two new properties to the Calendar class:

    1. `@property({ type: String, attribute: 'display-month' }) displayMonth = '';`
       - Accepts ISO date strings in YYYY-MM-DD or YYYY-MM format
       - When set, overrides currentMonth to show the specified month
       - In updated(): when displayMonth changes, parse it:
         - If 7 chars (YYYY-MM format): append '-01' then parseISO
         - If 10 chars (YYYY-MM-DD format): parseISO directly
         - Set currentMonth to the parsed date
       - This allows CalendarMulti to control which month each child displays

    2. `@property({ type: Boolean, attribute: 'hide-navigation' }) hideNavigation = false;`
       - When true, hides the calendar header (prev/next buttons and heading)
       - In renderMonthView(): wrap header in `${this.hideNavigation ? nothing : html`<div class="calendar-header">...</div>`}`
       - Similarly hide headers in renderYearView() and renderDecadeView()

    Both properties work independently — display-month can be used without hide-navigation and vice versa.
  </action>
  <verify>
    - `grep "display-month" packages/calendar/src/calendar.ts` shows the property
    - `grep "hide-navigation" packages/calendar/src/calendar.ts` shows the property
    - `grep "hideNavigation" packages/calendar/src/calendar.ts` shows usage in render
    - `pnpm --filter @lit-ui/calendar build` succeeds
  </verify>
  <done>Calendar accepts display-month for external month control and hide-navigation to hide header</done>
</task>

<task type="auto">
  <name>Task 2: Create CalendarMulti wrapper component</name>
  <files>packages/calendar/src/calendar-multi.ts</files>
  <action>
    Create `packages/calendar/src/calendar-multi.ts`:

    1. Imports:
       - `html, css, nothing, isServer, type PropertyValues, type CSSResultGroup` from 'lit'
       - `property, state` from 'lit/decorators.js'
       - `TailwindElement, tailwindBaseStyles, dispatchCustomEvent` from '@lit-ui/core'
       - `addMonths, subMonths, getYear, getMonth, getMonthYearLabel` from './date-utils.js'
       - `import './calendar.js'` — Ensures lui-calendar is registered (side effect import)

    2. Export class CalendarMulti extends TailwindElement:

    3. Static styles: tailwindBaseStyles + component CSS:
       ```css
       :host {
         display: block;
       }
       .multi-header {
         display: flex;
         align-items: center;
         justify-content: space-between;
         padding: 0.5rem;
       }
       .multi-heading {
         font-size: 0.875rem;
         font-weight: 600;
         margin: 0;
       }
       .multi-wrapper {
         display: flex;
         gap: 1rem;
       }
       .multi-wrapper > * {
         min-width: 280px;
         flex: 1;
       }
       .nav-button {
         /* Same nav-button styles as Calendar */
         display: flex;
         align-items: center;
         justify-content: center;
         width: 2rem;
         height: 2rem;
         border: none;
         background: none;
         cursor: pointer;
         border-radius: var(--ui-calendar-radius, 0.375rem);
         color: var(--ui-calendar-nav-color, currentColor);
       }
       .nav-button:hover {
         background-color: var(--ui-calendar-hover-bg, #f3f4f6);
       }
       .nav-button:focus-visible {
         outline: 2px solid var(--ui-calendar-focus-ring, var(--color-ring, #3b82f6));
         outline-offset: 2px;
       }
       .nav-button svg {
         width: 1rem;
         height: 1rem;
       }
       ```
       Add dark mode styles for .multi-header, .nav-button matching Calendar's dark mode pattern.

    4. Properties:
       - `@property({ type: Number }) months = 2;` — Number of months to display, clamped to 2-3
       - `@property({ type: String }) value = '';` — Selected date ISO string, passed through to children
       - `@property({ type: String }) locale = '';` — Locale, passed through to children
       - `@property({ type: String, attribute: 'min-date' }) minDate = '';` — Passed through
       - `@property({ type: String, attribute: 'max-date' }) maxDate = '';` — Passed through
       - `@property({ type: Array, attribute: false }) disabledDates: string[] = [];` — Passed through
       - `@property({ type: String, attribute: 'first-day-of-week' }) firstDayOfWeekOverride = '';` — Passed through
       - `@property({ type: Boolean, attribute: 'show-week-numbers' }) showWeekNumbers = false;` — Passed through

    5. State:
       - `@state() private currentMonth = new Date();` — Base month (leftmost calendar)

    6. Private computed helpers:
       - `private get effectiveLocale(): string` — Same pattern as Calendar
       - `private get monthCount(): number` — Returns Math.max(2, Math.min(3, this.months))

    7. Navigation methods:
       - `private navigatePrev(): void` — currentMonth = subMonths(currentMonth, 1). Emit month-change event.
       - `private navigateNext(): void` — currentMonth = addMonths(currentMonth, 1). Emit month-change event.

    8. Heading generation:
       - `private get rangeHeading(): string` — Format "January - March 2026" or "December 2025 - February 2026" using Intl.DateTimeFormat
       - For same year: format as "${firstMonth} \u2013 ${lastMonth} ${year}" (en-dash)
       - For cross-year: format as "${firstMonth} ${firstYear} \u2013 ${lastMonth} ${lastYear}"

    9. render() method:
       ```typescript
       const count = this.monthCount;
       return html`
         <div class="calendar-multi">
           <div class="multi-header">
             <button class="nav-button" @click="${this.navigatePrev}"
                     aria-label="Previous month">
               <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                 <path d="M15 18l-6-6 6-6" />
               </svg>
             </button>
             <h2 class="multi-heading">${this.rangeHeading}</h2>
             <button class="nav-button" @click="${this.navigateNext}"
                     aria-label="Next month">
               <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                 <path d="M9 18l6-6-6-6" />
               </svg>
             </button>
           </div>
           <div class="multi-wrapper">
             ${Array.from({ length: count }, (_, i) => {
               const month = addMonths(this.currentMonth, i);
               const displayMonth = `${getYear(month)}-${String(getMonth(month) + 1).padStart(2, '0')}`;
               return html`
                 <lui-calendar
                   display-month="${displayMonth}"
                   hide-navigation
                   value="${this.value}"
                   locale="${this.locale}"
                   min-date="${this.minDate}"
                   max-date="${this.maxDate}"
                   .disabledDates="${this.disabledDates}"
                   first-day-of-week="${this.firstDayOfWeekOverride}"
                   ?show-week-numbers="${this.showWeekNumbers}"
                   @change="${this.handleChildChange}"
                   @week-select="${this.handleChildWeekSelect}"
                 ></lui-calendar>
               `;
             })}
           </div>
         </div>
       `;
       ```

    10. Event forwarding:
        - `private handleChildChange(e: Event): void` — Re-dispatch the change event detail from child calendar. Update this.value with the selected date.
        - `private handleChildWeekSelect(e: Event): void` — Re-dispatch the week-select event detail from child calendar.
  </action>
  <verify>
    - `grep "class CalendarMulti" packages/calendar/src/calendar-multi.ts` confirms class
    - `grep "display-month" packages/calendar/src/calendar-multi.ts` confirms prop passthrough
    - `grep "hide-navigation" packages/calendar/src/calendar-multi.ts` confirms usage
    - `grep "multi-wrapper" packages/calendar/src/calendar-multi.ts` confirms flexbox layout
    - `grep "rangeHeading" packages/calendar/src/calendar-multi.ts` confirms heading generation
    - `pnpm --filter @lit-ui/calendar build` succeeds
  </verify>
  <done>CalendarMulti renders 2-3 synchronized calendars with shared navigation, range heading, and event forwarding</done>
</task>

</tasks>

<verification>
- `pnpm --filter @lit-ui/calendar build` completes without errors
- Calendar accepts display-month (YYYY-MM and YYYY-MM-DD) and hide-navigation attributes
- CalendarMulti renders 2-3 lui-calendar instances side-by-side
- CalendarMulti header shows month range with en-dash
- CalendarMulti forwards value, locale, constraints, and events to/from child calendars
- Months count is clamped to 2-3
</verification>

<success_criteria>
1. display-month property controls which month Calendar displays
2. hide-navigation hides Calendar header
3. CalendarMulti shows 2-3 consecutive months side-by-side
4. CalendarMulti owns prev/next navigation
5. Range heading shows "Month1 - MonthN Year" format
6. Events (change, week-select) propagate through CalendarMulti
7. Package builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/43-calendar-display-advanced/43-06-SUMMARY.md`
</output>

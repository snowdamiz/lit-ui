---
phase: 43-calendar-display-advanced
plan: 06
type: execute
wave: 4
depends_on: ["43-05"]
files_modified:
  - packages/calendar/src/calendar.ts
  - packages/calendar/src/calendar-multi.ts
autonomous: true

must_haves:
  truths:
    - "Calendar accepts display-month attribute to set displayed month externally"
    - "Calendar accepts hide-navigation attribute to hide its own navigation controls"
    - "Multi-month wrapper shows 2-3 calendars side by side"
    - "Multi-month navigation is synchronized across all child calendars"
    - "User can select dates in any of the displayed months"
  artifacts:
    - path: "packages/calendar/src/calendar.ts"
      provides: "display-month and hide-navigation properties"
      contains: "display-month|hide-navigation"
    - path: "packages/calendar/src/calendar-multi.ts"
      provides: "Multi-month wrapper component"
      exports: ["CalendarMulti"]
  key_links:
    - from: "packages/calendar/src/calendar-multi.ts"
      to: "packages/calendar/src/calendar.ts"
      via: "lui-calendar composition"
      pattern: "lui-calendar.*display-month"
---

<objective>
Add external month control props to Calendar and create multi-month wrapper component.

Purpose: Multi-month display (CAL-20) requires a wrapper that renders 2-3 Calendar instances with synchronized navigation. The Calendar needs display-month and hide-navigation props to work as a controlled child component.
Output: Calendar with new props + CalendarMulti wrapper component (lui-calendar-multi).
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/calendar/src/calendar.ts
@packages/calendar/src/index.ts
@.planning/phases/43-calendar-display-advanced/43-RESEARCH.md
@.planning/phases/43-calendar-display-advanced/43-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add display-month and hide-navigation props to Calendar</name>
  <files>packages/calendar/src/calendar.ts</files>
  <action>
Add two new properties to Calendar class:

1. `@property({ type: String, attribute: 'display-month' }) displayMonth?: string;`
   - Accepts ISO date string (YYYY-MM-DD or YYYY-MM)
   - When set, overrides internal currentMonth state
   - In updated() lifecycle: if displayMonth changed, parse it and set currentMonth
   - Parse format: if just YYYY-MM, append -01 for parsing
   - This allows external control of displayed month (used by multi-month wrapper)

2. `@property({ type: Boolean, attribute: 'hide-navigation' }) hideNavigation = false;`
   - When true, hides the navigation header (prev/next buttons, heading) and dropdowns
   - In renderMonthView: conditionally render header and selectors based on this flag
   - Also applies to decade/century views (hide their navigation too)

3. Update renderMonthView():
   - If hideNavigation, skip renderHeader() and renderSelectors() calls
   - Grid still renders normally

4. Make sure displayMonth syncs with internal state properly:
   - If displayMonth is set AND changes, update currentMonth/selectedMonth/selectedYear
   - If displayMonth is not set, internal navigation still works as before

This is a non-breaking addition - existing usage without these props is unchanged.
  </action>
  <verify>
`npx tsc --noEmit -p packages/calendar/tsconfig.json` compiles.
  </verify>
  <done>
Calendar accepts display-month and hide-navigation attributes. External month control works for multi-month composition.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CalendarMulti wrapper component</name>
  <files>packages/calendar/src/calendar-multi.ts</files>
  <action>
Create `calendar-multi.ts` with:

1. Import TailwindElement, tailwindBaseStyles, addMonths from date-fns, html/css/nothing from lit
2. Import Calendar class to ensure it's registered

3. Export `CalendarMulti` class extending TailwindElement:

Properties:
- `@property({ type: Number }) months: number = 2;` (2 or 3, clamped)
- `@property({ type: String }) locale: string = 'en-US';`
- `@property({ type: String }) value: string = '';` (selected date passthrough)
- `@property({ type: String, attribute: 'min-date' }) minDate?: string;`
- `@property({ type: String, attribute: 'max-date' }) maxDate?: string;`
- `@property({ type: Array, attribute: 'disabled-dates' }) disabledDates?: string[];`
- `@property({ type: Boolean, attribute: 'disable-weekends' }) disableWeekends = false;`
- `@property({ type: Boolean, attribute: 'show-week-numbers' }) showWeekNumbers = false;`
- `@property({ type: String }) size: string = 'md';`

State:
- `@state() private baseMonth: Date = new Date();`

Methods:
- `handlePreviousMonth()`: `baseMonth = subMonths(baseMonth, 1)`, emit ui-month-change
- `handleNextMonth()`: `baseMonth = addMonths(baseMonth, 1)`, emit ui-month-change
- `handleDateSelect(e: CustomEvent)`: re-dispatch the event (bubbles from child calendar)
- `getMonthRange()`: formatted label showing "Month1 - MonthN Year" using Intl API

Render:
```typescript
render() {
  return html`
    <div class="calendar-multi" role="group" aria-label="Multi-month calendar">
      <div class="calendar-header">
        <button @click=${this.handlePreviousMonth} aria-label="Previous month" type="button">&lt;</button>
        <h2 aria-live="polite">${this.getMonthRange()}</h2>
        <button @click=${this.handleNextMonth} aria-label="Next month" type="button">&gt;</button>
      </div>
      <div class="calendar-grid-container">
        ${Array.from({ length: Math.min(Math.max(this.months, 2), 3) }, (_, i) => {
          const month = addMonths(this.baseMonth, i);
          const isoMonth = formatDate(month);
          return html`
            <lui-calendar
              .locale=${this.locale}
              display-month=${isoMonth}
              hide-navigation
              .value=${this.value}
              .minDate=${this.minDate}
              .maxDate=${this.maxDate}
              .disabledDates=${this.disabledDates}
              .disableWeekends=${this.disableWeekends}
              .showWeekNumbers=${this.showWeekNumbers}
              .size=${this.size}
              @ui-date-select=${this.handleDateSelect}
            ></lui-calendar>
          `;
        })}
      </div>
    </div>
  `;
}
```

Styles:
- Header matches Calendar's header styles (reuse same CSS custom properties)
- `.calendar-grid-container`: flexbox with `gap: 1rem`, wrapping for responsive
- Each child calendar gets `flex: 1 1 280px` for minimum width
- Dark mode styles using `:host-context(.dark)` matching Calendar patterns
  </action>
  <verify>
`npx tsc --noEmit -p packages/calendar/tsconfig.json` compiles.
`pnpm --filter @lit-ui/calendar build` succeeds.
  </verify>
  <done>
CalendarMulti shows 2-3 Calendar instances with synchronized navigation. Wrapper owns navigation; children use display-month and hide-navigation props.
  </done>
</task>

</tasks>

<verification>
- TypeScript compiles: `npx tsc --noEmit -p packages/calendar/tsconfig.json`
- Build passes: `pnpm --filter @lit-ui/calendar build`
- Calendar display-month attribute sets displayed month externally
- Calendar hide-navigation hides all navigation UI
- CalendarMulti renders 2-3 synchronized calendars
- Navigation in wrapper updates all child calendars
- Date selection in any child calendar dispatches event
</verification>

<success_criteria>
Multi-month calendar shows 2-3 side-by-side months with synchronized navigation. Individual Calendar instances can be externally controlled via display-month prop.
</success_criteria>

<output>
After completion, create `.planning/phases/43-calendar-display-advanced/43-06-SUMMARY.md`
</output>

---
phase: 43-calendar-display-advanced
plan: 08
type: execute
wave: 6
depends_on: ["43-07"]
files_modified:
  - packages/calendar/src/index.ts
  - packages/calendar/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "CalendarMulti is exported from package index"
    - "lui-calendar-multi custom element is registered"
    - "JSX types include lui-calendar-multi"
    - "New utility exports (DayCellState, WeekInfo, GestureHandler, AnimationController) available"
    - "TypeScript build passes for the calendar package"
  artifacts:
    - path: "packages/calendar/src/index.ts"
      provides: "Package exports including CalendarMulti"
      exports: ["Calendar", "CalendarMulti", "DayCellState", "WeekInfo"]
    - path: "packages/calendar/src/jsx.d.ts"
      provides: "JSX type definitions for lui-calendar-multi"
      contains: "lui-calendar-multi"
  key_links:
    - from: "packages/calendar/src/index.ts"
      to: "packages/calendar/src/calendar-multi.ts"
      via: "export and customElements.define"
      pattern: "CalendarMulti|lui-calendar-multi"
---

<objective>
Update package exports, JSX types, and register the new CalendarMulti custom element.

Purpose: Makes all Phase 43 additions available as public API: CalendarMulti component, DayCellState/WeekInfo types, and updated JSX definitions. This finalizes the package for external consumption.
Output: Updated index.ts with all exports and jsx.d.ts with CalendarMulti type definitions.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/calendar/src/index.ts
@packages/calendar/src/jsx.d.ts
@.planning/phases/43-calendar-display-advanced/43-07-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update package exports and element registration</name>
  <files>packages/calendar/src/index.ts</files>
  <action>
Update index.ts to include all Phase 43 additions:

1. Add CalendarMulti export:
   ```typescript
   export { CalendarMulti } from './calendar-multi.js';
   ```

2. Add CalendarView type export:
   ```typescript
   export type { CalendarView, DayCellState } from './calendar.js';
   ```

3. Add new date-utils exports:
   ```typescript
   export { getISOWeekNumber, getWeekRange, getMonthWeeks } from './date-utils.js';
   export type { WeekInfo } from './date-utils.js';
   ```

4. Add utility class exports (optional, for advanced usage):
   ```typescript
   export { GestureHandler } from './gesture-handler.js';
   export type { SwipeResult } from './gesture-handler.js';
   export { AnimationController } from './animation-controller.js';
   ```

5. Register CalendarMulti custom element (following existing pattern):
   ```typescript
   import { CalendarMulti } from './calendar-multi.js';

   if (typeof customElements !== 'undefined') {
     if (!customElements.get('lui-calendar-multi')) {
       customElements.define('lui-calendar-multi', CalendarMulti);
     } else if (!isServer && import.meta.env?.DEV) {
       console.warn(
         '[lui-calendar-multi] Custom element already registered.'
       );
     }
   }
   ```

6. Add global type registration:
   ```typescript
   declare global {
     interface HTMLElementTagNameMap {
       'lui-calendar-multi': CalendarMulti;
     }
   }
   ```
  </action>
  <verify>
`npx tsc --noEmit -p packages/calendar/tsconfig.json` compiles.
  </verify>
  <done>
CalendarMulti exported and registered. All new types and utilities available from package.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update JSX type definitions</name>
  <files>packages/calendar/src/jsx.d.ts</files>
  <action>
Read the existing jsx.d.ts to understand the current structure, then add CalendarMulti JSX types.

Add a `lui-calendar-multi` entry to the JSX intrinsic elements interface matching the existing lui-calendar pattern:

1. Add CalendarMulti attributes:
   - `months?: number;` (2 or 3)
   - `locale?: string;`
   - `value?: string;`
   - `'min-date'?: string;`
   - `'max-date'?: string;`
   - `'disabled-dates'?: string[];`
   - `'disable-weekends'?: boolean;`
   - `'show-week-numbers'?: boolean;`
   - `size?: string;`

2. Add new lui-calendar attributes to existing definition:
   - `'display-month'?: string;`
   - `'hide-navigation'?: boolean;`
   - `'show-week-numbers'?: boolean;`
   - `renderDay?: (state: any) => unknown;` (DayCellState)

3. Add event handler types for new events:
   - `'onui-week-select'?: (e: CustomEvent) => void;`

Follow the existing JSX type pattern exactly.
  </action>
  <verify>
`npx tsc --noEmit -p packages/calendar/tsconfig.json` compiles.
`pnpm --filter @lit-ui/calendar build` succeeds.
  </verify>
  <done>
JSX types include lui-calendar-multi and updated lui-calendar with new Phase 43 attributes.
  </done>
</task>

</tasks>

<verification>
- TypeScript compiles: `npx tsc --noEmit -p packages/calendar/tsconfig.json`
- Full build passes: `pnpm --filter @lit-ui/calendar build`
- CalendarMulti exported from package index
- lui-calendar-multi custom element registered
- JSX types include lui-calendar-multi
- New utility exports available (DayCellState, WeekInfo, etc.)
</verification>

<success_criteria>
Calendar package exports all Phase 43 additions. Both custom elements registered. JSX types complete. Package builds successfully.
</success_criteria>

<output>
After completion, create `.planning/phases/43-calendar-display-advanced/43-08-SUMMARY.md`
</output>

---
phase: 43-calendar-display-advanced
plan: 08
type: execute
wave: 6
depends_on: ["43-06", "43-07"]
files_modified:
  - packages/calendar/src/index.ts
  - packages/calendar/src/jsx.d.ts
autonomous: true

must_haves:
  truths:
    - "index.ts exports CalendarMulti, GestureHandler, AnimationController, DayCellState, WeekInfo, and all new date utilities"
    - "lui-calendar-multi custom element is registered with collision detection"
    - "JSX types include lui-calendar-multi with its properties and event handlers"
    - "JSX types include new Calendar properties (show-week-numbers, display-month, hide-navigation)"
    - "JSX types include event handler types for ui-week-select event"
  artifacts:
    - path: "packages/calendar/src/index.ts"
      provides: "Package entry with all Phase 43 exports and element registration"
      contains: "CalendarMulti"
      exports: ["Calendar", "CalendarMulti", "GestureHandler", "AnimationController", "DayCellState", "WeekInfo"]
    - path: "packages/calendar/src/jsx.d.ts"
      provides: "JSX type declarations for lui-calendar and lui-calendar-multi"
      contains: "lui-calendar-multi"
  key_links:
    - from: "packages/calendar/src/index.ts"
      to: "packages/calendar/src/calendar-multi.ts"
      via: "export CalendarMulti and customElements.define"
      pattern: "lui-calendar-multi"
    - from: "packages/calendar/src/index.ts"
      to: "packages/calendar/src/gesture-handler.ts"
      via: "export GestureHandler"
      pattern: "export.*GestureHandler"
    - from: "packages/calendar/src/index.ts"
      to: "packages/calendar/src/animation-controller.ts"
      via: "export AnimationController"
      pattern: "export.*AnimationController"
---

<objective>
Update package exports (index.ts) and JSX type declarations (jsx.d.ts) to include all Phase 43 additions: CalendarMulti component, utility classes, new types, and new date utilities.

Purpose: Consumers of @lit-ui/calendar need access to all new exports via the package entry point. Framework integrations (React, Vue, Svelte) need JSX types for the new lui-calendar-multi element and updated lui-calendar attributes.
Output: Complete package exports and JSX types for all Phase 43 features.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-calendar-display-advanced/43-RESEARCH.md
@.planning/phases/43-calendar-display-advanced/43-06-SUMMARY.md

Reference patterns from:
@packages/calendar/src/index.ts (existing exports)
@packages/calendar/src/jsx.d.ts (existing JSX types)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update index.ts with all Phase 43 exports and CalendarMulti registration</name>
  <files>packages/calendar/src/index.ts</files>
  <action>
    Update packages/calendar/src/index.ts to add all new exports:

    1. Add CalendarMulti export:
       `export { CalendarMulti } from './calendar-multi.js';`

    2. Add DayCellState type export from calendar.ts:
       `export type { DayCellState } from './calendar.js';`
       (Add to existing Calendar export line or as separate export)

    3. Add utility class exports (advanced-usage public API per decision):
       `export { GestureHandler } from './gesture-handler.js';`
       `export { AnimationController } from './animation-controller.js';`

    4. Add new date utility exports:
       Add `getISOWeekNumber, getISOWeekDates, getMonthWeeks` to the existing date-utils re-export block.
       Add `export type { WeekInfo } from './date-utils.js';`

    5. Add getWeekdayLongNames to the intl-utils re-export (was missing):
       `export { getFirstDayOfWeek, getWeekdayNames, getWeekdayLongNames, getMonthNames } from './intl-utils.js';`

    6. Register lui-calendar-multi custom element:
       ```typescript
       import { CalendarMulti } from './calendar-multi.js';

       if (typeof customElements !== 'undefined') {
         if (!customElements.get('lui-calendar-multi')) {
           customElements.define('lui-calendar-multi', CalendarMulti);
         } else if (!isServer && import.meta.env?.DEV) {
           console.warn(
             '[lui-calendar-multi] Custom element already registered. ' +
               'This may indicate duplicate imports or version conflicts.'
           );
         }
       }
       ```

    7. Add CalendarMulti to global HTMLElementTagNameMap:
       ```typescript
       declare global {
         interface HTMLElementTagNameMap {
           'lui-calendar': Calendar;
           'lui-calendar-multi': CalendarMulti;
         }
       }
       ```

    Keep existing exports unchanged. The full export list should include:
    - Calendar, CalendarMulti (components)
    - DateConstraints, DayCellState, WeekInfo, NavigationDirection (types)
    - KeyboardNavigationManager, GestureHandler, AnimationController (utility classes)
    - All date-utils functions (existing + new ISO week functions)
    - All intl-utils functions
    - TailwindElement, isServer (re-exports from core)
  </action>
  <verify>
    - `grep "CalendarMulti" packages/calendar/src/index.ts` shows export and registration
    - `grep "GestureHandler" packages/calendar/src/index.ts` shows export
    - `grep "AnimationController" packages/calendar/src/index.ts` shows export
    - `grep "DayCellState" packages/calendar/src/index.ts` shows type export
    - `grep "WeekInfo" packages/calendar/src/index.ts` shows type export
    - `grep "getISOWeekNumber" packages/calendar/src/index.ts` shows function export
    - `grep "lui-calendar-multi" packages/calendar/src/index.ts` shows element registration
  </verify>
  <done>index.ts exports all Phase 43 additions and registers lui-calendar-multi custom element</done>
</task>

<task type="auto">
  <name>Task 2: Update JSX types for lui-calendar-multi and new Calendar attributes</name>
  <files>packages/calendar/src/jsx.d.ts</files>
  <action>
    Update packages/calendar/src/jsx.d.ts:

    1. Add import for CalendarMulti:
       `import type { CalendarMulti } from './calendar-multi.js';`

    2. Update LuiCalendarAttributes to include new Phase 43 properties:
       ```typescript
       interface LuiCalendarAttributes {
         value?: string;
         locale?: string;
         'min-date'?: string;
         'max-date'?: string;
         'first-day-of-week'?: number;
         'show-week-numbers'?: boolean;
         'display-month'?: string;
         'hide-navigation'?: boolean;
       }
       ```

    3. Update LuiCalendarEvents to include week-select:
       ```typescript
       interface LuiCalendarEvents {
         onchange?: (e: CustomEvent<{ date: Date; isoString: string }>) => void;
         'onmonth-change'?: (e: CustomEvent<{ year: number; month: number }>) => void;
         'onweek-select'?: (e: CustomEvent<{ weekNumber: number; dates: Date[]; isoStrings: string[] }>) => void;
       }
       ```

    4. Add LuiCalendarMultiAttributes interface:
       ```typescript
       interface LuiCalendarMultiAttributes {
         months?: number;
         value?: string;
         locale?: string;
         'min-date'?: string;
         'max-date'?: string;
         'first-day-of-week'?: number;
         'show-week-numbers'?: boolean;
       }
       ```

    5. Add LuiCalendarMultiEvents:
       ```typescript
       interface LuiCalendarMultiEvents {
         onchange?: (e: CustomEvent<{ date: Date; isoString: string }>) => void;
         'onmonth-change'?: (e: CustomEvent<{ year: number; month: number }>) => void;
         'onweek-select'?: (e: CustomEvent<{ weekNumber: number; dates: Date[]; isoStrings: string[] }>) => void;
       }
       ```

    6. Add lui-calendar-multi to React JSX IntrinsicElements:
       ```typescript
       'lui-calendar-multi': React.DetailedHTMLProps<
         React.HTMLAttributes<CalendarMulti> & LuiCalendarMultiAttributes & LuiCalendarMultiEvents,
         CalendarMulti
       >;
       ```

    7. Add lui-calendar-multi to Vue GlobalComponents:
       ```typescript
       'lui-calendar-multi': import('vue').DefineComponent<LuiCalendarMultiAttributes>;
       ```

    8. Add lui-calendar-multi to Svelte IntrinsicElements:
       ```typescript
       'lui-calendar-multi': LuiCalendarMultiAttributes & {
         'on:change'?: (e: CustomEvent<{ date: Date; isoString: string }>) => void;
         'on:month-change'?: (e: CustomEvent<{ year: number; month: number }>) => void;
         'on:week-select'?: (e: CustomEvent<{ weekNumber: number; dates: Date[]; isoStrings: string[] }>) => void;
       };
       ```

    9. Update Svelte lui-calendar entry to include new events:
       Add `'on:week-select'` event handler to existing Svelte lui-calendar declaration.

    10. Build and verify: `pnpm --filter @lit-ui/calendar build`
  </action>
  <verify>
    - `grep "lui-calendar-multi" packages/calendar/src/jsx.d.ts` shows all framework declarations
    - `grep "show-week-numbers" packages/calendar/src/jsx.d.ts` shows new attribute
    - `grep "display-month" packages/calendar/src/jsx.d.ts` shows new attribute
    - `grep "week-select" packages/calendar/src/jsx.d.ts` shows new event
    - `grep "CalendarMulti" packages/calendar/src/jsx.d.ts` shows type import
    - `pnpm --filter @lit-ui/calendar build` succeeds
  </verify>
  <done>JSX types complete for lui-calendar (updated) and lui-calendar-multi (new) across React, Vue, and Svelte</done>
</task>

</tasks>

<verification>
- `pnpm --filter @lit-ui/calendar build` completes without TypeScript errors
- index.ts exports: Calendar, CalendarMulti, GestureHandler, AnimationController, KeyboardNavigationManager, all date-utils, all intl-utils, all types
- Both lui-calendar and lui-calendar-multi are registered as custom elements
- jsx.d.ts has complete type declarations for both elements across React, Vue, Svelte
- New attributes (show-week-numbers, display-month, hide-navigation) are in JSX types
- New events (week-select) are in JSX types
</verification>

<success_criteria>
1. All Phase 43 classes and types are exported from index.ts
2. lui-calendar-multi is registered as a custom element
3. JSX types include all new Calendar attributes and events
4. JSX types include complete lui-calendar-multi declarations
5. All three frameworks (React, Vue, Svelte) have proper type support
6. Package builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/43-calendar-display-advanced/43-08-SUMMARY.md`
</output>

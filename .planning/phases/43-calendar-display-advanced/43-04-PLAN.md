---
phase: 43-calendar-display-advanced
plan: 04
type: execute
wave: 2
depends_on: ["43-01"]
files_modified:
  - packages/calendar/src/calendar.ts
autonomous: true

must_haves:
  truths:
    - "User can click month/year heading to enter decade view"
    - "Decade view shows 4x3 grid of 12 years (decade + 1 before/after)"
    - "User can click year heading in decade view to enter century view"
    - "Century view shows 4x3 grid of 12 decades"
    - "Selecting a year in decade view returns to month view at that year"
    - "Selecting a decade in century view returns to decade view at that decade"
    - "Arrow key navigation works in decade/century views (4-column grid)"
  artifacts:
    - path: "packages/calendar/src/calendar.ts"
      provides: "CalendarView type and decade/century view rendering"
      contains: "CalendarView"
  key_links:
    - from: "packages/calendar/src/calendar.ts"
      to: "packages/calendar/src/keyboard-nav.ts"
      via: "KeyboardNavigationManager with columns=4"
      pattern: "new KeyboardNavigationManager.*4"
---

<objective>
Add decade and century views to the Calendar component.

Purpose: Users need fast navigation to distant dates (CAL-21, CAL-22). Clicking the month/year heading drills into decade view (year grid), clicking again drills into century view (decade grid). This enables quick year selection for birth dates, historical dates, etc.
Output: Calendar component with three views (month, year, decade) and view switching logic.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/calendar/src/calendar.ts
@packages/calendar/src/keyboard-nav.ts
@.planning/phases/43-calendar-display-advanced/43-RESEARCH.md
@.planning/phases/43-calendar-display-advanced/43-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CalendarView type and view state</name>
  <files>packages/calendar/src/calendar.ts</files>
  <action>
Add view switching support to Calendar:

1. Add type: `export type CalendarView = 'month' | 'year' | 'decade';`
2. Add `@state() private view: CalendarView = 'month';` state property
3. Make the month/year heading (`h2`) clickable:
   - In month view: clicking heading switches to `view = 'year'` (decade view)
   - In year view: clicking heading switches to `view = 'decade'` (century view)
   - In decade view: heading is not clickable
   - Add `cursor: pointer` style and `role="button"` to clickable headings
4. Update the `render()` method to switch between views:
   ```typescript
   override render() {
     switch (this.view) {
       case 'year': return this.renderDecadeView();
       case 'decade': return this.renderCenturyView();
       default: return this.renderMonthView();
     }
   }
   ```
5. Move existing render() content into a new `private renderMonthView()` method

Do NOT add the decade/century view render methods yet (Task 2 handles that).
  </action>
  <verify>
`npx tsc --noEmit -p packages/calendar/tsconfig.json` compiles.
Calendar still renders month view by default.
  </verify>
  <done>
CalendarView type added. View state controls which view renders. Month/year heading is clickable to drill into decade/century views.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement decade and century view rendering</name>
  <files>packages/calendar/src/calendar.ts</files>
  <action>
Add decade and century view render methods:

1. `private renderDecadeView()`:
   - Calculate start year: `Math.floor(currentMonth.getFullYear() / 10) * 10`
   - Generate 12 years: startYear-1 through startYear+10 (decade + 1 before/after)
   - Render header with prev/next decade buttons (navigate by 10 years) and heading showing "startYear - startYear+9"
   - Heading is clickable -> switches to `view = 'decade'` (century view)
   - Render 4x3 grid with `role="grid"` and `aria-label="Year selection"`
   - Each cell is `role="gridcell"` with `aria-selected` for current year
   - Years outside the decade (before/after) get `outside-range` class and lower opacity
   - Click handler: `selectYear(year)` sets `currentMonth` to Jan 1 of that year and `view = 'month'`
   - Add keyboard handler for decade grid: create a separate KeyboardNavigationManager with `columns=4`
   - Set `aria-live="polite"` on heading for screen reader announcements

2. `private renderCenturyView()`:
   - Calculate start decade: `Math.floor(currentMonth.getFullYear() / 100) * 100`
   - Generate 12 decades: startDecade-10 through startDecade+100 (century + 1 before/after)
   - Render header with prev/next century buttons (navigate by 100 years)
   - Heading shows "startDecade - startDecade+99"
   - Render 4x3 grid with `role="grid"` and `aria-label="Decade selection"`
   - Each cell shows decade range (e.g., "2020s" or "2020-2029")
   - Click handler: `selectDecade(decade)` sets year focus and `view = 'year'`
   - Same keyboard navigation pattern with `columns=4`

3. Add CSS for decade/century grids in static styles:
   ```css
   .year-grid, .decade-grid {
     display: grid;
     grid-template-columns: repeat(4, 1fr);
     gap: var(--ui-calendar-gap, 0.25rem);
   }
   .year-grid [role="gridcell"], .decade-grid [role="gridcell"] {
     display: flex;
     align-items: center;
     justify-content: center;
     min-height: 3rem;
     cursor: pointer;
     border-radius: var(--ui-calendar-cell-radius, 0.375rem);
     transition: background-color 150ms;
   }
   ```
   Include hover, selected, outside-range, focus-visible, and dark mode styles following existing calendar patterns.

4. Add `handleDecadeKeyDown` and `handleCenturyKeyDown` methods that use KeyboardNavigationManager with 4 columns.

5. Add navigation helpers: `handlePreviousDecade()`, `handleNextDecade()`, `handlePreviousCentury()`, `handleNextCentury()`.

6. Add announceViewChange() to announce view changes to screen readers via liveAnnouncement.
  </action>
  <verify>
`npx tsc --noEmit -p packages/calendar/tsconfig.json` compiles.
`pnpm --filter @lit-ui/calendar build` succeeds.
  </verify>
  <done>
Decade view shows 4x3 year grid with keyboard navigation. Century view shows 4x3 decade grid. View transitions work: month heading -> decade view -> century view, and back via selection.
  </done>
</task>

</tasks>

<verification>
- TypeScript compiles: `npx tsc --noEmit -p packages/calendar/tsconfig.json`
- Build passes: `pnpm --filter @lit-ui/calendar build`
- CalendarView type exported
- Decade view renders 12 years in 4x3 grid
- Century view renders 12 decades in 4x3 grid
- Keyboard navigation works with 4 columns in both views
- Screen reader announcements for view changes
- Dark mode styles for decade/century views
</verification>

<success_criteria>
User can navigate to distant dates by clicking month/year heading to enter decade view, then century view. Selecting a year/decade returns to month view. All views have keyboard navigation and screen reader support.
</success_criteria>

<output>
After completion, create `.planning/phases/43-calendar-display-advanced/43-04-SUMMARY.md`
</output>

---
phase: 22-cli-theme-integration
plan: 03
type: execute
wave: 2
depends_on: ["22-01"]
files_modified:
  - packages/cli/src/commands/theme.ts
  - packages/cli/src/index.ts
autonomous: true

must_haves:
  truths:
    - "lit-ui theme command exists as subcommand"
    - "Theme command accepts encoded config as positional argument"
    - "Theme command applies theme using shared utility"
  artifacts:
    - path: "packages/cli/src/commands/theme.ts"
      provides: "Standalone theme command"
      exports: ["theme"]
    - path: "packages/cli/src/index.ts"
      provides: "CLI main with theme subcommand"
      contains: "theme"
  key_links:
    - from: "packages/cli/src/commands/theme.ts"
      to: "packages/cli/src/utils/apply-theme.ts"
      via: "import applyTheme"
      pattern: "applyTheme"
    - from: "packages/cli/src/index.ts"
      to: "packages/cli/src/commands/theme.ts"
      via: "import theme"
      pattern: "import.*theme"
---

<objective>
Create a standalone theme command for applying/updating themes after initial project setup.

Purpose: Users who initialized without a theme or want to change their theme can do so with a dedicated command.

Output: New theme.ts command file and updated CLI main to register the subcommand.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-cli-theme-integration/22-CONTEXT.md
@.planning/phases/22-cli-theme-integration/22-01-SUMMARY.md
@packages/cli/src/commands/init.ts
@packages/cli/src/index.ts
@packages/cli/src/utils/apply-theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create theme command</name>
  <files>packages/cli/src/commands/theme.ts</files>
  <action>
Create `theme.ts` with the theme command definition:

```typescript
import { defineCommand } from 'citty';
import { resolve } from 'pathe';
import { applyTheme } from '../utils/apply-theme';
import { highlight } from '../utils/logger';

export const theme = defineCommand({
  meta: {
    name: 'theme',
    description: 'Apply a theme configuration to your project',
  },
  args: {
    config: {
      type: 'positional',
      description: 'Encoded theme configuration from configurator',
      required: true,
    },
    cwd: {
      type: 'string',
      description: 'Working directory',
      default: '.',
    },
    yes: {
      type: 'boolean',
      alias: 'y',
      description: 'Skip confirmation prompts',
      default: false,
    },
  },
  async run({ args }) {
    const cwd = resolve(args.cwd);

    console.log('');
    console.log(highlight('lit-ui theme'));
    console.log('');

    await applyTheme(cwd, args.config, { yes: args.yes });
  },
});
```

Key features:
- Positional `config` argument is required (the encoded theme string)
- Optional `cwd` for specifying working directory
- Optional `yes` flag to skip confirmation prompts
- Simple structure - delegates to shared applyTheme utility
  </action>
  <verify>TypeScript compiles: `cd packages/cli && pnpm tsc --noEmit`</verify>
  <done>Theme command exists with positional config argument and delegates to applyTheme</done>
</task>

<task type="auto">
  <name>Task 2: Register theme command in CLI main</name>
  <files>packages/cli/src/index.ts</files>
  <action>
Modify `index.ts` to import and register the theme command:

1. Add import statement after existing command imports:
   ```typescript
   import { theme } from './commands/theme';
   ```

2. Add `theme` to the subCommands object:
   ```typescript
   subCommands: {
     init,
     add,
     list,
     migrate,
     theme,  // Add this line
   },
   ```

Keep alphabetical order is not required - just add after migrate.
  </action>
  <verify>TypeScript compiles: `cd packages/cli && pnpm tsc --noEmit`</verify>
  <done>CLI main registers theme as a subcommand</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `cd packages/cli && pnpm tsc --noEmit` succeeds
2. `cd packages/cli && pnpm build` succeeds
3. Manual verification: `cd packages/cli && node dist/index.js theme --help` shows command usage
4. Manual verification: `cd packages/cli && node dist/index.js --help` lists theme subcommand
</verification>

<success_criteria>
- Theme command file exists at packages/cli/src/commands/theme.ts
- Command accepts positional config argument
- Command is registered in CLI main
- Running `lit-ui theme` shows help with usage information
</success_criteria>

<output>
After completion, create `.planning/phases/22-cli-theme-integration/22-03-SUMMARY.md`
</output>

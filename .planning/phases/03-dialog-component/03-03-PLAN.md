---
phase: 03-dialog-component
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/dialog/dialog.ts
  - src/styles/tailwind.css
autonomous: true

must_haves:
  truths:
    - "Dialog has enter animation (fade + scale) when opening"
    - "Dialog has exit animation when closing"
    - "Backdrop fades in/out with dialog"
    - "Animations are disabled when user prefers reduced motion"
    - "Body scroll is locked when dialog is open"
  artifacts:
    - path: "src/components/dialog/dialog.ts"
      provides: "CSS animations in static styles"
      contains: "@starting-style"
    - path: "src/styles/tailwind.css"
      provides: "Body scroll lock rule"
      contains: "dialog[open]"
  key_links:
    - from: "src/styles/tailwind.css"
      to: "body scroll"
      via: "CSS :has() selector"
      pattern: "body:has\\(.*dialog\\[open\\]\\)"
---

<objective>
Add enter/exit animations with reduced-motion support and body scroll locking to the dialog component.

Purpose: Provide polished visual feedback for dialog state changes while respecting user accessibility preferences and preventing background scroll.

Output: Dialog with smooth CSS animations, reduced-motion fallback, and automatic body scroll lock.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-dialog-component/03-RESEARCH.md
@.planning/phases/03-dialog-component/03-01-SUMMARY.md
@src/components/dialog/dialog.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add enter/exit animations with reduced-motion support</name>
  <files>src/components/dialog/dialog.ts</files>
  <action>
Add CSS animations to dialog component's static styles following RESEARCH.md Pattern 4:

1. **Base dialog animation styles:**
   ```css
   dialog {
     opacity: 0;
     transform: scale(0.95);
     transition:
       opacity 150ms ease-out,
       transform 150ms ease-out,
       display 150ms allow-discrete,
       overlay 150ms allow-discrete;
   }

   dialog[open] {
     opacity: 1;
     transform: scale(1);
   }

   /* Entry animation starting point - modern browsers */
   @starting-style {
     dialog[open] {
       opacity: 0;
       transform: scale(0.95);
     }
   }
   ```

2. **Backdrop animations:**
   ```css
   dialog::backdrop {
     background: rgba(0, 0, 0, 0.5);
     opacity: 0;
     transition:
       opacity 150ms ease-out,
       display 150ms allow-discrete,
       overlay 150ms allow-discrete;
   }

   dialog[open]::backdrop {
     opacity: 1;
   }

   @starting-style {
     dialog[open]::backdrop {
       opacity: 0;
     }
   }
   ```

3. **Reduced motion support:**
   ```css
   @media (prefers-reduced-motion: reduce) {
     dialog,
     dialog::backdrop {
       transition: none;
     }
   }
   ```

4. **Dialog content styling with Tailwind classes:**
   ```css
   .dialog-content {
     /* Apply via Tailwind classes in render: */
     /* bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 */
   }
   ```

5. **Ensure dialog has proper positioning:**
   ```css
   dialog {
     border: none;
     border-radius: 0.5rem;
     max-height: 85vh;
     overflow: auto;
   }
   ```

Use Lit's `css` template literal for static styles property.
  </action>
  <verify>
Dialog opens with fade+scale animation, closes with reverse animation.
Check: `@starting-style` block exists in styles.
Check: `@media (prefers-reduced-motion)` disables transitions.
  </verify>
  <done>
Dialog has smooth enter/exit animations that respect prefers-reduced-motion.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add body scroll lock via CSS</name>
  <files>src/styles/tailwind.css</files>
  <action>
Add body scroll lock rule to global Tailwind CSS following RESEARCH.md Pattern 5:

1. **Add scroll lock rule:**
   ```css
   /* Dialog scroll lock - prevents background scrolling when dialog is open */
   body:has(dialog[open]) {
     overflow: hidden;
   }
   ```

2. **Add scrollbar stability rule** (if not already present):
   ```css
   /* Prevent layout shift when scrollbar appears/disappears */
   html {
     scrollbar-gutter: stable;
   }
   ```

Place these rules in a logical location in tailwind.css - after the @theme block or in a custom utilities section.

Note: This uses CSS :has() which has excellent browser support (Baseline 2023). The dialog[open] selector works because native dialog sets the `open` attribute.
  </action>
  <verify>
Check `src/styles/tailwind.css` contains:
- `body:has(dialog[open])` rule with `overflow: hidden`
- Rule is syntactically valid CSS
  </verify>
  <done>
Body scroll is locked when any dialog is open via pure CSS.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Dialog opens with scale+fade animation (0.95 -> 1, 0 -> 1 opacity)
3. Dialog closes with reverse animation
4. Backdrop fades in/out
5. With `prefers-reduced-motion: reduce`, no animations occur
6. Body cannot scroll when dialog is open
7. CSS :has() rule present in tailwind.css
</verification>

<success_criteria>
- Dialog has CSS transitions for opacity and transform
- @starting-style provides entry animation
- transition-behavior: allow-discrete enables exit animation
- ::backdrop has matching fade animation
- @media (prefers-reduced-motion) disables all transitions
- Body scroll locked via CSS :has(dialog[open])
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/03-dialog-component/03-03-SUMMARY.md`
</output>

---
phase: 42-calendar-display-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/calendar/package.json
  - packages/calendar/src/calendar.ts
  - packages/calendar/src/date-utils.ts
  - packages/calendar/src/intl-utils.ts
  - packages/calendar/src/index.ts
autonomous: true

must_haves:
  truths:
    - "User sees a 7-column month grid with weekday headers when viewing calendar"
    - "Weekday headers display localized abbreviations (e.g., Mon, Tue, Wed)"
    - "Calendar displays all days of the current month in grid cells"
    - "Component renders without errors in browser and SSR context"
  artifacts:
    - path: "packages/calendar/src/calendar.ts"
      provides: "Main calendar web component"
      min_lines: 150
      exports: ["Calendar"]
    - path: "packages/calendar/src/date-utils.ts"
      provides: "Date calculation utilities using date-fns"
      min_lines: 50
      exports: ["getMonthDays", "startOfMonth", "endOfMonth"]
    - path: "packages/calendar/src/intl-utils.ts"
      provides: "Locale-aware formatting utilities"
      min_lines: 40
      exports: ["getWeekdayNames", "getMonthName"]
    - path: "packages/calendar/package.json"
      provides: "Package configuration with date-fns dependency"
      contains: "date-fns"
  key_links:
    - from: "packages/calendar/src/calendar.ts"
      to: "date-fns"
      via: "ES module imports"
      pattern: "from 'date-fns'"
    - from: "packages/calendar/src/calendar.ts"
      to: "packages/calendar/src/date-utils.ts"
      via: "ES module import"
      pattern: "from './date-utils'"
    - from: "packages/calendar/src/calendar.ts"
      to: "packages/calendar/src/intl-utils.ts"
      via: "ES module import"
      pattern: "from './intl-utils'"
---

<objective>
Create calendar package with 7-column grid layout and localized weekday headers. This establishes the visual foundation for the calendar component.

Purpose: Grid structure is the visual core of all calendar features. Users need to see dates arranged in a familiar month grid.

Output: Working calendar component that displays current month with weekday headers, using date-fns for date math and Intl API for localization.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/42-calendar-display-foundation/42-RESEARCH.md
@/Users/sn0w/Documents/dev/lit-components/packages/core/src/tailwind-element.ts
@/Users/sn0w/Documents/dev/lit-components/packages/button/src/button.ts
</context>

<tasks>

<task type="auto">
  <name>Create calendar package structure and dependencies</name>
  <files>packages/calendar/package.json</files>
  <action>
    Create packages/calendar/ directory with package.json:

    1. Copy structure from packages/button/package.json as template
    2. Update name to "@lit-ui/calendar"
    3. Add date-fns@^4.1.0 to peerDependencies and devDependencies
    4. Update description to "Accessible calendar component built with Lit, date-fns, and Tailwind CSS"
    5. Ensure peerDependencies: lit ^3.0.0, @lit-ui/core ^1.0.0

    Do NOT create tsconfig.json, vite.config.ts, or test/ directory yet (those come in later plans).
  </action>
  <verify>packages/calendar/package.json exists with date-fns in dependencies</verify>
  <done>Package structure exists with date-fns dependency configured</done>
</task>

<task type="auto">
  <name>Create date utility functions using date-fns</name>
  <files>packages/calendar/src/date-utils.ts</files>
  <action>
    Create packages/calendar/src/date-utils.ts with date-fns wrapper functions:

    1. Import from date-fns: startOfMonth, endOfMonth, eachDayOfInterval, format, isSameDay, isToday
    2. Export getMonthDays(date: Date): Date[] - uses eachDayOfInterval from startOfMonth to endOfMonth
    3. Export formatDate(date: Date): string - returns ISO 8601 format (YYYY-MM-DD)
    4. Export parseDate(isoString: string): Date - parses ISO 8601 string to Date
    5. Export isSameDayCompare(date1: Date, date2: Date): boolean - uses isSameDay from date-fns
    6. Export isDateToday(date: Date): boolean - uses isToday from date-fns

    Follow the pattern from research section. Use ES module syntax with named exports.
  </action>
  <verify>grep "from 'date-fns'" packages/calendar/src/date-utils.ts shows imports</verify>
  <done>date-utils.ts exports date calculation functions using date-fns</done>
</task>

<task type="auto">
  <name>Create internationalization utility functions using Intl API</name>
  <files>packages/calendar/src/intl-utils.ts</files>
  <action>
    Create packages/calendar/src/intl-utils.ts with locale-aware formatting:

    1. Export getWeekdayNames(locale: string): string[] - uses Intl.DateTimeFormat with weekday: 'short'
       - Start from Sunday (day 1) to Saturday (day 7)
       - Use base date 2023-01-01 (known Sunday) for consistent weekday generation
       - Returns array like ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]

    2. Export getMonthName(date: Date, locale: string): string - uses Intl.DateTimeFormat with month: 'long'
       - Returns full month name like "January", "February"

    3. Export getMonthYearLabel(date: Date, locale: string): string - uses Intl.DateTimeFormat with year: 'numeric', month: 'long'
       - Returns formatted string like "January 2026"

    Follow the pattern from RESEARCH.md section "Pattern 4: Intl API for Locale-Aware Calendar".
    Use Intl.DateTimeFormat - do NOT create custom locale mappings.
  </action>
  <verify>grep "Intl.DateTimeFormat" packages/calendar/src/intl-utils.ts shows API usage</verify>
  <done>intl-utils.ts exports locale-aware formatting functions using Intl API</done>
</task>

<task type="auto">
  <name>Create main Calendar component with grid layout</name>
  <files>packages/calendar/src/calendar.ts</files>
  <action>
    Create packages/calendar/src/calendar.ts as main calendar component:

    Extend TailwindElement from @lit-ui/core. Use @property decorators for reactive props:

    Properties:
    - @property({ type: String }) locale: string = 'en-US'
    - @property({ type: String }) value: string = '' (ISO 8601 format YYYY-MM-DD)
    - @state() private currentMonth: Date = new Date()

    Constructor:
    - Call super()
    - Guard client-only code with if (!isServer) { }

    Static styles:
    - Spread ...tailwindBaseStyles
    - Add :host { display: block; }
    - Add grid styles: [role="grid"] { display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.25rem; }
    - Add weekday header styles: [role="columnheader"] { text-align: center; font-weight: 600; }
    - Add cell styles: [role="gridcell"] { display: flex; align-items: center; justify-content: center; min-height: 2.5rem; }

    Private methods:
    - getMonthDays(): Date[] - calls getMonthDays from date-utils
    - getWeekdayNames(): string[] - calls getWeekdayNames from intl-utils
    - getMonthYearLabel(): string - calls getMonthYearLabel from intl-utils

    render() method:
    - Return html`<div role="grid" aria-labelledby="calendar-heading">
        <h2 id="calendar-heading">${this.getMonthYearLabel()}</h2>
        <div role="row">${this.getWeekdayNames().map(day => html`<div role="columnheader">${day}</div>`)}</div>
        ${this.getMonthDays().map(date => this.renderDayCell(date))}
      </div>`

    - renderDayCell(date: Date) - returns gridcell div with date number

    Follow button.ts pattern for component structure, SSR guards, and Lit decorators.
  </action>
  <verify>grep "TailwindElement" packages/calendar/src/calendar.ts shows base class</verify>
  <done>calendar.ts exports Calendar class with grid layout and weekday headers</done>
</task>

<task type="auto">
  <name>Create index.ts with public exports</name>
  <files>packages/calendar/src/index.ts</files>
  <action>
    Create packages/calendar/src/index.ts:

    1. Export Calendar class as default and named export
    2. Define custom element: customElements.define('lui-calendar', Calendar)
    3. Add TypeScript global interface declaration for HTMLElementTagNameMap
    4. Export types from date-utils.ts and intl-utils.ts for public API

    Follow the pattern from packages/button/src/index.ts.
  </action>
  <verify>grep "lui-calendar" packages/calendar/src/index.ts shows custom element name</verify>
  <done>index.ts exports Calendar component and registers custom element</done>
</task>

</tasks>

<verification>
After completing all tasks, verify:

1. Package structure: packages/calendar/ exists with package.json
2. date-fns dependency: package.json includes date-fns@^4.1.0
3. Source files: calendar.ts, date-utils.ts, intl-utils.ts, index.ts exist
4. Calendar component: Extends TailwindElement, has grid layout with 7 columns
5. Weekday headers: Uses Intl API for localized names
6. Month days: Uses date-fns eachDayOfInterval for date calculation
7. SSR guards: isServer checks in place for client-only code
8. Build check: Run pnpm --filter @lit-ui/calendar build to verify TypeScript compiles
</verification>

<success_criteria>
1. Calendar component renders in browser with 7-column grid
2. Weekday headers display localized names (e.g., "Sun Mon Tue..." for en-US)
3. Current month days display correctly in grid cells
4. Component has no TypeScript errors
5. Component builds successfully with vite
</success_criteria>

<output>
After completion, create `.planning/phases/42-calendar-display-foundation/42-01-SUMMARY.md`
</output>

---
phase: 79-date-picker
plan: 03
type: execute
wave: 2
depends_on:
  - 79-01
files_modified:
  - skill/skills/date-picker/SKILL.md
autonomous: true
requirements:
  - DTP-03

must_haves:
  truths:
    - "Date Picker SKILL.md CSS token table expanded from 12 to 21 entries matching tailwind.css :root"
    - "All token defaults use double-fallback var() form matching tailwind.css :root"
    - "Behavior Notes section added covering popup, focus, inline, form integration, natural language, presets, and dark mode behavior"
  artifacts:
    - path: "skill/skills/date-picker/SKILL.md"
      provides: "Complete SKILL.md with 21 CSS tokens, 1 event, and Behavior Notes"
      min_lines: 80
  key_links:
    - from: "skill/skills/date-picker/SKILL.md"
      to: "packages/core/src/styles/tailwind.css"
      via: "CSS token defaults matching :root declarations exactly"
      pattern: "var\\(--color-background|var\\(--color-foreground|var\\(--color-border"
---

<objective>
Expand the CSS Custom Properties table in `skill/skills/date-picker/SKILL.md` from 12 entries to 21 entries matching the tailwind.css :root block. Update all defaults to double-fallback var() form. Add a Behavior Notes section covering key date-picker behaviors (popup, focus trap, inline mode, form integration, natural language, presets, dark mode).

Purpose: The current SKILL.md has 12 CSS tokens with stale hardcoded hex defaults and is missing 9 tokens. It also lacks a Behavior Notes section, which has been established as the standard pattern in phases 70-03 through 78-03. The skill file is consumed by Claude agents; accuracy directly affects code generation quality.

Output: `skill/skills/date-picker/SKILL.md` — CSS token table expanded to 21 entries with correct defaults; Behavior Notes section added
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/78-calendar/78-03-SUMMARY.md

<interfaces>
<!-- Current SKILL.md CSS Custom Properties section (12 entries, stale defaults): -->
```markdown
## CSS Custom Properties

| Property | Default | Description |
|----------|---------|-------------|
| `--ui-date-picker-text` | `inherit` | Text color for the label and input. |
| `--ui-date-picker-bg` | `white` | Background color for the input container. |
| `--ui-date-picker-border` | `#d1d5db` | Border color for the input container. |
| `--ui-date-picker-border-focus` | `#3b82f6` | Border color when the input is focused. |
| `--ui-date-picker-radius` | `0.375rem` | Border radius for the input container. |
| `--ui-date-picker-border-width` | `1px` | Border width for the input container. |
| `--ui-date-picker-placeholder` | `#9ca3af` | Placeholder text color. |
| `--ui-date-picker-error` | `#ef4444` | Error text and border color. |
| `--ui-date-picker-popup-bg` | `white` | Background color for the calendar popup. |
| `--ui-date-picker-popup-border` | `#e5e7eb` | Border color for the calendar popup. |
| `--ui-date-picker-preset-bg` | `#f9fafb` | Background color for preset buttons. |
| `--ui-date-picker-preset-border` | `#d1d5db` | Border color for preset buttons. |
```

<!-- Target: tailwind.css :root date-picker block (21 tokens): -->
```css
  --ui-date-picker-bg: var(--color-background, white);
  --ui-date-picker-text: var(--color-foreground, var(--ui-color-foreground));
  --ui-date-picker-border: var(--color-border, var(--ui-color-border));
  --ui-date-picker-placeholder: var(--color-muted-foreground, var(--ui-color-muted-foreground));
  --ui-date-picker-label-text: var(--color-foreground, var(--ui-color-foreground));
  --ui-date-picker-error: var(--color-destructive, var(--ui-color-destructive));
  --ui-date-picker-ring: var(--color-ring, var(--ui-color-ring));
  --ui-date-picker-popup-bg: var(--color-card, var(--ui-color-card));
  --ui-date-picker-popup-border: var(--color-border, var(--ui-color-border));
  --ui-date-picker-popup-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.08);
  --ui-date-picker-hover-bg: var(--color-muted, var(--ui-color-muted));
  --ui-date-picker-disabled-bg: var(--color-muted, var(--ui-color-muted));
  --ui-date-picker-disabled-border: var(--color-border, var(--ui-color-border));
  --ui-date-picker-helper-text: var(--color-muted-foreground, var(--ui-color-muted-foreground));
  --ui-date-picker-action-text: var(--color-muted-foreground, var(--ui-color-muted-foreground));
  --ui-date-picker-preset-bg: var(--color-background, white);
  --ui-date-picker-preset-text: var(--color-foreground, var(--ui-color-foreground));
  --ui-date-picker-preset-border: var(--color-border, var(--ui-color-border));
  --ui-date-picker-preset-hover-bg: var(--color-muted, var(--ui-color-muted));
  --ui-date-picker-preset-hover-border: var(--color-muted-foreground, var(--ui-color-muted-foreground));
  --ui-date-picker-z-index: 40;
```

<!-- Event detail shape (from date-picker.ts dispatchCustomEvent calls): -->
```ts
dispatchCustomEvent(this, 'change', {
  date: parsed,       // Date | null
  isoString: this.value,  // string (ISO 8601, or '' when cleared)
});
```
The event name is 'change' (not 'ui-change' — unlike checkbox/switch which use 'ui-change',
date-picker uses 'change' matching the source). Detail: { date: Date | null, isoString: string }.

<!-- Behavior Notes content to add (derived from date-picker.ts analysis): -->
- Popup uses Popover API (popover="manual") with Floating UI for positioning; opens below the input (bottom-start), flips to top-start if insufficient space
- Calendar popup is positioned with `strategy: fixed` via @floating-ui/dom to avoid clipping in scrollable containers
- Escape closes the popup and restores focus to the input; Tab is trapped within the popup when open
- Arrow Down on the input opens the popup; Enter on the input triggers blur/parse without opening popup
- The embedded lui-calendar inherits all calendar keyboard navigation (arrows, Home/End, PageUp/PageDown, Enter to select)
- inline mode skips the input field, popup, Floating UI, click-outside, and focus trap; renders the calendar always visible
- Form-associated via ElementInternals: submits ISO 8601 string via name attribute; reports valueMissing, badInput, rangeUnderflow, rangeOverflow validity states
- Natural language input is parsed on blur: "tomorrow", "next friday", "in 3 days", "next week"; runs before format-based parsing
- Presets appear above the calendar in the popup; pass presets=true for defaults (Today, Tomorrow, Next Week) or a custom DatePreset[] via JS
- Dark mode is governed by the semantic .dark cascade through double-fallback var() tokens; no per-component .dark overrides required
- locale prop (BCP 47) controls placeholder format, display formatting, and the embedded calendar's locale; defaults to navigator.language
- format prop (Intl.DateTimeFormatOptions, JS-only) customizes display; only affects display output, parsing still accepts any format
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand CSS tokens, verify Events table, and add Behavior Notes to SKILL.md</name>
  <files>skill/skills/date-picker/SKILL.md</files>
  <action>
Make two edits to `skill/skills/date-picker/SKILL.md`:

**Edit 1 — Replace the CSS Custom Properties section** with the full 21-token table:

Replace the entire `## CSS Custom Properties` section (currently 12 rows) with:

```markdown
## CSS Custom Properties

| Property | Default | Description |
|----------|---------|-------------|
| `--ui-date-picker-bg` | `var(--color-background, white)` | Background color for the input container. |
| `--ui-date-picker-text` | `var(--color-foreground, var(--ui-color-foreground))` | Text color for the input and label. |
| `--ui-date-picker-border` | `var(--color-border, var(--ui-color-border))` | Border color for the input container. |
| `--ui-date-picker-placeholder` | `var(--color-muted-foreground, var(--ui-color-muted-foreground))` | Placeholder text color. |
| `--ui-date-picker-label-text` | `var(--color-foreground, var(--ui-color-foreground))` | Text color for the field label. |
| `--ui-date-picker-error` | `var(--color-destructive, var(--ui-color-destructive))` | Error text and border color. |
| `--ui-date-picker-ring` | `var(--color-ring, var(--ui-color-ring))` | Focus ring color for action buttons. |
| `--ui-date-picker-popup-bg` | `var(--color-card, var(--ui-color-card))` | Background color for the calendar popup. |
| `--ui-date-picker-popup-border` | `var(--color-border, var(--ui-color-border))` | Border color for the calendar popup. |
| `--ui-date-picker-popup-shadow` | `0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.08)` | Box shadow for the calendar popup. |
| `--ui-date-picker-hover-bg` | `var(--color-muted, var(--ui-color-muted))` | Background color for hovered action buttons. |
| `--ui-date-picker-disabled-bg` | `var(--color-muted, var(--ui-color-muted))` | Background color for the input container when disabled. |
| `--ui-date-picker-disabled-border` | `var(--color-border, var(--ui-color-border))` | Border color for the input container when disabled. |
| `--ui-date-picker-helper-text` | `var(--color-muted-foreground, var(--ui-color-muted-foreground))` | Color for helper text below the input. |
| `--ui-date-picker-action-text` | `var(--color-muted-foreground, var(--ui-color-muted-foreground))` | Color for the calendar and clear icon buttons. |
| `--ui-date-picker-preset-bg` | `var(--color-background, white)` | Background color for preset buttons. |
| `--ui-date-picker-preset-text` | `var(--color-foreground, var(--ui-color-foreground))` | Text color for preset buttons. |
| `--ui-date-picker-preset-border` | `var(--color-border, var(--ui-color-border))` | Border color for preset buttons. |
| `--ui-date-picker-preset-hover-bg` | `var(--color-muted, var(--ui-color-muted))` | Background color for hovered preset buttons. |
| `--ui-date-picker-preset-hover-border` | `var(--color-muted-foreground, var(--ui-color-muted-foreground))` | Border color for hovered preset buttons. |
| `--ui-date-picker-z-index` | `40` | z-index for the calendar popup. |
```

**Edit 2 — Verify Events table and add Behavior Notes section** after the last section in the file.

First verify the Events table is correct. It should read:
```markdown
| `change` | `{ date: Date | null, isoString: string }` | Fired when a date is selected, typed, or cleared. `date` is null when cleared. |
```
The event name is `change` (not `ui-change`). The detail shape matches the source. If it already matches, leave it unchanged.

Then append a `## Behavior Notes` section at the end of the file:

```markdown
## Behavior Notes

- Popup uses Popover API (`popover="manual"`) with Floating UI for positioning; opens below the input (`bottom-start`), flips to `top-start` if insufficient space
- Popup uses `strategy: fixed` positioning to avoid clipping in scrollable containers; positioned by `@floating-ui/dom`
- Escape closes the popup and restores focus to the input; Tab is trapped within the popup when open
- Arrow Down on the input opens the popup; Enter on the input triggers blur/parse (not popup open)
- The embedded `lui-calendar` inherits all calendar keyboard navigation (arrow keys, Home/End, PageUp/PageDown, Enter/Space to select)
- `inline` mode skips the input field, popup, Floating UI, click-outside, and focus trap; renders the calendar always visible
- Form-associated via ElementInternals: submits ISO 8601 string via `name` attribute; reports `valueMissing`, `badInput`, `rangeUnderflow`, `rangeOverflow` validity states
- Natural language input parsed on blur: "tomorrow", "next friday", "in 3 days", "next week"; natural language runs before format-based parsing
- `presets` attribute shows quick-select buttons above the calendar; set to `true` for defaults (Today, Tomorrow, Next Week) or pass a custom `DatePreset[]` array via JS
- Dark mode is governed by the semantic `.dark` cascade through double-fallback `var()` tokens; no per-component `.dark` overrides required
- `locale` prop (BCP 47) controls placeholder format, display formatting, and the embedded calendar's locale; defaults to `navigator.language`
- `format` prop (`Intl.DateTimeFormatOptions`, JS-only) customizes display output only; input parsing still accepts any parseable date format
```
  </action>
  <verify>
    <automated>grep -c "ui-date-picker" /Users/sn0w/Documents/dev/lit-components/skill/skills/date-picker/SKILL.md</automated>
  </verify>
  <done>
- The CSS Custom Properties table has 21 rows (previously 12)
- All defaults use double-fallback var() form matching tailwind.css :root exactly (no stale hex values)
- Events table shows `change` with detail `{ date: Date | null, isoString: string }`
- A `## Behavior Notes` section exists at the end of the file with 12 bullet points
  </done>
</task>

</tasks>

<verification>
After task completion, verify:
1. `grep -c "ui-date-picker" skill/skills/date-picker/SKILL.md` — shows 21 token entries in CSS table
2. `grep "inherit\|#d1d5db\|#3b82f6\|#9ca3af\|#ef4444\|#e5e7eb\|#f9fafb" skill/skills/date-picker/SKILL.md` — returns no matches (stale hex values removed)
3. `grep "Behavior Notes" skill/skills/date-picker/SKILL.md` — confirms section added
4. `grep "ui-change" skill/skills/date-picker/SKILL.md` — returns no matches (event is 'change', not 'ui-change')
</verification>

<success_criteria>
- CSS token table has 21 entries with correct double-fallback var() defaults matching tailwind.css :root
- Events table correctly documents 'change' with { date: Date | null, isoString: string } detail
- Behavior Notes section added with 12 bullet points covering popup, focus, inline, form, natural language, presets, and dark mode
- No stale hardcoded hex values remain in the token table
</success_criteria>

<output>
After completion, create `.planning/phases/79-date-picker/79-03-SUMMARY.md` following the summary template.
</output>

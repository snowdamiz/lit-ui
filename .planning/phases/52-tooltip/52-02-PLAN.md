---
phase: 52-tooltip
plan: 02
type: execute
wave: 2
depends_on: ["52-01"]
files_modified:
  - packages/cli/src/registry/registry.json
  - packages/cli/src/templates/tooltip.ts
autonomous: true

must_haves:
  truths:
    - "CLI registry includes a 'tooltip' component entry with correct file paths and dependencies"
    - "A copy-source template exists for the tooltip component that can be installed via `npx lit-ui add tooltip`"
    - "The full workspace builds successfully with the new tooltip package included"
  artifacts:
    - path: "packages/cli/src/registry/registry.json"
      provides: "Tooltip component entry in CLI registry"
      contains: "tooltip"
    - path: "packages/cli/src/templates/tooltip.ts"
      provides: "Copy-source template for tooltip component"
      contains: "lui-tooltip"
  key_links:
    - from: "packages/cli/src/registry/registry.json"
      to: "packages/cli/src/templates/tooltip.ts"
      via: "registry files array references template path"
      pattern: "components/tooltip/tooltip.ts"
---

<objective>
Add the CLI registry entry and copy-source template for the tooltip component, then verify the full workspace builds successfully. This completes TIP-17 (CLI registry with copy-source template and npm package).

Purpose: Enable developers to install the tooltip component via both `npx lit-ui add tooltip` (copy-source) and `npm install @lit-ui/tooltip` (npm mode).

Output: CLI registry entry, copy-source template, and verified workspace build.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/52-tooltip/52-01-SUMMARY.md

# CLI registry conventions
@packages/cli/src/registry/registry.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CLI registry entry and copy-source template for tooltip</name>
  <files>
    packages/cli/src/registry/registry.json
    packages/cli/src/templates/tooltip.ts
  </files>
  <action>
    **registry.json:** Add a new entry to the `components` array in `packages/cli/src/registry/registry.json`:
    ```json
    {
      "name": "tooltip",
      "description": "Accessible tooltip with hover/focus triggers, Floating UI positioning, delay groups, and arrow indicators",
      "files": [
        { "path": "components/tooltip/tooltip.ts", "type": "component" },
        { "path": "components/tooltip/delay-group.ts", "type": "component" }
      ],
      "dependencies": ["@floating-ui/dom", "composed-offset-position"],
      "registryDependencies": []
    }
    ```
    Place it after the "switch" entry (alphabetical ordering is not strictly required, but keep it near the end with other newer components).

    **copy-source template:** Create `packages/cli/src/templates/tooltip.ts`. This is a self-contained, single-file version of the tooltip component for copy-source mode. Look at how existing templates are structured (e.g., `packages/cli/src/templates/switch.ts` or `packages/cli/src/templates/button.ts`). The template should:
    - Be a complete, standalone tooltip component file that imports from the user's local base (`../base/tailwind-element.js`) rather than `@lit-ui/core`
    - Include the delay group logic inline (no separate file import needed for copy-source)
    - Include all the same functionality as the npm package version
    - Import `TailwindElement` and `tailwindBaseStyles` from the user's local base path
    - Import Floating UI functions directly from `@floating-ui/dom` and `composed-offset-position` (since copy-source users don't have `@lit-ui/core/floating`)
    - Include the custom element registration at the bottom
    - Include JSX type declarations inline as a comment block or in a separate section

    Also create `packages/cli/src/templates/tooltip-delay-group.ts` as a standalone delay group module if the registry references it as a separate file. Since the registry entry lists `delay-group.ts`, create it as a separate template file.

    Verify the template file paths in registry.json match the actual template file locations by checking how the CLI resolves template paths (look at how other templates like button.ts or switch.ts are referenced).
  </action>
  <verify>
    1. `cat packages/cli/src/registry/registry.json | grep -A 10 tooltip` shows the entry
    2. `ls packages/cli/src/templates/tooltip*` shows the template files
    3. `pnpm --filter lit-ui build` succeeds (CLI package builds with new templates)
  </verify>
  <done>
    CLI registry entry exists for tooltip with correct file paths and dependencies. Copy-source template files exist and the CLI package builds successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify full workspace build and integration</name>
  <files></files>
  <action>
    Run full workspace build and verify everything integrates correctly:

    1. `pnpm install` -- ensure workspace links are correct
    2. `pnpm build` -- full workspace build (all packages)
    3. Verify `packages/tooltip/dist/` contains built output (index.js, index.d.ts, tooltip.js, tooltip.d.ts, delay-group.js, delay-group.d.ts)
    4. Verify the tooltip package correctly externalizes its peer dependencies (lit, @lit-ui/core, @lit-ui/core/floating should NOT be in the bundle)
    5. Check for any TypeScript errors: `pnpm --filter @lit-ui/tooltip exec tsc --noEmit`

    If any build errors occur, fix them. Common issues:
    - Missing workspace link (run `pnpm install` again)
    - Import path issues (ensure `.js` extensions on relative imports)
    - Type export issues (ensure `Placement` type is properly re-exported)
  </action>
  <verify>
    1. `pnpm build` succeeds with zero errors across all packages
    2. `ls packages/tooltip/dist/` shows expected output files
    3. `pnpm --filter @lit-ui/tooltip exec tsc --noEmit` passes with no type errors
  </verify>
  <done>
    Full workspace builds successfully. The @lit-ui/tooltip package is properly integrated into the monorepo. All type checks pass. CLI registry entry is in place with copy-source templates.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` -- full workspace build succeeds
2. `grep "tooltip" packages/cli/src/registry/registry.json` confirms registry entry
3. `ls packages/cli/src/templates/tooltip*` confirms template files
4. `ls packages/tooltip/dist/` confirms built output
5. `pnpm --filter @lit-ui/tooltip exec tsc --noEmit` -- no type errors
</verification>

<success_criteria>
The tooltip component is fully integrated into the LitUI ecosystem:
- CLI registry lists tooltip as an installable component
- Copy-source templates exist for `npx lit-ui add tooltip`
- Full workspace builds without errors
- TypeScript type checking passes
- TIP-17 requirement is complete
</success_criteria>

<output>
After completion, create `.planning/phases/52-tooltip/52-02-SUMMARY.md`
</output>

# Milestone v6.0: Layout Components

**Status:** ✅ SHIPPED 2026-02-02
**Phases:** 56-60
**Total Plans:** 10

## Overview

Deliver Accordion and Tabs layout components following the established parent-child container pattern from RadioGroup/CheckboxGroup. Accordion ships first as the simpler pattern (no activation modes, no indicator animation), validating CSS Grid height animation and slot discovery. Tabs builds on those patterns, adding orientation variants, activation modes, and a sliding active indicator. Integration phase bundles CLI templates, documentation, and SSR verification for both components.

## Phases

### Phase 56: Accordion Core

**Goal**: Users can expand and collapse accordion panels with full keyboard and screen reader support
**Depends on**: Nothing (first phase of milestone)
**Plans**: 2 plans

Plans:

- [x] 56-01: Package scaffold, AccordionItem element, Accordion container with single/multi-expand state management
- [x] 56-02: Keyboard navigation, ARIA attributes, disabled states, and CSS custom property theming with dark mode

**Details:**
- CSS Grid three-layer animation pattern (0fr/1fr) for smooth height animation
- Parent-child state management via internal events (ui-accordion-toggle)
- Single-expand (default) and multi-expand modes
- Controlled and uncontrolled value modes
- Roving tabindex keyboard navigation (ArrowUp/Down with wrapping, Home/End)
- Full ARIA attributes (aria-expanded, aria-controls, aria-labelledby, aria-disabled)
- 14 CSS custom property tokens for theming
- Dark mode support via .dark block
- prefers-reduced-motion support

### Phase 57: Accordion Polish & Package

**Goal**: Accordion has visual polish, SSR compatibility, and ships as a publishable @lit-ui/accordion package
**Depends on**: Phase 56
**Plans**: 2 plans

Plans:

- [x] 57-01: Chevron indicator with CSS rotation, data-state attribute reflection, lazy mounting
- [x] 57-02: SSR compatibility verification and @lit-ui/accordion package publishability audit

**Details:**
- Animated SVG chevron with CSS rotation synchronized to accordion transition
- data-state attribute reflection ("open"/"closed") on host element
- Lazy mounting with _hasBeenExpanded flag for conditional slot rendering
- Chevron exposed as ::part(chevron) for consumer styling
- isServer guards for SSR-safe data-state setAttribute calls
- Package build: 10.71 KB (gzip: 3.40 KB)

### Phase 58: Tabs Core

**Goal**: Users can switch between tab panels with full keyboard, screen reader, and orientation support
**Depends on**: Phase 56 (reuses parent-child discovery and keyboard navigation patterns)
**Plans**: 2 plans

Plans:

- [x] 58-01: Package scaffold, TabPanel element, Tabs container with tablist rendering and active tab state
- [x] 58-02: Keyboard navigation, activation modes, orientation, ARIA, disabled tabs, and CSS theming

**Details:**
- Container-rendered tablist (all tab buttons in shadow DOM, panels slotted in light DOM)
- Click-to-switch panel activation with roving tabindex
- Orientation-aware keyboard navigation (Left/Right for horizontal, Up/Down for vertical)
- Dual activation modes: automatic (arrow keys activate), manual (arrow keys move focus only)
- Home/End keys for first/last tab with wrapping
- Full ARIA roles (tablist, tab, tabpanel) with aria-selected, aria-controls, aria-labelledby
- 20 CSS custom property tokens for tabs theming
- Dark mode support with 6 overrides
- Vertical orientation with flex-direction column

### Phase 59: Tabs Polish & Package

**Goal**: Tabs have animated indicator, lazy rendering, overflow handling, SSR compatibility, and ship as a publishable @lit-ui/tabs package
**Depends on**: Phase 58
**Plans**: 2 plans

Plans:

- [x] 59-01: Animated active indicator, data-state on tab buttons, lazy panel rendering, conditional panel tabindex
- [x] 59-02: Overflow scroll with navigation buttons, SSR compatibility verification, package publishability audit

**Details:**
- Sliding tab indicator with CSS transitions on transform/width/height
- ResizeObserver for indicator repositioning on container resize
- data-state attributes on tab buttons ("active"/"inactive")
- Lazy panel rendering with _hasBeenExpanded pattern
- W3C APG conditional tabindex on active panels
- Overflow scroll navigation buttons with ResizeObserver visibility sync
- Scroll buttons use aria-hidden="true" and tabindex="-1"
- Package build: 17KB (dist/index.js), 6KB (dist/index.d.ts)

### Phase 60: CLI & Documentation

**Goal**: Both components are installable via CLI and documented with interactive demos
**Depends on**: Phase 57, Phase 59
**Plans**: 2 plans

Plans:

- [x] 60-01: CLI copy-source templates and registry entries for accordion and tabs
- [x] 60-02: Documentation pages with interactive demos and API references

**Details:**
- Accordion and accordion-item CLI templates with CSS variable fallbacks
- Tabs and tab-panel CLI templates with 24 CSS variable fallbacks
- Registry.json updated with all 4 components
- AccordionPage.tsx (619 lines): 6 interactive demos, props/slots tables, 13 CSS properties
- TabsPage.tsx (632 lines): 7 interactive demos, props/slots tables, 25 CSS properties
- Updated routes, navigation, and PrevNextNav chain

---

## Milestone Summary

**Key Decisions:**

- CSS Grid `grid-template-rows: 0fr/1fr` for accordion height animation (cross-browser, no JS measurement)
- Parent-child container pattern from RadioGroup/CheckboxGroup reused for both components
- Container-rendered tablist: tab buttons in shadow DOM, panels slotted in light DOM
- _focusedValue tracks keyboard focus separately from active value for manual activation mode
- Tab indicator uses CSS transitions on transform/width (no JS animation loop)
- Lazy panels return `nothing` for zero DOM footprint
- Scroll buttons use aria-hidden and tabindex=-1 to stay out of tab order

**Issues Resolved:**

- api-extractor crash on Set<string> return type → Fixed by making getExpandedSet() private
- Missing isServer guard on requestAnimationFrame in syncPanelStates → Fixed during SSR audit
- Missing workspace dependencies for @lit-ui/accordion and @lit-ui/tabs in docs app → Fixed
- Missing JSX type declarations for accordion and tabs elements → Fixed

**Issues Deferred:**

- None

**Technical Debt Incurred:**

- None (all issues resolved during development)

---

_For current project status, see .planning/PROJECT.md_

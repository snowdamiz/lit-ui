# Milestone v4.2: Form Controls

**Status:** SHIPPED 2026-01-27
**Phases:** 38-41
**Total Plans:** 13

## Overview

Add Checkbox, Radio, and Switch toggle components with group containers, completing the core form primitive toolkit. Zero new dependencies -- all capabilities exist in current stack.

## Phases

### Phase 38: Switch Component
**Goal**: Users can toggle a switch control on/off with animated slide transition, form submission, and full keyboard/screen reader accessibility
**Depends on**: Nothing (first phase of v4.2; builds on established patterns from v4.0/v4.1)
**Plans**: 2 plans

Plans:
- [x] 38-01-PLAN.md — Package scaffolding + CSS design tokens
- [x] 38-02-PLAN.md — Switch component implementation + build

**Details:**
- 26 --ui-switch-* CSS design tokens (track dimensions, layout, typography, 5 color states)
- lui-switch with role="switch", aria-checked, animated track+thumb
- Form participation via ElementInternals (setFormValue, setValidity, formResetCallback)
- 3 size variants (sm/md/lg), disabled state, required validation
- PropertyValues type fix for api-extractor DTS rollup

### Phase 39: Checkbox + CheckboxGroup
**Goal**: Users can check/uncheck individual checkboxes (including indeterminate tri-state) and use groups with disabled propagation, select-all coordination, and group validation
**Depends on**: Phase 38 (form participation pattern, animation approach, CSS token conventions)
**Plans**: 3 plans

Plans:
- [x] 39-01-PLAN.md — Package scaffolding + CSS design tokens
- [x] 39-02-PLAN.md — Checkbox component implementation + build
- [x] 39-03-PLAN.md — CheckboxGroup component implementation + build

**Details:**
- 21 --ui-checkbox-* CSS design tokens
- lui-checkbox with animated SVG checkmark draw-in (stroke-dasharray/stroke-dashoffset)
- Indeterminate tri-state with dash icon and aria-checked="mixed"
- Space-only keyboard toggle per W3C APG checkbox spec
- lui-checkbox-group with role="group", select-all coordination, batch update flag for race condition prevention
- CheckboxGroup NOT form-associated; children submit independently

### Phase 40: Radio + RadioGroup
**Goal**: Users can select one option from a radio group with arrow key navigation, mutual exclusion enforced by the group, and the group submitting the selected value to forms
**Depends on**: Phase 39 (slot-based group communication pattern from CheckboxGroup)
**Plans**: 3 plans

Plans:
- [x] 40-01-PLAN.md — Package scaffolding + CSS design tokens
- [x] 40-02-PLAN.md — Radio component implementation
- [x] 40-03-PLAN.md — RadioGroup component implementation

**Details:**
- 20 --ui-radio-* CSS design tokens with dot-size tokens unique to radio
- lui-radio as presentational child (dispatches ui-radio-change, group manages state)
- lui-radio-group with mutual exclusion, roving tabindex (arrow keys move focus+selection)
- RadioGroup is form-associated (Shadow DOM breaks native radio name-grouping)
- Internal event (ui-radio-change) stopped at group; consumer-facing ui-change dispatched from group

### Phase 41: CLI and Documentation
**Goal**: All three new components are installable via CLI and documented with interactive examples on the docs site
**Depends on**: Phases 38, 39, 40 (all components must exist)
**Plans**: 5 plans

Plans:
- [x] 41-01-PLAN.md — CLI registry, templates, NPM mapping, list categories
- [x] 41-02-PLAN.md — Docs infrastructure (deps, JSX types, nav, routes, PrevNextNav)
- [x] 41-03-PLAN.md — CheckboxPage.tsx documentation
- [x] 41-04-PLAN.md — RadioPage.tsx documentation
- [x] 41-05-PLAN.md — SwitchPage.tsx documentation

**Details:**
- CLI registry expanded to 8 components total
- 5 copy-source templates (switch, checkbox, checkbox-group, radio, radio-group)
- Multi-file template resolution fix (per-file stem lookup for checkbox+group, radio+group)
- 3 docs pages with 27 interactive examples total
- PrevNextNav chain updated: Button -> Checkbox -> Dialog -> Input -> Radio -> Select -> Switch -> Textarea

---

## Milestone Summary

**Key Decisions:**
- RadioGroup owns form participation, not individual radios (Shadow DOM breaks native grouping)
- Zero new dependencies -- CSS transitions for all animation
- Build order Switch -> Checkbox -> Radio (incremental complexity)
- Skip aria-controls for select-all pattern (poor SR support, cross-shadow boundary issue)
- CheckboxGroup NOT form-associated; children submit independently
- Space-only keyboard for checkbox (W3C APG spec); Enter+Space for switch
- Inline dispatchCustomEvent in copy-source templates (base file doesn't export it)

**Issues Resolved:**
- PropertyValues type fix for api-extractor DTS rollup crash
- Multi-file template resolution for copy-source CLI (per-file stem lookup)
- Batch update flag prevents select-all race conditions in CheckboxGroup

**Issues Deferred:**
- 30 CLI tests need update for CSS variable naming change (from v3.0)
- Docs phases 9-12 incomplete (Framework, Theming, Accessibility, Polish guides)

**Technical Debt Incurred:**
None during v4.2.

---

_For current project status, see .planning/ROADMAP.md_

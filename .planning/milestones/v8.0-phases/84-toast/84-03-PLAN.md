---
phase: 84-toast
plan: "03"
type: execute
wave: 3
depends_on:
  - "84-01"
  - "84-02"
files_modified:
  - skill/skills/toast/SKILL.md
autonomous: true
requirements:
  - TST-03

must_haves:
  truths:
    - "SKILL.md CSS Custom Properties table shows correct defaults for all tokens (no bare dash defaults)"
    - "SKILL.md has a Behavior Notes section with at least 10 entries covering toast-specific behaviors"
    - "An agent reading SKILL.md can implement lui-toast correctly without consulting ToastPage.tsx or source"
  artifacts:
    - path: "skill/skills/toast/SKILL.md"
      provides: "Accurate toast skill file with correct CSS token defaults and Behavior Notes"
      contains: "var(--color-card, var(--ui-color-card))"
  key_links:
    - from: "skill/skills/toast/SKILL.md (CSS Custom Properties table)"
      to: "packages/core/src/styles/tailwind.css :root toast block"
      via: "token defaults must match exactly"
      pattern: "SKILL.md default column = tailwind.css :root values"
---

<objective>
Update `skill/skills/toast/SKILL.md` to fix the CSS token defaults (currently showing bare `—` dashes instead of actual values) and add a Behavior Notes section describing toast-specific behaviors that an agent needs to know.

Purpose: Agents using the skill file to implement toast need accurate defaults for theme overrides and behavioral knowledge for correct usage. Missing defaults and no Behavior Notes makes the skill file incomplete.
Output: `SKILL.md` with 21 accurate CSS token defaults (double-fallback form for color tokens, exact values for structural tokens, oklch values for variant tokens) and a Behavior Notes section with ~12 entries.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

<interfaces>
<!-- Key context the executor needs. -->

Actual :root token values from packages/core/src/styles/tailwind.css (ground truth for Default column):
```
--ui-toast-bg:             var(--color-card, var(--ui-color-card))
--ui-toast-text:           var(--color-card-foreground, var(--ui-color-card-foreground))
--ui-toast-border:         var(--color-border, var(--ui-color-border))
--ui-toast-radius:         0.5rem
--ui-toast-padding:        1rem
--ui-toast-shadow:         0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)
--ui-toast-max-width:      24rem
--ui-toast-gap:            0.75rem
--ui-toast-z-index:        55
--ui-toast-success-bg:     oklch(0.95 0.05 150)
--ui-toast-success-border: oklch(0.70 0.15 150)
--ui-toast-success-icon:   oklch(0.55 0.20 150)
--ui-toast-error-bg:       oklch(0.95 0.05 25)
--ui-toast-error-border:   oklch(0.70 0.15 25)
--ui-toast-error-icon:     oklch(0.55 0.20 25)
--ui-toast-warning-bg:     oklch(0.95 0.05 85)
--ui-toast-warning-border: oklch(0.70 0.15 85)
--ui-toast-warning-icon:   oklch(0.55 0.20 85)
--ui-toast-info-bg:        oklch(0.95 0.05 250)
--ui-toast-info-border:    oklch(0.70 0.15 250)
--ui-toast-info-icon:      oklch(0.55 0.20 250)
```

Current SKILL.md CSS Custom Properties table (stale — all defaults show `—`):
| --ui-toast-bg            | —   | Base toast background.       |
| --ui-toast-text          | —   | Toast text color.            |
| --ui-toast-border        | —   | Toast border color.          |
| --ui-toast-radius        | —   | Toast border radius.         |
| --ui-toast-shadow        | —   | Toast box shadow.            |
| --ui-toast-max-width     | —   | Maximum toast width.         |
| --ui-toast-gap           | —   | Gap between toasts.          |
| --ui-toast-z-index       | —   | Toast stack z-index.         |
| --ui-toast-success-bg    | —   | Success variant background.  |
| --ui-toast-success-border| —   | Success variant border.      |
| --ui-toast-success-icon  | —   | Success icon color.          |
| --ui-toast-error-bg      | —   | Error variant background.    |
| --ui-toast-error-border  | —   | Error variant border.        |
| --ui-toast-error-icon    | —   | Error icon color.            |
| --ui-toast-warning-bg    | —   | Warning variant background.  |
| --ui-toast-warning-border| —   | Warning variant border.      |
| --ui-toast-warning-icon  | —   | Warning icon color.          |
| --ui-toast-info-bg       | —   | Info variant background.     |
| --ui-toast-info-border   | —   | Info variant border.         |
| --ui-toast-info-icon     | —   | Info icon color.             |

Note: --ui-toast-padding is also MISSING from the SKILL.md table (it exists in :root). Add it after --ui-toast-radius.

Key behavioral facts from packages/toast/src/toast.ts and packages/toast/src/toaster.ts:
- Imperative API: toast(), toast.success(), toast.error(), toast.warning(), toast.info(), toast.promise(), toast.dismiss(id), toast.dismissAll()
- Auto-dismiss: default 5000ms timer starts on connectedCallback; duration: 0 means persistent
- Timer pause: pauses on pointerenter (hover) and focusin; resumes on pointerleave and focusout
- Swipe-to-dismiss: Pointer Events with setPointerCapture; dismisses if distance > 80px OR velocity > 0.11 px/ms
- Accessibility: error variant uses role="alert" + aria-live="assertive"; all others use role="status" + aria-live="polite"
- Close button: aria-label="Close notification"; fires toast-close event with reason: 'dismiss'
- Action button: onClick fires then toast-close fires with reason: 'action'
- Promise toast: shows loading spinner; resolves to success/error on promise resolution
- Toaster auto-create: lui-toaster is auto-created in document.body when toast() is called if none exists
- Toaster renders via popover="manual" for top-layer rendering (avoids z-index stacking contexts)
- Queue: maxVisible (default 3) controls how many toasts show; extras queue behind
- Position: 6 positions via CSS (top-left, top-center, top-right, bottom-left, bottom-center, bottom-right)
- Reduced motion: animations disabled via prefers-reduced-motion media query; loading spinner animation also disabled
- Cleanup: AbortController.abort() in disconnectedCallback removes all event listeners
- Dark mode: --ui-toast-bg/text/border cascade via semantic .dark tokens; variant oklch tokens have explicit .dark overrides with lower lightness (0.25 vs 0.95 in :root)

Established Behavior Notes pattern: See skill/skills/popover/SKILL.md Behavior Notes section (13 entries).
Each entry is a single bullet with: trigger -> behavior -> edge case/exception.
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix CSS token defaults and add Behavior Notes to SKILL.md</name>
  <files>skill/skills/toast/SKILL.md</files>
  <action>
    In `skill/skills/toast/SKILL.md`, make two changes:

    **1. Replace the CSS Custom Properties table** with the complete correct table including all defaults:

    | Property | Default | Description |
    |----------|---------|-------------|
    | `--ui-toast-bg` | `var(--color-card, var(--ui-color-card))` | Base toast background color. |
    | `--ui-toast-text` | `var(--color-card-foreground, var(--ui-color-card-foreground))` | Toast text color. |
    | `--ui-toast-border` | `var(--color-border, var(--ui-color-border))` | Toast border color. |
    | `--ui-toast-radius` | `0.5rem` | Toast border radius. |
    | `--ui-toast-padding` | `1rem` | Inner padding of the toast. |
    | `--ui-toast-shadow` | `0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)` | Toast box shadow. |
    | `--ui-toast-max-width` | `24rem` | Maximum width of a toast. |
    | `--ui-toast-gap` | `0.75rem` | Gap between stacked toasts. |
    | `--ui-toast-z-index` | `55` | Z-index of the toaster container. |
    | `--ui-toast-success-bg` | `oklch(0.95 0.05 150)` | Success variant background. |
    | `--ui-toast-success-border` | `oklch(0.70 0.15 150)` | Success variant border. |
    | `--ui-toast-success-icon` | `oklch(0.55 0.20 150)` | Success icon color. |
    | `--ui-toast-error-bg` | `oklch(0.95 0.05 25)` | Error variant background. |
    | `--ui-toast-error-border` | `oklch(0.70 0.15 25)` | Error variant border. |
    | `--ui-toast-error-icon` | `oklch(0.55 0.20 25)` | Error icon color. |
    | `--ui-toast-warning-bg` | `oklch(0.95 0.05 85)` | Warning variant background. |
    | `--ui-toast-warning-border` | `oklch(0.70 0.15 85)` | Warning variant border. |
    | `--ui-toast-warning-icon` | `oklch(0.55 0.20 85)` | Warning icon color. |
    | `--ui-toast-info-bg` | `oklch(0.95 0.05 250)` | Info variant background. |
    | `--ui-toast-info-border` | `oklch(0.70 0.15 250)` | Info variant border. |
    | `--ui-toast-info-icon` | `oklch(0.55 0.20 250)` | Info icon color. |

    Key corrections:
    - bg, text, border: add double-fallback var() form (was `—`)
    - radius: add `0.5rem` (was `—`)
    - padding: ADD new row (was missing entirely)
    - shadow: add two-layer value (was `—`)
    - max-width: add `24rem` (was `—`)
    - gap: add `0.75rem` (was `—`)
    - z-index: add `55` (was `—`)
    - All 12 variant oklch: add actual :root values (were all `—`)

    **2. Add Behavior Notes section** at the end of the file (after the Accessibility section):

    ```markdown
    ## Behavior Notes

    - Imperative API only: toast is triggered via imported functions (`toast()`, `toast.success()`, `toast.error()`, `toast.warning()`, `toast.info()`), not by placing a `<lui-toast>` element. No declarative element usage — only `<lui-toaster>` for configuration.
    - Auto-toaster creation: calling `toast()` when no `<lui-toaster>` exists in the document auto-creates one and appends it to `document.body`. Add `<lui-toaster>` explicitly in the root layout to configure position, max-visible, or gap.
    - Auto-dismiss timer: starts at `connectedCallback` with default 5000ms. Set `duration: 0` for a persistent toast that does not auto-dismiss. Timer is tracked with remaining time so pause/resume is accurate.
    - Hover/focus pause: `pointerenter` pauses the auto-dismiss timer; `pointerleave` resumes it. `focusin` pauses; `focusout` resumes. Timer resumes from the remaining duration (not restarted from full).
    - Swipe-to-dismiss: Pointer Events with `setPointerCapture` track horizontal swipe on touch/pointer devices. Dismisses if swipe distance exceeds 80px OR velocity exceeds 0.11 px/ms. Below threshold, the toast snaps back with a 200ms ease-out transition.
    - Accessibility roles: error variant uses `role="alert"` + `aria-live="assertive"` (announces immediately). All other variants (default, success, warning, info, loading) use `role="status"` + `aria-live="polite"` (non-interrupting announcement).
    - Close button: rendered when `dismissible: true` (default). Has `aria-label="Close notification"`. Fires `toast-close` custom event with `detail: { id, reason: 'dismiss' }`.
    - Action button: optional `action: { label: string, onClick: () => void }` option. Renders as a styled underlined button inside the toast. Click fires the `onClick` callback then fires `toast-close` with `reason: 'action'`. The toast is dismissed after the action.
    - Promise toast: `toast.promise(promise, { loading, success, error })` shows a loading spinner toast while the promise is pending. On resolution, updates the toast title to the success or error message. On rejection, updates to the error message. The loading spinner uses an `animation: spin` keyframe respecting `prefers-reduced-motion`.
    - Queue management: `<lui-toaster>` renders up to `max-visible` (default 3) toasts at once. Additional toasts queue in state and appear as existing toasts dismiss. The toaster subscribes to the singleton `toastState` via a reactive subscription.
    - Top-layer rendering: `<lui-toaster>` uses `popover="manual"` so it renders in the browser's top layer, above all stacking contexts. Z-index is still configurable via `--ui-toast-z-index` (default 55) for environments where popover is not supported.
    - Dark mode: base tokens (`--ui-toast-bg`, `--ui-toast-text`, `--ui-toast-border`) cascade automatically via `.dark` semantic tokens (--color-card, --color-card-foreground, --color-border). Variant tokens have explicit `.dark` overrides using lower-lightness oklch values (0.25 lightness vs 0.95 in light mode) — these cannot cascade via semantic tokens.
    - Cleanup: `AbortController.abort()` in `disconnectedCallback` removes all Pointer Event, hover, and focus listeners attached in `connectedCallback`. No manual `removeEventListener` calls needed.
    ```

    Do NOT change the frontmatter, Usage examples, `toast()` API table, `ToastOptions` table, `lui-toaster` Props table, CSS Parts table, or Accessibility section.
  </action>
  <verify>
    <automated>grep -n "var(--color-card, var(--ui-color-card))\|0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px\|Behavior Notes\|ui-toast-padding" /Users/sn0w/Documents/dev/lit-components/skill/skills/toast/SKILL.md</automated>
    Expect: 4 matches — the corrected bg default, the corrected two-layer shadow, the Behavior Notes heading, and the padding row.
    Also: grep "z-index.*55" skill/skills/toast/SKILL.md should return a match.
    Also: grep "| \`--ui-toast" skill/skills/toast/SKILL.md | wc -l should return 21 (was 20, added padding).
  </verify>
  <done>
    - CSS token table has 21 entries (including new --ui-toast-padding row)
    - Color tokens (bg, text, border) use double-fallback var() form
    - Shadow uses two-layer value matching tailwind.css :root
    - z-index is 55 (not blank or 50)
    - All 12 variant oklch entries show actual values (not bare dashes)
    - Behavior Notes section appended with 12+ bullet entries
    - No bare `—` dashes remain in the Default column
  </done>
</task>

</tasks>

<verification>
grep -c "Behavior Notes" /Users/sn0w/Documents/dev/lit-components/skill/skills/toast/SKILL.md
Expected: 1

grep "ui-toast-z-index" /Users/sn0w/Documents/dev/lit-components/skill/skills/toast/SKILL.md
Expected: contains "55"

grep "ui-toast-bg" /Users/sn0w/Documents/dev/lit-components/skill/skills/toast/SKILL.md
Expected: contains "var(--color-card, var(--ui-color-card))" — not a bare dash

grep "ui-toast-padding" /Users/sn0w/Documents/dev/lit-components/skill/skills/toast/SKILL.md
Expected: at least 1 match (new row added)
</verification>

<success_criteria>
- All 21 CSS token defaults in SKILL.md match tailwind.css :root exactly (including added --ui-toast-padding)
- Color tokens (bg, text, border) show double-fallback var() form
- Shadow shows two-layer value
- z-index is 55
- All variant oklch entries show actual values
- Behavior Notes section exists with 12+ entries covering: imperative API, auto-toaster creation, auto-dismiss, hover/focus pause, swipe-to-dismiss, accessibility roles, close button, action button, promise toast, queue management, top-layer rendering, dark mode cascade, cleanup
</success_criteria>

<output>
After completion, create `.planning/phases/84-toast/84-03-SUMMARY.md`
</output>

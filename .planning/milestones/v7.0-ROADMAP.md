# Milestone v7.0: Data Table

**Status:** SHIPPED 2026-02-05
**Phases:** 61-68
**Total Plans:** 28

## Overview

This milestone delivered a full-featured data table component for admin dashboards, handling 100K+ row datasets with virtual scrolling, sorting, filtering, inline editing, selection with bulk actions, and column customization. The architecture uses TanStack Table for headless state management and TanStack Virtual for row virtualization, building on patterns proven in the existing Select component.

Phases progressed from foundational architecture (virtualization, ARIA grid) through data operations (sort, filter, paginate) to advanced features (editing, bulk actions, export). This ordering ensured architectural decisions that cannot be retrofitted were established first.

## Phases

### Phase 61: Core Table Shell & Virtualization

**Goal**: Users see a performant table with fixed header, virtual scrolling for 100K+ rows, proper loading/empty states, and full ARIA grid keyboard navigation.
**Depends on**: None (foundation phase)
**Plans**: 5 plans

Plans:
- [x] 61-01-PLAN.md — Package setup with types and TanStack dependencies
- [x] 61-02-PLAN.md — Core DataTable component with TableController
- [x] 61-03-PLAN.md — Virtual scrolling with VirtualizerController
- [x] 61-04-PLAN.md — Loading and empty states
- [x] 61-05-PLAN.md — ARIA grid keyboard navigation

**Details:**
- Div-based ARIA grid layout (required for virtualization, native table elements incompatible)
- CSS Grid with minmax() columns for flexible sizing
- KeyboardNavigationManager utility for position calculation
- Skeleton pulse loading, overlay for updates, "no data"/"no matches" empty states

---

### Phase 62: Sorting & Selection

**Goal**: Users can sort data by clicking column headers and select rows individually or in bulk for downstream actions.
**Depends on**: Phase 61 (requires table rendering and keyboard navigation)
**Plans**: 3 plans

Plans:
- [x] 62-01-PLAN.md — Sorting with TanStack integration and visual indicators
- [x] 62-02-PLAN.md — Row selection core with checkbox column
- [x] 62-03-PLAN.md — Selection enhancements (range, banner, filter clearing)

**Details:**
- Single/multi-column sorting with priority badges
- Selection checkbox column with header select-all
- Shift+click range selection via TanStack row model
- "Select all X items" banner for server-side full-dataset selection
- Selection clears on filter change (configurable)

---

### Phase 63: Filtering & Pagination

**Goal**: Users can filter data per-column or globally, paginate through results, and connect to server-side data sources with proper loading states.
**Depends on**: Phase 62 (builds on sorting pipeline, selection clears on filter)
**Plans**: 4 plans

Plans:
- [x] 63-01-PLAN.md — Filtering infrastructure with TanStack integration
- [x] 63-02-PLAN.md — Filter components (text, number, date, select, global)
- [x] 63-03-PLAN.md — Pagination state and controls
- [x] 63-04-PLAN.md — Async data callback with AbortController

**Details:**
- FilterType union (text|number|date|select)
- 5 filter components + global search
- Pagination with page size selector
- Async data callback with AbortController cancellation and 300ms debounce

---

### Phase 64: Column Customization

**Goal**: Users can resize, reorder, and show/hide columns, with preferences persisted for return visits.
**Depends on**: Phase 61 (requires stable header rendering)
**Plans**: 4 plans

Plans:
- [x] 64-01-PLAN.md — Column resize with drag handles and auto-fit
- [x] 64-02-PLAN.md — Column visibility picker with lui-popover
- [x] 64-03-PLAN.md — Column reorder via drag-and-drop, sticky first column
- [x] 64-04-PLAN.md — Persistence to localStorage with optional callback

**Details:**
- Drag handles for resize, double-click auto-fit, 50px minimum
- Column picker dropdown with checkboxes
- Native drag events for header reorder
- Sticky first column with z-index layering
- localStorage persistence with version field, server-side callback

---

### Phase 65: Inline Editing

**Goal**: Users can edit data directly in the table at cell level (click-to-edit) or row level (edit mode), with validation and save/cancel workflow.
**Depends on**: Phase 61-64 (requires stable table, virtualization, keyboard nav)
**Plans**: 3 plans

Plans:
- [x] 65-01-PLAN.md — Editing types and inline-editing module (input renderers, helpers)
- [x] 65-02-PLAN.md — Cell-level inline editing (click-to-edit, commit/cancel, validation, events)
- [x] 65-03-PLAN.md — Row-level inline editing (pencil action, save/cancel, row validation, events)

**Details:**
- Native HTML inputs for 48px row height compatibility
- Double-commit guard pattern for Enter+blur race condition
- Cell edit: click-to-edit, Enter/blur commits, Escape cancels
- Row edit: pencil button activates, save validates all fields
- Mutual exclusion between cell and row edit modes

---

### Phase 66: Cell Renderers, Row Actions & Bulk Actions

**Goal**: Users can customize cell display with renderers, access row-level actions, and perform bulk operations on selected rows.
**Depends on**: Phase 62 (selection), Phase 65 (edit mode integration with actions)
**Plans**: 3 plans

Plans:
- [x] 66-01-PLAN.md — Types, cell renderer factories, and row actions module
- [x] 66-02-PLAN.md — Row actions integration into DataTable component
- [x] 66-03-PLAN.md — Bulk actions toolbar and confirmation dialog integration

**Details:**
- 7 built-in cell renderers (text, number, date, boolean, badge, progress, avatar)
- Row actions with inline (1-2) / kebab menu (3+) pattern
- Pre-built action factories (view, edit, delete) with SVG icons
- Floating bulk actions toolbar with count display
- Native confirmation dialog for destructive actions

---

### Phase 67: Export & Expandable Rows

**Goal**: Users can export table data to CSV and expand rows to see additional detail content.
**Depends on**: Phase 62 (selection for export selected), Phase 63 (filters for export filtered)
**Plans**: 2 plans

Plans:
- [x] 67-01-PLAN.md — CSV export utility with client-side and server-side callback support
- [x] 67-02-PLAN.md — Expandable detail rows with column factory, dynamic virtualizer measurement, and single-expand mode

**Details:**
- RFC 4180-compliant CSV export with UTF-8 BOM
- Utility column exclusion (_ prefix: _selection, _actions, _expand)
- Expandable rows with chevron toggle, detail panel, controlled/uncontrolled state
- Virtual row wrapper for dynamic height measurement
- Single-expand accordion mode

---

### Phase 68: Package, CLI & Documentation

**Goal**: Data Table is distributed as npm package and CLI template with comprehensive documentation for all features.
**Depends on**: Phases 61-67 (all features complete)
**Plans**: 4 plans

Plans:
- [x] 68-01-PLAN.md — Package finalization (peer deps, element registration, JSX types)
- [x] 68-02-PLAN.md — CLI registry entry and copy-source starter template
- [x] 68-03-PLAN.md — Docs page setup with core feature demos
- [x] 68-04-PLAN.md — Advanced demos, API reference, and accessibility docs

**Details:**
- 4 peer dependencies (lit, @lit-ui/core, @lit-ui/checkbox, @lit-ui/popover)
- JSX declarations: 44 properties + 14 events
- CLI starter template: 310-line self-contained component
- Documentation: 1395-line page with 11 interactive demos
- API reference: 44 properties, 13 events, 2 slots, 18 CSS custom properties
- Accessibility: ARIA roles, 9 keyboard bindings, W3C APG compliance

---

## Milestone Summary

**Key Decisions:**
- TanStack Table for headless state management (proven, Lit-native reactive controller)
- TanStack Virtual for row virtualization (reused from Select component)
- Fixed 48px row height (variable heights break virtual scroll performance)
- Div-based ARIA grid layout (required for virtualization)
- Native HTML inputs in edit cells (LitUI components exceed 48px row height)
- Cell renderers as factory functions (not custom elements, matches createSelectionColumn pattern)
- lui-popover for kebab dropdown (top-layer rendering avoids scroll container clipping)
- Native confirmation dialog for bulk actions (avoids lui-dialog dependency overhead)
- CSS double fallback in CLI starter (--ui-data-table-* -> --color-* -> literal hex)

**Issues Resolved:**
- All 76 requirements satisfied with no gaps
- 67 cross-phase integration points verified
- 5 end-to-end user flows validated
- No blocking anti-patterns found

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None from v7.0 milestone specifically
- Carried forward: 30 CLI tests need update for CSS variable naming change (--lui-* -> --ui-*)

---

_For current project status, see .planning/PROJECT.md_
